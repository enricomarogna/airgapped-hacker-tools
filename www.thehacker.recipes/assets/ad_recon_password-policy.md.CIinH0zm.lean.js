import{_ as o,c as p,a5 as n,G as e,w as t,B as h,o as k,j as s,a as i}from"./chunks/framework.B5CpDqM0.js";const F=JSON.parse('{"title":"Password policy","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"ad/recon/password-policy.md","filePath":"ad/recon/password-policy.md","lastUpdated":1724982529000}'),d={name:"ad/recon/password-policy.md"};function c(g,a,u,y,E,b){const l=h("PluginTabsTab"),r=h("PluginTabs");return k(),p("div",null,[a[2]||(a[2]=n('<h1 id="password-policy" tabindex="-1">Password policy <a class="header-anchor" href="#password-policy" aria-label="Permalink to &quot;Password policy&quot;">â€‹</a></h1><p>When attacking Active Directory domains, directly targeting accounts is usually a great start. It could provide initial access and help the attackers operate lateral movement. The easiest way to compromise accounts is to operate some password <a href="./../movement/credentials/bruteforcing/guessing">guessing</a> or <a href="./../movement/credentials/bruteforcing/spraying">spraying</a>. This kind of attack usually yields good results depending on the user&#39;s awareness. There are however technical measures that usually are in place, forcing the attackers to balance the number and speed of password attempts.</p><p>In order to fine-tune this, the password policy can be obtained. This policy can sometimes be enumerated with a null-session (i.e. an <a href="./ms-rpc#null-sessions">MS-RPC null session</a> or an <a href="./ldap">LDAP anonymous bind</a>).</p>',3)),e(r,null,{default:t(()=>[e(l,{label:"UNIX-like"},{default:t(()=>a[0]||(a[0]=[s("p",null,[i("On UNIX-like systems, there are many alternatives that allow obtaining the password policy like "),s("a",{href:"https://github.com/Wh1t3Fox/polenum",target:"_blank",rel:"noreferrer"},"polenum"),i(" (Python), "),s("a",{href:"https://github.com/Pennyw0rth/NetExec",target:"_blank",rel:"noreferrer"},"NetExec"),i(" (Python), "),s("a",{href:"https://github.com/yaap7/ldapsearch-ad",target:"_blank",rel:"noreferrer"},"ldapsearch-ad"),i(" (Python) and "),s("a",{href:"./enum4linux"},"enum4linux"),i(".")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# polenum (obtained through MS-RPC)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"polenum"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $DOMAIN "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-u"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $USER "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-p"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $PASSWORD "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $DOMAIN")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# netexec (obtained through MS-RPC)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"nxc"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," smb"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $DOMAIN_CONTROLLER "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $DOMAIN "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-u"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $USER "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-p"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $PASSWORD "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"--pass-pol")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# ldapsearch-ad (obtained through LDAP)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ldapsearch-ad.py"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -l"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $LDAP_SERVER "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $DOMAIN "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-u"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $USER "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-p"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $PASSWORD "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-t"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pass-pol")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# enum4linux-ng (obtained through MS-RPC)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"enum4linux-ng"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -P"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -w"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -u"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $USER "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-p"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $PASSWORD $DOMAIN_CONTROLLER")])])])],-1)])),_:1}),e(l,{label:"Windows"},{default:t(()=>a[1]||(a[1]=[s("p",null,[i("From a domain-joined machine, the "),s("code",null,"net"),i(" cmdlet can be used to obtain the password policy.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," accounts")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," accounts"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /domain")])])])],-1),s("p",null,[i("From non-domain-joined machines, it can be done with "),s("a",{href:"https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1",target:"_blank",rel:"noreferrer"},"PowerView"),i(" (Powershell).")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Get-DomainPolicy")])])])],-1)])),_:1})]),_:1}),a[3]||(a[3]=n('<div class="tip custom-block"><p>Accounts that lockout can be attacked with <a href="https://github.com/Hackndo/sprayhound" target="_blank" rel="noreferrer">sprayhound</a> (<a href="./../movement/credentials/bruteforcing/spraying">credential spraying</a>) while those that don&#39;t can be directly bruteforced with <a href="https://github.com/ropnop/kerbrute" target="_blank" rel="noreferrer">kerbrute</a> (<a href="./../movement/kerberos/pre-auth-bruteforce">Kerberos pre-auth bruteforcing</a>)</p></div>',1))])}const C=o(d,[["render",c]]);export{F as __pageData,C as default};
