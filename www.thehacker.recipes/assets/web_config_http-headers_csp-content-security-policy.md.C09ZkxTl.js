import{_ as t,c as a,a5 as n,o as s}from"./chunks/framework.B5CpDqM0.js";const d=JSON.parse('{"title":"üõ†Ô∏è CSP (Content Security Policy)","description":"","frontmatter":{"authors":"ShutdownRepo, p0dalirius"},"headers":[],"relativePath":"web/config/http-headers/csp-content-security-policy.md","filePath":"web/config/http-headers/csp-content-security-policy.md","lastUpdated":1724982529000}'),i={name:"web/config/http-headers/csp-content-security-policy.md"};function o(r,e,c,p,l,h){return s(),a("div",null,e[0]||(e[0]=[n(`<h1 id="üõ†Ô∏è-csp-content-security-policy" tabindex="-1">üõ†Ô∏è CSP (Content Security Policy) <a class="header-anchor" href="#üõ†Ô∏è-csp-content-security-policy" aria-label="Permalink to &quot;üõ†Ô∏è CSP (Content Security Policy)&quot;">‚Äã</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">‚Äã</a></h2><p>Content-Security-Policy (CSP) is the name of a HTTP response header that modern browsers use to enhance the security of the document (or web page). The Content-Security-Policy header allows you to restrict how resources such as JavaScript, CSS, or pretty much anything that the browser loads. It can be set as an HTTP response header or using a <code>&lt;meta&gt;</code> html tag. It is mainly used to protect against <a href="https://www.thehacker.recipes/web/inputs/xss-cross-site-scripting" target="_blank" rel="noreferrer">Cross Site Scripting (XSS)</a>, Click Jacking attacks and Code Injection attacks.</p><p>The Content-Security-Policy if made up of directives, separated with a semicolon <code>;</code>. Here is an example :</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>content-security-policy :</span></span>
<span class="line"><span>    default-src &#39;none&#39;</span></span>
<span class="line"><span>    frame-ancestors &#39;none&#39;</span></span>
<span class="line"><span>    img-src &#39;self&#39;</span></span>
<span class="line"><span>    script-src github.githubassets.com</span></span>
<span class="line"><span>    style-src &#39;unsafe-inline&#39;</span></span></code></pre></div><p>You can find the detail of these directives as well as their browser compatibilities here : <a href="https://content-security-policy.com/" target="_blank" rel="noreferrer">https://content-security-policy.com/</a></p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">‚Äã</a></h2><p>The CSP can be audited with Google&#39;s <a href="https://csp-evaluator.withgoogle.com/" target="_blank" rel="noreferrer">CSP Evaluator</a>.</p><p>If the CSP is weak, there are a few techniques to bypass it.</p><h3 id="dangling-markup-injection" tabindex="-1">Dangling markup injection <a class="header-anchor" href="#dangling-markup-injection" aria-label="Permalink to &quot;Dangling markup injection&quot;">‚Äã</a></h3><p>Dangling markup injection is a technique that can be used to capture data cross-domain in situations where a full <a href="https://www.thehacker.recipes/web/inputs/xss-cross-site-scripting" target="_blank" rel="noreferrer">Cross Site Scripting (XSS)</a> exploit is not possible, due to input filters or other defenses. It can often be exploited to capture sensitive information that is visible to other users, including CSRF tokens that can be used to perform unauthorized actions on behalf of the user.</p><p>A lot of useful payloads can be found here :</p><ul><li><a href="https://book.hacktricks.xyz/pentesting-web/dangling-markup-html-scriptless-injection" target="_blank" rel="noreferrer">https://book.hacktricks.xyz/pentesting-web/dangling-markup-html-scriptless-injection</a></li><li><a href="https://book.hacktricks.xyz/pentesting-web/content-security-policy-csp-bypass" target="_blank" rel="noreferrer">https://book.hacktricks.xyz/pentesting-web/content-security-policy-csp-bypass</a></li></ul><h3 id="js-json-jsonp-injections" tabindex="-1">JS/JSON/JSONP injections <a class="header-anchor" href="#js-json-jsonp-injections" aria-label="Permalink to &quot;JS/JSON/JSONP injections&quot;">‚Äã</a></h3><p>JSONP hijacking or unexploitable injection of content into JavaScript or JSON and can also help. For example, if there is no function name validation in JSONP, you can replace the called function with arbitrary JS code.</p><p>Here is a list of various JSONP endpoints that can be used to perform code injections :</p><ul><li><a href="https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/XSS%20Injection/Intruders/jsonp_endpoint.txt" target="_blank" rel="noreferrer">https://raw.githubusercontent.com/swisskyrepo/PayloadsAllTheThings/master/XSS%20Injection/Intruders/jsonp_endpoint.txt</a></li></ul>`,17)]))}const y=t(i,[["render",o]]);export{d as __pageData,y as default};
