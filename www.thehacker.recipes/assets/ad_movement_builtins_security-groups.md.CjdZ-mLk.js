import{_ as t,c as r,a5 as a,o as s}from"./chunks/framework.B5CpDqM0.js";const h=JSON.parse('{"title":"Security groups","description":"","frontmatter":{"authors":"ShutdownRepo, sckdev"},"headers":[],"relativePath":"ad/movement/builtins/security-groups.md","filePath":"ad/movement/builtins/security-groups.md","lastUpdated":1724982529000}'),o={name:"ad/movement/builtins/security-groups.md"};function i(n,e,d,c,u,m){return s(),r("div",null,e[0]||(e[0]=[a('<h1 id="security-groups" tabindex="-1">Security groups <a class="header-anchor" href="#security-groups" aria-label="Permalink to &quot;Security groups&quot;">â€‹</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">â€‹</a></h2><blockquote><p>In the Windows Server operating system, there are several built-in accounts and security groups that are preconfigured with the appropriate rights and permissions to perform specific tasks. (<a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/dn579255(v=ws.11)?redirectedfrom=MSDN" target="_blank" rel="noreferrer">Microsoft</a>)</p></blockquote><p>There are scenarios where testers can obtain full control over members of built-in security groups. The usual targets are members of the &quot;Administrators&quot;, &quot;Domain Admins&quot; or &quot;Entreprise Admins&quot; groups, however, other groups can sometimes lead to major privileges escalation.</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">â€‹</a></h2><p>Below is a table summing up some groups&#39; rights and abuse paths.</p><table tabindex="0"><thead><tr><th>Security Group</th><th>Rights and abuses</th></tr></thead><tbody><tr><td>Account Operators</td><td><p>its members can create and manage users and groups, including its own membership and that of the Server Operators group (e.g. <a href="../dacl/addmember.md">add a member to a group</a>)</p><p></p><p>its members can also be used to help abuse user accounts with <a href="../kerberos/delegations/#unconstrained-delegations">unconstrained delegations</a> since Account Operators can edit users SPNs.</p><p></p><p><em>&quot;This group is considered a service administrator group because it can modify Server Operators, which in turn can modify domain controller settings. As a best practice, leave the membership of this group empty, and do not use it for any delegated administration. This group cannot be renamed, deleted, or moved.&quot; (</em><a href="https://docs.microsoft.com/en-us/windows/security/identity-protection/access-control/active-directory-security-groups"><em>docs.microsoft.com</em></a><em>)</em></p><p></p><p><span data-gb-custom-inline data-tag="emoji" data-code="1f525">ðŸ”¥</span> at the time of writing (12th, April 2021) members can sometimes also escalate through the &quot;Enterprise Key Admins&quot; group and obtain full control over the root domain (read <a href="https://secureidentity.se/adprep-bug-in-windows-server-2016/">the ADPREP bug</a>). </p></td></tr><tr><td>Administrators</td><td>full admin rights to the Active Directory domain and Domain Controllers</td></tr><tr><td>Backup Operators</td><td><p>can backup or restore Active Directory and have logon rights to Domain Controllers<br><br><span data-gb-custom-inline data-tag="emoji" data-code="1f525">ðŸ”¥</span> its members can remotely backup the necessary registry hives to <a href="../credentials/dumping/sam-and-lsa-secrets.md">dump SAM &amp; LSA secrets</a> and then conduct a <a href="../credentials/dumping/dcsync.md">DCSync</a></p></td></tr><tr><td>Server Operators</td><td>its members can sign-in to a server, start and stop services, access domain controllers, perform maintenance tasks (such as backup and restore), and they have the ability to change binaries that are installed on the domain controllers</td></tr><tr><td>DnsAdmins</td><td>can read, write, create, delete DNS records (e.g. edit the <a href="./../mitm-and-coerced-authentications/adidns-spoofing#manual-record-manipulation">wildcard record</a> if it already exists). Its members can also <a href="https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83" target="_blank" rel="noreferrer">run code via DLL on a Domain Controller operating as a DNS server</a> (<a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-40469" target="_blank" rel="noreferrer">CVE-2021-40469</a>).</td></tr><tr><td>Domain Admins</td><td>full admin rights to the Active Directory domain, all computers, workstations, servers, users and so on</td></tr><tr><td>Enterprise Admins</td><td>full admin rights to all Active Directory domains in the AD forest</td></tr><tr><td>Schema Admins</td><td>modify the schema structure of the Active Directory. Only the objects created <strong>after</strong> the modification are affected.</td></tr><tr><td>Group Policy Creators Owners</td><td>create Group Policies in the domain. Its members can&#39;t apply group policies to users or group or edit existing GPOs</td></tr><tr><td>Cert Publishers</td><td>its members usually are the servers where <a href="./../adcs/index">AD CS</a> is installed</td></tr></tbody></table><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">â€‹</a></h2><p><a href="https://adsecurity.org/?p=3658" target="_blank" rel="noreferrer">https://adsecurity.org/?p=3658</a></p><p><a href="https://docs.microsoft.com/en-us/troubleshoot/windows-server/identity/security-identifiers-in-windows" target="_blank" rel="noreferrer">https://docs.microsoft.com/en-us/troubleshoot/windows-server/identity/security-identifiers-in-windows</a></p><p><a href="https://cube0x0.github.io/Pocing-Beyond-DA/" target="_blank" rel="noreferrer">https://cube0x0.github.io/Pocing-Beyond-DA/</a></p>',11)]))}const l=t(o,[["render",i]]);export{h as __pageData,l as default};
