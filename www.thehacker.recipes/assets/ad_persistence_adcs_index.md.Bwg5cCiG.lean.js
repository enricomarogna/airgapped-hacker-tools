import{_ as t,c as i,a5 as r,o as a}from"./chunks/framework.B5CpDqM0.js";const p=JSON.parse('{"title":"Certificate Services (AD-CS)","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"ad/persistence/adcs/index.md","filePath":"ad/persistence/adcs/index.md","lastUpdated":1724982529000}'),s={name:"ad/persistence/adcs/index.md"};function o(n,e,c,l,d,f){return a(),i("div",null,e[0]||(e[0]=[r('<h1 id="certificate-services-ad-cs" tabindex="-1">Certificate Services (AD-CS) <a class="header-anchor" href="#certificate-services-ad-cs" aria-label="Permalink to &quot;Certificate Services (AD-CS)&quot;">​</a></h1><div class="tip custom-block"><p>See <a href="./../../movement/adcs/index">AD &gt; Movement &gt; Certificate Services (AD-CS)</a> to know more about it.</p></div><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><blockquote><p>AD CS is Microsoft’s PKI implementation that provides everything from encrypting file systems, to digital signatures, to user authentication (a large focus of our research), and more. While AD CS is not installed by default for Active Directory environments, from our experience in enterprise environments it is widely deployed, and the security ramifications of misconfigured certificate service instances are enormous. (<a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2" target="_blank" rel="noreferrer">specterops.io</a>)</p></blockquote><p>In <a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2" target="_blank" rel="noreferrer">their research papers</a>, <a href="https://twitter.com/harmj0y" target="_blank" rel="noreferrer">Will Schroeder</a> and <a href="https://twitter.com/tifkin_" target="_blank" rel="noreferrer">Lee Christensen</a> shared their research on AD CS and identified multiple theft, escalation and persistence vectors.</p><ul><li>Credential theft (dubbed THEFT1 to THEFT5)</li><li>Account persistence (dubbed PERSIST1 to PERSIST3)</li><li>Domain escalation (dubbed ESC1 to ESC14) <ul><li>based on <a href="./../../movement/adcs/certificate-templates">misconfigured certificate templates</a></li><li>based on <a href="./../../movement/adcs/certificate-authority">dangerous CA configuration</a></li><li>related to <a href="./../../movement/adcs/access-controls">access control vulnerabilities</a></li><li>based on an NTLM relay vulnerability related to the <a href="./../../movement/adcs/unsigned-endpoints">unsigned endpoints of AD CS</a></li></ul></li><li>Domain persistence (dubbed DPERSIST1 to DPERSIST3) <ul><li>by <a href="./certificate-authority#stolen-ca">forging certificates with a stolen CA certificates</a></li><li>by <a href="./certificate-authority#rogue-ca">trusting rogue CA certificates</a></li><li>by <a href="./access-controls">maliciously creating vulnerable access controls</a></li></ul></li></ul>',6)]))}const u=t(s,[["render",o]]);export{p as __pageData,u as default};
