import{_ as e,c as s,a5 as i,o as t}from"./chunks/framework.B5CpDqM0.js";const u=JSON.parse('{"title":"Subdomains enumeration","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"web/recon/domains-enumeration.md","filePath":"web/recon/domains-enumeration.md","lastUpdated":1724982529000}'),n={name:"web/recon/domains-enumeration.md"};function r(o,a,h,l,p,d){return t(),s("div",null,a[0]||(a[0]=[i(`<h1 id="subdomains-enumeration" tabindex="-1">Subdomains enumeration <a class="header-anchor" href="#subdomains-enumeration" aria-label="Permalink to &quot;Subdomains enumeration&quot;">​</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><p>When conducting penetration tests on a website, or on a <code>*.domain.com</code> scope, finding subdomains of the target can help widen the attack surface. There are many different techniques to find subdomains that can be divided in two main categories.</p><h3 id="passive-techniques" tabindex="-1">Passive techniques <a class="header-anchor" href="#passive-techniques" aria-label="Permalink to &quot;Passive techniques&quot;">​</a></h3><p>Attackers don&#39;t connect directly to the target systems and stay under the radar.</p><ul><li>Certificate Transparency</li><li>ASN Discovery</li><li>Search engines (Google &amp; Bing Dorking)</li><li>DNS aggregators/datasets (Github, Virustotal, DNSdumpster etc)</li><li>Subject alternate name (SAN)</li><li>Using public datasets</li><li>DNS enum using Cloudflare</li></ul><h3 id="active-techniques" tabindex="-1">Active techniques <a class="header-anchor" href="#active-techniques" aria-label="Permalink to &quot;Active techniques&quot;">​</a></h3><p>Attackers obtain information directly from the target systems. The results may be more useful but can raise some alerts on the defenders side.</p><ul><li>HTTP virtual host fuzzing</li><li>HTTP headers</li><li>DNS zone transfers</li><li>DNS bruteforcing</li><li>DNS zone walking</li><li>DNS cache snooping</li><li>DNS records (CNAME, SPF)</li><li>Reverse DNS sweeping</li></ul><p>Detailing every technique mentioned above would be a duplicate to other blogposts that already do (cf. <a href="./domains-enumeration#references">Resources</a>).</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">​</a></h2><h3 id="google-bing-dorks" tabindex="-1">Google &amp; Bing Dorks <a class="header-anchor" href="#google-bing-dorks" aria-label="Permalink to &quot;Google &amp; Bing Dorks&quot;">​</a></h3><p>Search engines like Google and Bing offer Dorking features that can be used to gather specific information.</p><ul><li>On Google, the <code>site:</code> operator can be used to find subdomains. The minus (<code>-</code>) operator can also be used to exclude subdomains that are already known (e.g. <code>site:*.thehacker.recipes -www</code>).</li><li>On Bing, the same <code>site:</code> operator can be used (e.g. <code>site:thehacker.recipes</code>).</li></ul><h3 id="certificate-transparency" tabindex="-1">Certificate Transparency <a class="header-anchor" href="#certificate-transparency" aria-label="Permalink to &quot;Certificate Transparency&quot;">​</a></h3><blockquote><p>Certificate Transparency(CT) is a project under which a Certificate Authority(CA) has to publish every SSL/TLS certificate they issue to a public log. An SSL/TLS certificate usually contains domain names, sub-domain names and email addresses.</p><p>(<a href="https://blog.appsecco.com/" target="_blank" rel="noreferrer">blog.appsecco.com</a>)</p></blockquote><p>The following websites allow to search through their CT logs: <a href="https://crt.sh/" target="_blank" rel="noreferrer">crt.sh</a>, <a href="https://censys.io/" target="_blank" rel="noreferrer">censys.io</a>, <a href="https://developers.facebook.com/tools/ct/" target="_blank" rel="noreferrer">Facebook&#39;s CT monitor</a>, <a href="https://transparencyreport.google.com/https/certificates" target="_blank" rel="noreferrer">Google&#39;s CT monitor</a>.</p><p><a href="https://github.com/Findomain/Findomain" target="_blank" rel="noreferrer">Findomain</a> (Rust), <a href="https://github.com/projectdiscovery/subfinder" target="_blank" rel="noreferrer">Subfinder</a> (Go) and <a href="https://github.com/tomnomnom/assetfinder" target="_blank" rel="noreferrer">Assetfinder</a> (Go) mainly rely on Certificate Transparency logs enumeration.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Standard enumeration with findomain</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findomain</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target.domain&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Standard enumeration with subfinder</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">subfinder</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target.domain&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Pipe subfinder with httpx to find HTTP services</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target.domain&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> subfinder</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -silent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> httpx</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -silent</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Standard enumeration with assetfinder</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assetfinder</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target.domain&quot;</span></span></code></pre></div><h3 id="virtual-host-fuzzing" tabindex="-1">Virtual host fuzzing <a class="header-anchor" href="#virtual-host-fuzzing" aria-label="Permalink to &quot;Virtual host fuzzing&quot;">​</a></h3><p>A specific page has been written for this topic.</p><div class="tip custom-block"><p>Read the <a href="./virtual-host-fuzzing">Virtual host fuzzing</a> article for more insight</p></div><h3 id="amass" tabindex="-1">Amass <a class="header-anchor" href="#amass" aria-label="Permalink to &quot;Amass&quot;">​</a></h3><p>OWASP&#39;s <a href="https://github.com/OWASP/Amass" target="_blank" rel="noreferrer">Amass</a> (Go) tool can gather information through DNS bruteforcing, DNS sweeping, NSED zone walking, DNS zone transfer, through web archives, through online DNS datasets and aggregators APIs, etc.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">amass</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --passive</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;domain.com&quot;</span></span></code></pre></div><h3 id="dnsrecon" tabindex="-1">DNSRecon <a class="header-anchor" href="#dnsrecon" aria-label="Permalink to &quot;DNSRecon&quot;">​</a></h3><p><a href="https://github.com/darkoperator/dnsrecon" target="_blank" rel="noreferrer">DNSRecon</a> (Python) can enumerate DNS information through the following techniques: check NS records for zone transfers, enumerate records, check for wildcard resolution, TLD expansion, bruteforce subdomain and host A and AAAA records given a wordlist, perform PTR lookup given an IP range, DNS cache snooping, etc.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># General enumeration</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnsrecon</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target.domain&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Standard enumeration and zone transfer (AXFR)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnsrecon</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target.domain&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># DNS bruteforcing/dictionnary attack</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnsrecon</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> brt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target.domain&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;nameserver.com&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/path/to/wordlist&quot;</span></span></code></pre></div><h3 id="dns-bruteforcing" tabindex="-1">DNS bruteforcing <a class="header-anchor" href="#dns-bruteforcing" aria-label="Permalink to &quot;DNS bruteforcing&quot;">​</a></h3><p>Apart from <a href="./domains-enumeration#amass">Amass</a> and <a href="./domains-enumeration#dnsrecord">DNSRecon</a> mentioned above, <a href="https://github.com/OJ/gobuster" target="_blank" rel="noreferrer">gobuster</a> (go) can be used to do DNS bruteforcing.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gobuster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dns</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --domain</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;target.domain&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --resolver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;nameserver&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --wordlist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/path/to/wordlist&quot;</span></span></code></pre></div><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">​</a></h2><p><a href="https://blog.appsecco.com/a-penetration-testers-guide-to-sub-domain-enumeration-7d842d5570f6" target="_blank" rel="noreferrer">https://blog.appsecco.com/a-penetration-testers-guide-to-sub-domain-enumeration-7d842d5570f6</a></p><p><a href="https://github.com/appsecco/the-art-of-subdomain-enumeration" target="_blank" rel="noreferrer">https://github.com/appsecco/the-art-of-subdomain-enumeration</a></p><p><a href="https://lazyhacker.medium.com/subdomain-enumeration-tec-276da39d7e69" target="_blank" rel="noreferrer">https://lazyhacker.medium.com/subdomain-enumeration-tec-276da39d7e69</a></p>`,35)]))}const k=e(n,[["render",r]]);export{u as __pageData,k as default};
