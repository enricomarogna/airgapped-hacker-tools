import{_ as r,c as h,a5 as d,G as t,w as a,j as e,a as s,B as l,o as p}from"./chunks/framework.B5CpDqM0.js";const N=JSON.parse('{"title":"LLMNR, NBT-NS, mDNS spoofing","description":"MITRE ATT&CK™ Sub-technique T1557.001","frontmatter":{"description":"MITRE ATT&CK™ Sub-technique T1557.001","authors":"ShutdownRepo, sckdev"},"headers":[],"relativePath":"ad/movement/mitm-and-coerced-authentications/llmnr-nbtns-mdns-spoofing.md","filePath":"ad/movement/mitm-and-coerced-authentications/llmnr-nbtns-mdns-spoofing.md","lastUpdated":1724982529000}'),k={name:"ad/movement/mitm-and-coerced-authentications/llmnr-nbtns-mdns-spoofing.md"};function c(u,i,g,m,b,f){const n=l("PluginTabsTab"),o=l("PluginTabs");return p(),h("div",null,[i[2]||(i[2]=d('<h1 id="llmnr-nbt-ns-mdns-spoofing" tabindex="-1">LLMNR, NBT-NS, mDNS spoofing <a class="header-anchor" href="#llmnr-nbt-ns-mdns-spoofing" aria-label="Permalink to &quot;LLMNR, NBT-NS, mDNS spoofing&quot;">​</a></h1><p>In some environments (like Windows ones), multicast name resolution protocols are enabled by default, such as LLMNR (Local-Link Multicast Name Resolution), NBT-NS (NetBIOS Name Service) and mDNS (multicast Domain Name System). Those environments can fallback to those protocols when standard domain name resolution protocols fail. Windows systems attempt to resolve names in the following order: DNS, LLMNR and NBT-NS.</p><p>Attackers can then answer those multicast or broadcast queries. The victims are then redirected to the attacker asking them to authenticate in order to access whatever they ask for. Their authentication is then relayed.</p><p><a href="https://github.com/lgandx/Responder" target="_blank" rel="noreferrer">Responder</a> (Python) and <a href="https://github.com/Kevin-Robertson/Inveigh" target="_blank" rel="noreferrer">Inveigh</a> (Powershell) are great tools for name poisoning. In addition to name poisoning, they also have the ability to start servers (listeners) that will <a href="./../ntlm/capture">capture authentications</a> and echo the NTLM hashes to the attacker. Another possibility would be to start similar listeners, and <a href="./../ntlm/relay">relay the NTLM authentications</a> to other resources the attacker wants to access.</p>',4)),t(o,null,{default:a(()=>[t(n,{label:"UNIX-like"},{default:a(()=>i[0]||(i[0]=[e("p",null,"The following command will make Responder analyze the network to see if LLMNR, NBT-NS and mDNS are used, and to inspect BROWSER requests.",-1),e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"responder"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --interface"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "eth0"'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --analyze")]),s(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"responder"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -I"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "eth0"'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -A")])])])],-1),e("p",null,[s("The following command will start LLMNR, NBTS and mDNS spoofing. Name resolution queries for the wpad server will be answered just like any other query. Fake authentication servers (HTTP/S, SMB, SQL, FTP, IMAP, POP3, DNS, LDAP, ...) will "),e("a",{href:"./../ntlm/capture"},"capture NTLM hashes"),s(".")],-1),e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"responder"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --interface"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "eth0"')]),s(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"responder"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -I"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "eth0"')])])])],-1)])),_:1}),t(n,{label:"Windows"},{default:a(()=>i[1]||(i[1]=[e("p",null,"The following command will make Inveigh inspect the network to see if LLMNR, NBT-NS and mDNS are used.",-1),e("div",{class:"language-powerquery vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"powerquery"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Invoke"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Inveigh"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"ConsoleOutput"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," Y"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Inspect")])])])],-1),e("p",null,[s("The following command will start LLMNR, NBTS and mDNS spoofing. Name resolution queries for the wpad server will be answered just like any other query. Fake authentication servers (HTTP/S, SMB, DNS, LDAP, ...) will "),e("a",{href:"./../ntlm/capture"},"capture NTLM hashes"),s(" (even from machine accounts) and set the Challenge to "),e("code",null,"1122334455667788"),s(" (to "),e("a",{href:"./../credentials/cracking#practice"},"crack NTLM hashes"),s(" with "),e("a",{href:"https://crack.sh/",target:"_blank",rel:"noreferrer"},"crack.sh"),s(").")],-1),e("p",null,[s("Inveigh also starts a WPAD rogue proxy server by default for "),e("a",{href:"./wpad-spoofing"},"WPAD abuse"),s(".")],-1),e("div",{class:"language-powershell vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"powershell"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Invoke-Inveigh"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"ConsoleOutput Y "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"LLMNR Y "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"NBNS Y "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"mDNS Y "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"-"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Challenge "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1122334455667788"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," -"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"MachineAccounts Y")])])])],-1),e("p",null,[s("Flags like "),e("code",null,"-ADIDNS,"),s(),e("code",null,"-ADIDNSForest,"),s(),e("code",null,"-ADIDNSCleanup"),s(", "),e("code",null,"-ADIDNSThreshold"),s(" and more can be set to combine LLMNR, NBT-NS and mDNS spoofing with "),e("a",{href:"./adidns-spoofing"},"ADIDNS spoofing"),s(".")],-1),e("p",null,[e("a",{href:"https://github.com/Kevin-Robertson/Inveigh/wiki/Basics",target:"_blank",rel:"noreferrer"},"This wiki page"),s(" can be really useful to help master Inveigh and its support functions")],-1),e("ul",null,[e("li",null,[e("code",null,"Clear-Inveigh"),s(" to clear the $inveigh hashtable")]),e("li",null,[e("code",null,"Get-Inveigh"),s(" to get data from the $inveigh hashtable")]),e("li",null,[e("code",null,"Stop-Inveigh"),s(" to stop all running Inveigh modules")]),e("li",null,[e("code",null,"Watch-Inveigh"),s(" to enable real time console output")])],-1)])),_:1})]),_:1}),i[3]||(i[3]=e("h2",{id:"resources",tabindex:"-1"},[s("Resources "),e("a",{class:"header-anchor",href:"#resources","aria-label":'Permalink to "Resources"'},"​")],-1)),i[4]||(i[4]=e("p",null,[e("a",{href:"http://remivernier.com/index.php/2018/08/26/protocoles-nbt-ns-llmnr-et-exploitation-des-failles/",target:"_blank",rel:"noreferrer"},"http://remivernier.com/index.php/2018/08/26/protocoles-nbt-ns-llmnr-et-exploitation-des-failles/")],-1)),i[5]||(i[5]=e("p",null,[e("a",{href:"https://www.sternsecurity.com/blog/local-network-attacks-llmnr-and-nbt-ns-poisoning",target:"_blank",rel:"noreferrer"},"https://www.sternsecurity.com/blog/local-network-attacks-llmnr-and-nbt-ns-poisoning")],-1))])}const F=r(k,[["render",c]]);export{N as __pageData,F as default};
