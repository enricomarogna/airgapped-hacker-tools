import{_ as r,c as k,a5 as o,G as a,w as t,j as s,a as i,B as n,o as d}from"./chunks/framework.B5CpDqM0.js";const m=JSON.parse('{"title":"Network shares","description":"","frontmatter":{"authors":"ShutdownRepo, sckdev"},"headers":[],"relativePath":"ad/movement/credentials/dumping/network-shares.md","filePath":"ad/movement/credentials/dumping/network-shares.md","lastUpdated":1724982529000}'),p={name:"ad/movement/credentials/dumping/network-shares.md"};function c(F,e,g,f,u,C){const l=n("PluginTabsTab"),h=n("PluginTabs");return d(),k("div",null,[e[2]||(e[2]=o('<h1 id="network-shares" tabindex="-1">Network shares <a class="header-anchor" href="#network-shares" aria-label="Permalink to &quot;Network shares&quot;">​</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><p>In organization networks, it is common to find passwords in random files (logs, config files, personal documents, Office documents, ...). Other credential dumping techniques (<a href="./sam-and-lsa-secrets">SAM &amp; LSA</a>, <a href="./ntds">NTDS.dit</a>, some <a href="./web-browsers">web browsers</a>, ...) could be considered as sub-techniques of credential dumping from files. This recipe focuses on the techniques that allow to gather password and sensitive information from generic and random files other than the ones involved in the sub-techniques mentioned before.</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">​</a></h2>',4)),a(h,null,{default:t(()=>[a(l,{label:"UNIX-like"},{default:t(()=>e[0]||(e[0]=[s("p",null,[i("From UNIX-like systems, the "),s("a",{href:"https://github.com/blacklanternsecurity/MANSPIDER",target:"_blank",rel:"noreferrer"},"manspider"),i(" (Python) tool can be used to find sensitive information across a number of shares.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"manspider.py"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --threads"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 50"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $IP_RANGE"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$MASK "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-d"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $DOMAIN "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-u"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $USER "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"-p"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $PASSWORD "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"--content"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "set sqlplus"'),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "password ="')])])])],-1),s("p",null,"Manually, shares can be mounted and grepped for interesting information.",-1)])),_:1}),a(l,{label:"Windows"},{default:t(()=>e[1]||(e[1]=[s("p",null,"From Windows systems, the following commands should help find interesting information across local files and network shares.",-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"findstr"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /snip"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," password"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," *"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".xml"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," *"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".ini"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," *"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},".txt")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"findstr"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /snip"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," password"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," *")])])])],-1),s("p",null,[s("a",{href:"https://github.com/PowerShellMafia/PowerSploit",target:"_blank",rel:"noreferrer"},"PowerSploit"),i("'s "),s("a",{href:"https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1",target:"_blank",rel:"noreferrer"},"PowerView"),i(" (Powershell) module can be used to find interesting files as well.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Find-InterestingFile"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -LastAccessTime"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," (Get-Date).AddDays("),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"-7"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Find-InterestingFile"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -Include"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "private,confidential"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Find-InterestingFile"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -Path"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$SERVER"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\$"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'Share"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -OfficeDocs")])])])],-1),s("p",null,[i("Last but not least, one of the best tools to find sensitive information across a number of shares and local files is "),s("a",{href:"https://github.com/SnaffCon/Snaffler",target:"_blank",rel:"noreferrer"},"Snaffler"),i(" (C#).")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# Snaffle all the computers in the domain")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"./Snaffler.exe"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," domain.local"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -c"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"  -s")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# Snaffle specific computers")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"./Snaffler.exe"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -n"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," computer1,computer2"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -s")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# Snaffle a specific directory")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"./Snaffler.exe"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," C:"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\ "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"-s")])])])],-1)])),_:1})]),_:1}),e[3]||(e[3]=s("h2",{id:"resource",tabindex:"-1"},[i("Resource "),s("a",{class:"header-anchor",href:"#resource","aria-label":'Permalink to "Resource"'},"​")],-1)),e[4]||(e[4]=s("p",null,[s("a",{href:"https://github.com/SnaffCon/Snaffler",target:"_blank",rel:"noreferrer"},"https://github.com/SnaffCon/Snaffler")],-1)),e[5]||(e[5]=s("p",null,[s("a",{href:"https://github.com/blacklanternsecurity/MANSPIDER",target:"_blank",rel:"noreferrer"},"https://github.com/blacklanternsecurity/MANSPIDER")],-1))])}const b=r(p,[["render",c]]);export{m as __pageData,b as default};
