import{_ as t,c as i,a5 as s,o as a}from"./chunks/framework.B5CpDqM0.js";const k=JSON.parse('{"title":"Open redirect","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"web/inputs/ored.md","filePath":"web/inputs/ored.md","lastUpdated":1724982529000}'),r={name:"web/inputs/ored.md"};function n(l,e,o,p,h,d){return a(),i("div",null,e[0]||(e[0]=[s(`<h1 id="open-redirect" tabindex="-1">Open redirect <a class="header-anchor" href="#open-redirect" aria-label="Permalink to &quot;Open redirect&quot;">​</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><p>Many web applications make redirections based on parameters that users can easily control, like GET parameters. When the application fails to properly check and filter these inputs, they can be vulnerable to Open Redirect where attacker can redirect users to a malicious website. Open Redirect vulnerabilities are exploited in phishing attacks to redirect users from a trusted website to an attacker-controlled one. In well executed attacks, most of the users would not notice it without carefully looking at the URL to see the difference.</p><p>Open Redirect vulnerabilities are usually found when browsing a page, being asked to log in, and then being redirected to the original page when logged in. These mechanisms greatly improve the UX (user experience) but when they are badly implemented, they can lead to vulnerabilities from low to medium severity.</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">​</a></h2><p>Testers need to find inputs vectors used by the website for redirections. They usually are GET parameters with string values that are sometimes base64 encoded like:</p><ul><li><a href="http://some.website/login?redirect=**http://some.website/products**" target="_blank" rel="noreferrer">http://some.website/login?redirect=**http://some.website/products**</a></li><li><a href="http://some.website/login?redirect=**aHR0cDovL3NvbWUud2Vic2l0ZS9wcm9kdWN0cw%3D%3D**" target="_blank" rel="noreferrer">http://some.website/login?redirect=**aHR0cDovL3NvbWUud2Vic2l0ZS9wcm9kdWN0cw%3D%3D**</a></li></ul><p>Testers can then try to replace those values with different URLs and analyze de redirection.</p><p>Some bugbounty tools like <a href="https://github.com/tomnomnom/waybackurls" target="_blank" rel="noreferrer">waybackurls</a> (Go), <a href="https://github.com/hakluke/hakrawler" target="_blank" rel="noreferrer">hakrawler</a> (Go) and <a href="https://github.com/tomnomnom/gf" target="_blank" rel="noreferrer">gf</a> (Go) can help find vulnerable endpoints.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subdomains</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> waybackurls</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tee</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> urls</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subdomains</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hakrawler</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -depth</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -plain</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tee</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> urls</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> redirect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> urls</span></span></code></pre></div><p>Using <code>redirect.json</code> with gf like:</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;flags&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-HanrE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;pattern&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;url=|rt=|cgi-bin/redirect.cgi|continue=|dest=|destination=|go=|out=|redir=|redirect_uri=|redirect_url=|return=|return_path=|returnTo=|rurl=|target=|view=|from_url=|load_url=|file_url=|page_url=|file_name=|page=|folder=|folder_url=|login_url=|img_url=|return_url=|return_to=|next=|redirect=|redirect_to=|logout=|checkout=|checkout_url=|goto=|next_page=|file=|load_file=&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="tip custom-block"><p>Redirections can be header based (<code>location</code> header sent from the server), or Javascript based (will not work fro server-side functions, but could redirect to <code>javascript:something()</code> and cause an XSS).</p></div><div class="warning custom-block"><p>The impact of this vulnerability is debated. Open redirects can help in phishing attacks but in some cases, it could help exploit an XSS, a SSRF or a CSRF, hence increasing the impact.</p></div><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">​</a></h2><p><a href="https://s0cket7.com/open-redirect-vulnerability/" target="_blank" rel="noreferrer">https://s0cket7.com/open-redirect-vulnerability/</a></p><p><a href="https://portswigger.net/kb/issues/00500100_open-redirection-reflected" target="_blank" rel="noreferrer">https://portswigger.net/kb/issues/00500100_open-redirection-reflected</a></p><p><a href="https://portswigger.net/kb/issues/00500101_open-redirection-stored" target="_blank" rel="noreferrer">https://portswigger.net/kb/issues/00500101_open-redirection-stored</a></p><p><a href="https://portswigger.net/web-security/dom-based/open-redirection" target="_blank" rel="noreferrer">https://portswigger.net/web-security/dom-based/open-redirection</a></p><p><a href="https://0x00sec.org/t/open-redirection-guide/21118" target="_blank" rel="noreferrer">https://0x00sec.org/t/open-redirection-guide/21118</a></p><p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect" target="_blank" rel="noreferrer">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Open%20Redirect</a></p>`,21)]))}const u=t(r,[["render",n]]);export{k as __pageData,u as default};
