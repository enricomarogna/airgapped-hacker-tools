import{_ as e,c as a,a5 as i,o as n}from"./chunks/framework.B5CpDqM0.js";const g=JSON.parse('{"title":"DHCPv6 spoofing","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"ad/movement/mitm-and-coerced-authentications/dhcpv6-spoofing.md","filePath":"ad/movement/mitm-and-coerced-authentications/dhcpv6-spoofing.md","lastUpdated":1724982529000}'),t={name:"ad/movement/mitm-and-coerced-authentications/dhcpv6-spoofing.md"};function o(r,s,p,h,l,d){return n(),a("div",null,s[0]||(s[0]=[i(`<h1 id="dhcpv6-spoofing" tabindex="-1">DHCPv6 spoofing <a class="header-anchor" href="#dhcpv6-spoofing" aria-label="Permalink to &quot;DHCPv6 spoofing&quot;">​</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><h3 id="dhcpv6-spoofing-and-poisoning" tabindex="-1">DHCPv6 spoofing and poisoning <a class="header-anchor" href="#dhcpv6-spoofing-and-poisoning" aria-label="Permalink to &quot;DHCPv6 spoofing and poisoning&quot;">​</a></h3><p>By default on Windows environments, IPv6 is enabled and has priority over IPv4. Usually, IPv6 is neither used nor configured. When a Windows machine boots or gets plugged in the network, it asks for an IPv6 configuration through a DHCPv6 request. Since DHCPv6 works in multicast, attackers on the same network can answer the DHCPv6 queries and provide the clients with a specific IP config. The IP config will include a rogue DNS server address (actually, for <a href="https://github.com/fox-it/mitm6" target="_blank" rel="noreferrer">mitm6</a>, it will include two addresses, one IPv4 and one IPv6). This technique is called DHCPv6 spoofing.</p><h3 id="dns-spoofing" tabindex="-1">DNS spoofing <a class="header-anchor" href="#dns-spoofing" aria-label="Permalink to &quot;DNS spoofing&quot;">​</a></h3><p>Attackers can then proceed to <a href="./dns-spoofing">DNS spoofing</a>. Once the clients DNS servers are set through the fake IP config pushed through DHCPv6 spoofing, each client will query the attacker&#39;s server for every domain name resolution. The attacker&#39;s server will redirect the clients to other rogue servers that will be able to capture or relay authentications.</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">​</a></h2><div class="warning custom-block"><p>Combining DHCPv6 spoofing with DNS spoofing can cause temporary but severe disruption in the network. It is highly recommended to target specific addresses and machines.</p></div><p><a href="https://github.com/fox-it/mitm6" target="_blank" rel="noreferrer">mitm6</a> (Python) is an all-in-one tool for DHCPv6 spoofing + DNS poisoning. The following command can be run to make mitm6 redirect internal traffic only.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mitm6</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --interface</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --domain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DOMAIN_FQDN</span></span></code></pre></div><p><a href="https://www.bettercap.org/" target="_blank" rel="noreferrer">bettercap</a> (Go) can also be used for DHCPv6 spoofing and <a href="./dns-spoofing">DNS spoofing</a>.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Configure and start DHCPv6 spoofing</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dhcp6.spoof.domains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DOMAIN_FQDN</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dhcp6.spoof</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Configure and DNS DHCPv6 spoofing</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dns.spoof.domains</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $DOMAIN_FQDN</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dns.spoot.all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dns.spoof</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span></span></code></pre></div><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">​</a></h2><p><a href="https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/" target="_blank" rel="noreferrer">https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/</a></p><p><a href="https://www.bettercap.org/modules/ethernet/spoofers/dhcp6.spoof/" target="_blank" rel="noreferrer">https://www.bettercap.org/modules/ethernet/spoofers/dhcp6.spoof/</a></p>`,15)]))}const k=e(t,[["render",o]]);export{g as __pageData,k as default};
