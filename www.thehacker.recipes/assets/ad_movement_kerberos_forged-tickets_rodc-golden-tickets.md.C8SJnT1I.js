import{_ as h,c as d,a5 as r,G as i,w as s,B as o,o as k,j as e,a as l}from"./chunks/framework.B5CpDqM0.js";const y=JSON.parse('{"title":"RODC Golden tickets","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"ad/movement/kerberos/forged-tickets/rodc-golden-tickets.md","filePath":"ad/movement/kerberos/forged-tickets/rodc-golden-tickets.md","lastUpdated":1724982529000}'),c={name:"ad/movement/kerberos/forged-tickets/rodc-golden-tickets.md"};function p(u,t,g,b,m,E){const a=o("PluginTabsTab"),n=o("PluginTabs");return k(),d("div",null,[t[2]||(t[2]=r('<h1 id="rodc-golden-tickets" tabindex="-1">RODC Golden tickets <a class="header-anchor" href="#rodc-golden-tickets" aria-label="Permalink to &quot;RODC Golden tickets&quot;">​</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><p>With administrative access to an <a href="./../../builtins/rodc">RODC</a>, it is possible to dump all the cached credentials, including those of the<code>krbtgt_XXXXX</code> account. The hash can be used to forge a &quot;RODC golden ticket&quot; for any account in the <code>msDS-RevealOnDemandGroup</code> and not in the <code>msDS-NeverRevealGroup</code> attributes of the RODC. This ticket can be presented to the RODC or any accessible standard writable Domain Controller to request a Service Ticket (ST).</p><div class="tip custom-block"><p>When presenting a RODC golden ticket to a writable (i.e. standard) Domain Controller, it is not worth crafting the PAC because it will be recalculated by the writable Domain Controller when issuing a service ticket (ST).</p></div><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">​</a></h2>',5)),i(n,null,{default:s(()=>[i(a,{label:"UNIX-like"},{default:s(()=>t[0]||(t[0]=[e("p",null,[e("em",null,"For the moment, no tool is available to only forge a RODC Golden Ticket from UNIX-like systems.")],-1)])),_:1}),i(a,{label:"Windows"},{default:s(()=>t[1]||(t[1]=[e("p",null,[l("From Windows systems, "),e("a",{href:"https://github.com/GhostPack/Rubeus",target:"_blank",rel:"noreferrer"},"Rubeus"),l(" (C#) can be used for this purpose.")],-1),e("div",{class:"language-powershell vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"powershell"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"Rubeus.exe"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," golden "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"rodcNumber:$KBRTGT_NUMBER "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"flags:forwardable"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},","),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"renewable"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},","),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"enc_pa_rep "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"nowrap "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"outfile:ticket.kirbi "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"aes256:$KRBTGT_AES_KEY "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"user:USER "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"id:USER_RID "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"domain:domain.local "),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"sid:DOMAIN_SID")])])])],-1)])),_:1})]),_:1}),t[3]||(t[3]=r('<div class="tip custom-block"><p></p><blockquote><p>The secret ingredient for making an RODC golden ticket viable is including the correct key version number in the <em>kvno</em> field of the ticket.</p><p><em>(Elad Shamir on</em> <a href="https://posts.specterops.io/at-the-edge-of-tier-zero-the-curious-case-of-the-rodc-ef5f1799ca06" target="_blank" rel="noreferrer"><em>specterops.io</em></a><em>)</em></p></blockquote></div><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">​</a></h2><p><a href="https://adsecurity.org/?p=3592" target="_blank" rel="noreferrer">https://adsecurity.org/?p=3592</a></p><p><a href="https://www.secureauth.com/blog/the-kerberos-key-list-attack-the-return-of-the-read-only-domain-controllers/" target="_blank" rel="noreferrer">https://www.secureauth.com/blog/the-kerberos-key-list-attack-the-return-of-the-read-only-domain-controllers/</a></p>',4))])}const D=h(c,[["render",p]]);export{y as __pageData,D as default};
