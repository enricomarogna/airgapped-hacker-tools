import{_ as l,c as h,a5 as d,G as i,w as t,j as s,a,B as r,o as p}from"./chunks/framework.B5CpDqM0.js";const C=JSON.parse('{"title":"DNS spoofing","description":"","frontmatter":{"authors":"ShutdownRepo, sckdev"},"headers":[],"relativePath":"ad/movement/mitm-and-coerced-authentications/dns-spoofing.md","filePath":"ad/movement/mitm-and-coerced-authentications/dns-spoofing.md","lastUpdated":1724982529000}'),k={name:"ad/movement/mitm-and-coerced-authentications/dns-spoofing.md"};function c(g,e,f,u,b,F){const n=r("PluginTabsTab"),o=r("PluginTabs");return p(),h("div",null,[e[3]||(e[3]=d('<h1 id="dns-spoofing" tabindex="-1">DNS spoofing <a class="header-anchor" href="#dns-spoofing" aria-label="Permalink to &quot;DNS spoofing&quot;">​</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><p>DNS is not multicast or broadcast like <a href="./llmnr-nbtns-mdns-spoofing">LLMNR, NBT-NS or mDNS</a>. In order to answer DNS requests, attacker first need to receive them. For instance, this can be achieved with <a href="./arp-poisoning">ARP spoofing</a> or <a href="./dhcpv6-spoofing">DHCPv6 spoofing</a>. DNS spoofing is basically setting up a DNS server and answering DNS queries obtained through man-in-the-middle technique.</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">​</a></h2>',4)),i(o,null,{default:t(()=>[i(n,{label:"Responder"},{default:t(()=>e[0]||(e[0]=[s("p",null,[s("a",{href:"https://github.com/SpiderLabs/Responder",target:"_blank",rel:"noreferrer"},"Responder"),a("'s (Python) DNS server feature can be used to answer DNS queries.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"responder"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --interface"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "eth0"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"responder"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -I"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "eth0"')])])])],-1)])),_:1}),i(n,{label:"dnschef"},{default:t(()=>e[1]||(e[1]=[s("p",null,[s("a",{href:"https://github.com/iphelix/dnschef",target:"_blank",rel:"noreferrer"},"dnschef"),a(" (Python) can be used as a DNS server.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"dnschef"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --fakeip"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Pentest_IP_Address'"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --interface"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Pentest_IP_Address'"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --port"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 53"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --logfile"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dnschef.log")])])])],-1)])),_:1}),i(n,{label:"bettercap"},{default:t(()=>e[2]||(e[2]=[s("p",null,[a("In order to spoof DNS requests, "),s("a",{href:"https://www.bettercap.org/",target:"_blank",rel:"noreferrer"},"bettercap"),a(" (Go) can be used. This tool can also be used for the first step of "),s("a",{href:"./arp-poisoning"},"ARP spoofing"),a(" or "),s("a",{href:"./dhcpv6-spoofing"},"DHCPv6 spoofing"),a(".")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dns.spoof.domains"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $DOMAIN_FQDN")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dns.spoof.all"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true")]),a(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"dns.spoof"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")])])])],-1)])),_:1})]),_:1}),e[4]||(e[4]=s("h2",{id:"resources",tabindex:"-1"},[a("Resources "),s("a",{class:"header-anchor",href:"#resources","aria-label":'Permalink to "Resources"'},"​")],-1)),e[5]||(e[5]=s("p",null,[s("a",{href:"https://www.bettercap.org/modules/ethernet/spoofers/dns.spoof/",target:"_blank",rel:"noreferrer"},"https://www.bettercap.org/modules/ethernet/spoofers/dns.spoof/")],-1))])}const y=l(k,[["render",c]]);export{C as __pageData,y as default};
