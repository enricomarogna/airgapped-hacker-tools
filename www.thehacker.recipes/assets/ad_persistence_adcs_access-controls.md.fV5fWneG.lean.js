import{_ as t,c as r,a5 as a,o as s}from"./chunks/framework.B5CpDqM0.js";const f=JSON.parse('{"title":"Access controls","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"ad/persistence/adcs/access-controls.md","filePath":"ad/persistence/adcs/access-controls.md","lastUpdated":1724982529000}'),o={name:"ad/persistence/adcs/access-controls.md"};function c(n,e,i,d,l,p){return s(),r("div",null,e[0]||(e[0]=[a('<h1 id="access-controls" tabindex="-1">Access controls <a class="header-anchor" href="#access-controls" aria-label="Permalink to &quot;Access controls&quot;">​</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><p>In <a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2" target="_blank" rel="noreferrer">their research papers</a>, <a href="https://twitter.com/harmj0y" target="_blank" rel="noreferrer">Will Schroeder</a> and <a href="https://twitter.com/tifkin_" target="_blank" rel="noreferrer">Lee Christensen</a> identified a set of vectors of domain persistence based on access control misconfigurations (dubbed DPERSIST3).</p><p>Active Directory Certificate Services add multiple objects to AD, including securable ones which principals can have permissions over. This includes Certificate templates, Certificate Authorities, CA server, etc.</p><p>In the same research papers, domain escalation techniques abusing misconfigurated access controls were identified dubbed <a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2#7c4b" target="_blank" rel="noreferrer">ESC4</a>, <a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2#0a38" target="_blank" rel="noreferrer">ESC5</a> and <a href="https://posts.specterops.io/certified-pre-owned-d95910965cd2#fdbf" target="_blank" rel="noreferrer">ESC7</a>).</p><p>If an attacker obtains sufficient permissions in a domain, he could modify security descriptors of AD CS components, in order to make them vulnerable to the attacks mentioned in <a href="./../../movement/adcs/access-controls">Movement &gt; AD-CS &gt; Access controls</a>.</p><p>These modifications can be made with tools like <a href="https://github.com/fortra/impacket/pull/1291" target="_blank" rel="noreferrer">Impacket&#39;s (Python) dacledit.py</a> or with <a href="https://powersploit.readthedocs.io/en/latest/Recon/Add-DomainObjectAcl/" target="_blank" rel="noreferrer">Add-DomainObjectAcl</a> (<a href="https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1" target="_blank" rel="noreferrer">PowerView</a> module), as explained in <a href="./../../movement/dacl/grant-rights">grant-rights.md</a>.</p>',7)]))}const m=t(o,[["render",c]]);export{f as __pageData,m as default};
