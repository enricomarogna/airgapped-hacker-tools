import{_ as i,c as a,a5 as e,o as n}from"./chunks/framework.B5CpDqM0.js";const c=JSON.parse('{"title":"üõ†Ô∏è Hosts discovery","description":"","frontmatter":{"authors":"ShutdownRepo, clem9669, sckdev"},"headers":[],"relativePath":"infra/recon/hosts-discovery.md","filePath":"infra/recon/hosts-discovery.md","lastUpdated":1724982529000}'),t={name:"infra/recon/hosts-discovery.md"};function h(r,s,l,p,k,d){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="üõ†Ô∏è-hosts-discovery" tabindex="-1">üõ†Ô∏è Hosts discovery <a class="header-anchor" href="#üõ†Ô∏è-hosts-discovery" aria-label="Permalink to &quot;üõ†Ô∏è Hosts discovery&quot;">‚Äã</a></h1><h2 id="theory" tabindex="-1">Theory <a class="header-anchor" href="#theory" aria-label="Permalink to &quot;Theory&quot;">‚Äã</a></h2><p>When targeting machines connected to a network, identifying which hosts are up and running (and their IP address) is the first step in getting to know the attack surface. There are multiple active and passive ways to discover hosts in a network, each relying on specific protocols that may be used in the network.</p><p>Once the hosts are identified, attackers then usually proceed to <a href="./port-scanning">port scanning</a> to attempt at compromising them.</p><p>Alternatively, there are common scenarios where most of the hosts and services are managed by a central set of services like <a href="./../../ad/recon/index">Active Directory Domain Services (AD-DS)</a>. In this case, attackers usually try to compromise those services first as it would grant them control over many hosts without having to attack them all. A whole category of The Hacker Recipes is dedicated to Active Directory Domain Services (and other associated AD services).</p><h2 id="practice" tabindex="-1">Practice <a class="header-anchor" href="#practice" aria-label="Permalink to &quot;Practice&quot;">‚Äã</a></h2><p>//// WIP : add p0f, bettercap</p><h3 id="arp-discovery" tabindex="-1">ARP discovery <a class="header-anchor" href="#arp-discovery" aria-label="Permalink to &quot;ARP discovery&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (active) scan all private ranges (i.e. 192.168.0.0/16, 172.16.0.0/12, 10.0.0.0/8)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netdiscover</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $INTERFACE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (active) scan a given range (e.g. 192.168.0.0/24)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netdiscover</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $INTERFACE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $RANGE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># passive scan (doesn&#39;t send packets)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netdiscover</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $INTERFACE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-p</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (active) scan a given range</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $RANGE</span></span></code></pre></div><h3 id="nbt-discovery" tabindex="-1">NBT discovery <a class="header-anchor" href="#nbt-discovery" aria-label="Permalink to &quot;NBT discovery&quot;">‚Äã</a></h3><p>It sends NetBIOS status query to each address in supplied range and lists received information in human readable form. For each responded host it lists IP address, NetBIOS computer name, logged-in user name and MAC address (such as Ethernet).</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nbtscan</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $RANGE</span></span></code></pre></div><h3 id="dns-queries" tabindex="-1">DNS queries <a class="header-anchor" href="#dns-queries" aria-label="Permalink to &quot;DNS queries&quot;">‚Äã</a></h3><p>In Active Directory environnements, machines have their record on the Domain Controller (which usually hosts the DNS service). Through PTR resolution requests, is it then possible to find additional ranges and machines.</p><div class="tip custom-block"><p>Read the <a href="./../../ad/recon/dns">dns.md</a> article for more insight</p></div><h3 id="icmp-discovery" tabindex="-1">ICMP discovery <a class="header-anchor" href="#icmp-discovery" aria-label="Permalink to &quot;ICMP discovery&quot;">‚Äã</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Send one echo request to a host</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Windows</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOST</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UNIX</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $HOST</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Send echo requests to ranges</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $RANGE</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Send ICMP echo, timestamp, and netmask request discovery probes to a range</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -PE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -PP</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -PM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $RANGE</span></span></code></pre></div><p>Ping Sweep on Powershell:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ping </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> New-Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> System.Net.Networkinformation.Ping ; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">..</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">254</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { $ping.send(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;192.168.0.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$_</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> status </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-ne</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;TimedOut&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> select Address </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div><h3 id="icmpv6-discovery" tabindex="-1">ICMPv6 discovery <a class="header-anchor" href="#icmpv6-discovery" aria-label="Permalink to &quot;ICMPv6 discovery&quot;">‚Äã</a></h3><p>// TODO</p><h2 id="resources" tabindex="-1">Resources <a class="header-anchor" href="#resources" aria-label="Permalink to &quot;Resources&quot;">‚Äã</a></h2><p><a href="https://book.hacktricks.xyz/pentesting/pentesting-network#passive" target="_blank" rel="noreferrer">https://book.hacktricks.xyz/pentesting/pentesting-network#passive</a></p>`,23)]))}const g=i(t,[["render",h]]);export{c as __pageData,g as default};
